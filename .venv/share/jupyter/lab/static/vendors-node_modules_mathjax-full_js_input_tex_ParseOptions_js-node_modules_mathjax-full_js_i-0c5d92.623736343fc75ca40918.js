"use strict";
(self["webpackChunk_jupyterlab_application_top"] = self["webpackChunk_jupyterlab_application_top"] || []).push([["vendors-node_modules_mathjax-full_js_input_tex_ParseOptions_js-node_modules_mathjax-full_js_i-0c5d92"],{

/***/ "./node_modules/mathjax-full/js/core/Tree/Factory.js":
/*!***********************************************************!*\
  !*** ./node_modules/mathjax-full/js/core/Tree/Factory.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, exports) {


var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.AbstractFactory = void 0;
var AbstractFactory = (function () {
    function AbstractFactory(nodes) {
        var e_1, _a;
        if (nodes === void 0) { nodes = null; }
        this.defaultKind = 'unknown';
        this.nodeMap = new Map();
        this.node = {};
        if (nodes === null) {
            nodes = this.constructor.defaultNodes;
        }
        try {
            for (var _b = __values(Object.keys(nodes)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var kind = _c.value;
                this.setNodeClass(kind, nodes[kind]);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    AbstractFactory.prototype.create = function (kind) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        return (this.node[kind] || this.node[this.defaultKind]).apply(void 0, __spreadArray([], __read(args), false));
    };
    AbstractFactory.prototype.setNodeClass = function (kind, nodeClass) {
        this.nodeMap.set(kind, nodeClass);
        var THIS = this;
        var KIND = this.nodeMap.get(kind);
        this.node[kind] = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return new (KIND.bind.apply(KIND, __spreadArray([void 0, THIS], __read(args), false)))();
        };
    };
    AbstractFactory.prototype.getNodeClass = function (kind) {
        return this.nodeMap.get(kind);
    };
    AbstractFactory.prototype.deleteNodeClass = function (kind) {
        this.nodeMap.delete(kind);
        delete this.node[kind];
    };
    AbstractFactory.prototype.nodeIsKind = function (node, kind) {
        return (node instanceof this.getNodeClass(kind));
    };
    AbstractFactory.prototype.getKinds = function () {
        return Array.from(this.nodeMap.keys());
    };
    AbstractFactory.defaultNodes = {};
    return AbstractFactory;
}());
exports.AbstractFactory = AbstractFactory;
//# sourceMappingURL=Factory.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/NodeFactory.js":
/*!***************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/NodeFactory.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.NodeFactory = void 0;
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ./NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var NodeFactory = (function () {
    function NodeFactory() {
        this.mmlFactory = null;
        this.factory = { 'node': NodeFactory.createNode,
            'token': NodeFactory.createToken,
            'text': NodeFactory.createText,
            'error': NodeFactory.createError
        };
    }
    NodeFactory.createNode = function (factory, kind, children, def, text) {
        if (children === void 0) { children = []; }
        if (def === void 0) { def = {}; }
        var node = factory.mmlFactory.create(kind);
        node.setChildren(children);
        if (text) {
            node.appendChild(text);
        }
        NodeUtil_js_1.default.setProperties(node, def);
        return node;
    };
    NodeFactory.createToken = function (factory, kind, def, text) {
        if (def === void 0) { def = {}; }
        if (text === void 0) { text = ''; }
        var textNode = factory.create('text', text);
        return factory.create('node', kind, [], def, textNode);
    };
    NodeFactory.createText = function (factory, text) {
        if (text == null) {
            return null;
        }
        return factory.mmlFactory.create('text').setText(text);
    };
    NodeFactory.createError = function (factory, message) {
        var text = factory.create('text', message);
        var mtext = factory.create('node', 'mtext', [], {}, text);
        var error = factory.create('node', 'merror', [mtext], { 'data-mjx-error': message });
        return error;
    };
    NodeFactory.prototype.setMmlFactory = function (mmlFactory) {
        this.mmlFactory = mmlFactory;
    };
    NodeFactory.prototype.set = function (kind, func) {
        this.factory[kind] = func;
    };
    NodeFactory.prototype.setCreators = function (maps) {
        for (var kind in maps) {
            this.set(kind, maps[kind]);
        }
    };
    NodeFactory.prototype.create = function (kind) {
        var rest = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            rest[_i - 1] = arguments[_i];
        }
        var func = this.factory[kind] || this.factory['node'];
        var node = func.apply(void 0, __spreadArray([this, rest[0]], __read(rest.slice(1)), false));
        if (kind === 'node') {
            this.configuration.addNode(rest[0], node);
        }
        return node;
    };
    NodeFactory.prototype.get = function (kind) {
        return this.factory[kind];
    };
    return NodeFactory;
}());
exports.NodeFactory = NodeFactory;
//# sourceMappingURL=NodeFactory.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/ParseMethods.js":
/*!****************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/ParseMethods.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ./NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var TexConstants_js_1 = __webpack_require__(/*! ./TexConstants.js */ "./node_modules/mathjax-full/js/input/tex/TexConstants.js");
var ParseUtil_js_1 = __importDefault(__webpack_require__(/*! ./ParseUtil.js */ "./node_modules/mathjax-full/js/input/tex/ParseUtil.js"));
var ParseMethods;
(function (ParseMethods) {
    function variable(parser, c) {
        var def = ParseUtil_js_1.default.getFontDef(parser);
        var env = parser.stack.env;
        if (env.multiLetterIdentifiers && env.font !== '') {
            c = parser.string.substr(parser.i - 1).match(env.multiLetterIdentifiers)[0];
            parser.i += c.length - 1;
            if (def.mathvariant === TexConstants_js_1.TexConstant.Variant.NORMAL && env.noAutoOP && c.length > 1) {
                def.autoOP = false;
            }
        }
        var node = parser.create('token', 'mi', def, c);
        parser.Push(node);
    }
    ParseMethods.variable = variable;
    function digit(parser, c) {
        var mml;
        var pattern = parser.configuration.options['digits'];
        var n = parser.string.slice(parser.i - 1).match(pattern);
        var def = ParseUtil_js_1.default.getFontDef(parser);
        if (n) {
            mml = parser.create('token', 'mn', def, n[0].replace(/[{}]/g, ''));
            parser.i += n[0].length - 1;
        }
        else {
            mml = parser.create('token', 'mo', def, c);
        }
        parser.Push(mml);
    }
    ParseMethods.digit = digit;
    function controlSequence(parser, _c) {
        var name = parser.GetCS();
        parser.parse('macro', [parser, name]);
    }
    ParseMethods.controlSequence = controlSequence;
    function mathchar0mi(parser, mchar) {
        var def = mchar.attributes || { mathvariant: TexConstants_js_1.TexConstant.Variant.ITALIC };
        var node = parser.create('token', 'mi', def, mchar.char);
        parser.Push(node);
    }
    ParseMethods.mathchar0mi = mathchar0mi;
    function mathchar0mo(parser, mchar) {
        var def = mchar.attributes || {};
        def['stretchy'] = false;
        var node = parser.create('token', 'mo', def, mchar.char);
        NodeUtil_js_1.default.setProperty(node, 'fixStretchy', true);
        parser.configuration.addNode('fixStretchy', node);
        parser.Push(node);
    }
    ParseMethods.mathchar0mo = mathchar0mo;
    function mathchar7(parser, mchar) {
        var def = mchar.attributes || { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL };
        if (parser.stack.env['font']) {
            def['mathvariant'] = parser.stack.env['font'];
        }
        var node = parser.create('token', 'mi', def, mchar.char);
        parser.Push(node);
    }
    ParseMethods.mathchar7 = mathchar7;
    function delimiter(parser, delim) {
        var def = delim.attributes || {};
        def = Object.assign({ fence: false, stretchy: false }, def);
        var node = parser.create('token', 'mo', def, delim.char);
        parser.Push(node);
    }
    ParseMethods.delimiter = delimiter;
    function environment(parser, env, func, args) {
        var end = args[0];
        var mml = parser.itemFactory.create('begin').setProperties({ name: env, end: end });
        mml = func.apply(void 0, __spreadArray([parser, mml], __read(args.slice(1)), false));
        parser.Push(mml);
    }
    ParseMethods.environment = environment;
})(ParseMethods || (ParseMethods = {}));
exports["default"] = ParseMethods;
//# sourceMappingURL=ParseMethods.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/ParseOptions.js":
/*!****************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/ParseOptions.js ***!
  \****************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var StackItemFactory_js_1 = __importDefault(__webpack_require__(/*! ./StackItemFactory.js */ "./node_modules/mathjax-full/js/input/tex/StackItemFactory.js"));
var NodeFactory_js_1 = __webpack_require__(/*! ./NodeFactory.js */ "./node_modules/mathjax-full/js/input/tex/NodeFactory.js");
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ./NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var Options_js_1 = __webpack_require__(/*! ../../util/Options.js */ "./node_modules/mathjax-full/js/util/Options.js");
var ParseOptions = (function () {
    function ParseOptions(configuration, options) {
        if (options === void 0) { options = []; }
        this.options = {};
        this.packageData = new Map();
        this.parsers = [];
        this.root = null;
        this.nodeLists = {};
        this.error = false;
        this.handlers = configuration.handlers;
        this.nodeFactory = new NodeFactory_js_1.NodeFactory();
        this.nodeFactory.configuration = this;
        this.nodeFactory.setCreators(configuration.nodes);
        this.itemFactory = new StackItemFactory_js_1.default(configuration.items);
        this.itemFactory.configuration = this;
        Options_js_1.defaultOptions.apply(void 0, __spreadArray([this.options], __read(options), false));
        (0, Options_js_1.defaultOptions)(this.options, configuration.options);
    }
    ParseOptions.prototype.pushParser = function (parser) {
        this.parsers.unshift(parser);
    };
    ParseOptions.prototype.popParser = function () {
        this.parsers.shift();
    };
    Object.defineProperty(ParseOptions.prototype, "parser", {
        get: function () {
            return this.parsers[0];
        },
        enumerable: false,
        configurable: true
    });
    ParseOptions.prototype.clear = function () {
        this.parsers = [];
        this.root = null;
        this.nodeLists = {};
        this.error = false;
        this.tags.resetTag();
    };
    ParseOptions.prototype.addNode = function (property, node) {
        var list = this.nodeLists[property];
        if (!list) {
            list = this.nodeLists[property] = [];
        }
        list.push(node);
        if (node.kind !== property) {
            var inlists = (NodeUtil_js_1.default.getProperty(node, 'in-lists') || '');
            var lists = (inlists ? inlists.split(/,/) : []).concat(property).join(',');
            NodeUtil_js_1.default.setProperty(node, 'in-lists', lists);
        }
    };
    ParseOptions.prototype.getList = function (property) {
        var e_1, _a;
        var list = this.nodeLists[property] || [];
        var result = [];
        try {
            for (var list_1 = __values(list), list_1_1 = list_1.next(); !list_1_1.done; list_1_1 = list_1.next()) {
                var node = list_1_1.value;
                if (this.inTree(node)) {
                    result.push(node);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (list_1_1 && !list_1_1.done && (_a = list_1.return)) _a.call(list_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.nodeLists[property] = result;
        return result;
    };
    ParseOptions.prototype.removeFromList = function (property, nodes) {
        var e_2, _a;
        var list = this.nodeLists[property] || [];
        try {
            for (var nodes_1 = __values(nodes), nodes_1_1 = nodes_1.next(); !nodes_1_1.done; nodes_1_1 = nodes_1.next()) {
                var node = nodes_1_1.value;
                var i = list.indexOf(node);
                if (i >= 0) {
                    list.splice(i, 1);
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (nodes_1_1 && !nodes_1_1.done && (_a = nodes_1.return)) _a.call(nodes_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    ParseOptions.prototype.inTree = function (node) {
        while (node && node !== this.root) {
            node = node.parent;
        }
        return !!node;
    };
    return ParseOptions;
}());
exports["default"] = ParseOptions;
//# sourceMappingURL=ParseOptions.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/StackItem.js":
/*!*************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/StackItem.js ***!
  \*************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BaseItem = exports.MmlStack = void 0;
var TexError_js_1 = __importDefault(__webpack_require__(/*! ./TexError.js */ "./node_modules/mathjax-full/js/input/tex/TexError.js"));
var MmlStack = (function () {
    function MmlStack(_nodes) {
        this._nodes = _nodes;
    }
    Object.defineProperty(MmlStack.prototype, "nodes", {
        get: function () {
            return this._nodes;
        },
        enumerable: false,
        configurable: true
    });
    MmlStack.prototype.Push = function () {
        var _a;
        var nodes = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            nodes[_i] = arguments[_i];
        }
        (_a = this._nodes).push.apply(_a, __spreadArray([], __read(nodes), false));
    };
    MmlStack.prototype.Pop = function () {
        return this._nodes.pop();
    };
    Object.defineProperty(MmlStack.prototype, "First", {
        get: function () {
            return this._nodes[this.Size() - 1];
        },
        set: function (node) {
            this._nodes[this.Size() - 1] = node;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(MmlStack.prototype, "Last", {
        get: function () {
            return this._nodes[0];
        },
        set: function (node) {
            this._nodes[0] = node;
        },
        enumerable: false,
        configurable: true
    });
    MmlStack.prototype.Peek = function (n) {
        if (n == null) {
            n = 1;
        }
        return this._nodes.slice(this.Size() - n);
    };
    MmlStack.prototype.Size = function () {
        return this._nodes.length;
    };
    MmlStack.prototype.Clear = function () {
        this._nodes = [];
    };
    MmlStack.prototype.toMml = function (inferred, forceRow) {
        if (inferred === void 0) { inferred = true; }
        if (this._nodes.length === 1 && !forceRow) {
            return this.First;
        }
        return this.create('node', inferred ? 'inferredMrow' : 'mrow', this._nodes, {});
    };
    MmlStack.prototype.create = function (kind) {
        var _a;
        var rest = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            rest[_i - 1] = arguments[_i];
        }
        return (_a = this.factory.configuration.nodeFactory).create.apply(_a, __spreadArray([kind], __read(rest), false));
    };
    return MmlStack;
}());
exports.MmlStack = MmlStack;
var BaseItem = (function (_super) {
    __extends(BaseItem, _super);
    function BaseItem(factory) {
        var nodes = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            nodes[_i - 1] = arguments[_i];
        }
        var _this = _super.call(this, nodes) || this;
        _this.factory = factory;
        _this.global = {};
        _this._properties = {};
        if (_this.isOpen) {
            _this._env = {};
        }
        return _this;
    }
    Object.defineProperty(BaseItem.prototype, "kind", {
        get: function () {
            return 'base';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BaseItem.prototype, "env", {
        get: function () {
            return this._env;
        },
        set: function (value) {
            this._env = value;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BaseItem.prototype, "copyEnv", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    BaseItem.prototype.getProperty = function (key) {
        return this._properties[key];
    };
    BaseItem.prototype.setProperty = function (key, value) {
        this._properties[key] = value;
        return this;
    };
    Object.defineProperty(BaseItem.prototype, "isOpen", {
        get: function () {
            return false;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BaseItem.prototype, "isClose", {
        get: function () {
            return false;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BaseItem.prototype, "isFinal", {
        get: function () {
            return false;
        },
        enumerable: false,
        configurable: true
    });
    BaseItem.prototype.isKind = function (kind) {
        return kind === this.kind;
    };
    BaseItem.prototype.checkItem = function (item) {
        if (item.isKind('over') && this.isOpen) {
            item.setProperty('num', this.toMml(false));
            this.Clear();
        }
        if (item.isKind('cell') && this.isOpen) {
            if (item.getProperty('linebreak')) {
                return BaseItem.fail;
            }
            throw new TexError_js_1.default('Misplaced', 'Misplaced %1', item.getName());
        }
        if (item.isClose && this.getErrors(item.kind)) {
            var _a = __read(this.getErrors(item.kind), 2), id = _a[0], message = _a[1];
            throw new TexError_js_1.default(id, message, item.getName());
        }
        if (!item.isFinal) {
            return BaseItem.success;
        }
        this.Push(item.First);
        return BaseItem.fail;
    };
    BaseItem.prototype.clearEnv = function () {
        var e_1, _a;
        try {
            for (var _b = __values(Object.keys(this.env)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var id = _c.value;
                delete this.env[id];
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    BaseItem.prototype.setProperties = function (def) {
        Object.assign(this._properties, def);
        return this;
    };
    BaseItem.prototype.getName = function () {
        return this.getProperty('name');
    };
    BaseItem.prototype.toString = function () {
        return this.kind + '[' + this.nodes.join('; ') + ']';
    };
    BaseItem.prototype.getErrors = function (kind) {
        var CLASS = this.constructor;
        return (CLASS.errors || {})[kind] || BaseItem.errors[kind];
    };
    BaseItem.fail = [null, false];
    BaseItem.success = [null, true];
    BaseItem.errors = {
        end: ['MissingBeginExtraEnd', 'Missing \\begin{%1} or extra \\end{%1}'],
        close: ['ExtraCloseMissingOpen', 'Extra close brace or missing open brace'],
        right: ['MissingLeftExtraRight', 'Missing \\left or extra \\right'],
        middle: ['ExtraMiddle', 'Extra \\middle']
    };
    return BaseItem;
}(MmlStack));
exports.BaseItem = BaseItem;
//# sourceMappingURL=StackItem.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/StackItemFactory.js":
/*!********************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/StackItemFactory.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var _a;
Object.defineProperty(exports, "__esModule", ({ value: true }));
var StackItem_js_1 = __webpack_require__(/*! ./StackItem.js */ "./node_modules/mathjax-full/js/input/tex/StackItem.js");
var Factory_js_1 = __webpack_require__(/*! ../../core/Tree/Factory.js */ "./node_modules/mathjax-full/js/core/Tree/Factory.js");
var DummyItem = (function (_super) {
    __extends(DummyItem, _super);
    function DummyItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return DummyItem;
}(StackItem_js_1.BaseItem));
var StackItemFactory = (function (_super) {
    __extends(StackItemFactory, _super);
    function StackItemFactory() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.defaultKind = 'dummy';
        _this.configuration = null;
        return _this;
    }
    StackItemFactory.DefaultStackItems = (_a = {},
        _a[DummyItem.prototype.kind] = DummyItem,
        _a);
    return StackItemFactory;
}(Factory_js_1.AbstractFactory));
exports["default"] = StackItemFactory;
//# sourceMappingURL=StackItemFactory.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/TexConstants.js":
/*!****************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/TexConstants.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.TexConstant = void 0;
var TexConstant;
(function (TexConstant) {
    TexConstant.Variant = {
        NORMAL: 'normal',
        BOLD: 'bold',
        ITALIC: 'italic',
        BOLDITALIC: 'bold-italic',
        DOUBLESTRUCK: 'double-struck',
        FRAKTUR: 'fraktur',
        BOLDFRAKTUR: 'bold-fraktur',
        SCRIPT: 'script',
        BOLDSCRIPT: 'bold-script',
        SANSSERIF: 'sans-serif',
        BOLDSANSSERIF: 'bold-sans-serif',
        SANSSERIFITALIC: 'sans-serif-italic',
        SANSSERIFBOLDITALIC: 'sans-serif-bold-italic',
        MONOSPACE: 'monospace',
        INITIAL: 'inital',
        TAILED: 'tailed',
        LOOPED: 'looped',
        STRETCHED: 'stretched',
        CALLIGRAPHIC: '-tex-calligraphic',
        BOLDCALLIGRAPHIC: '-tex-bold-calligraphic',
        OLDSTYLE: '-tex-oldstyle',
        BOLDOLDSTYLE: '-tex-bold-oldstyle',
        MATHITALIC: '-tex-mathit'
    };
    TexConstant.Form = {
        PREFIX: 'prefix',
        INFIX: 'infix',
        POSTFIX: 'postfix'
    };
    TexConstant.LineBreak = {
        AUTO: 'auto',
        NEWLINE: 'newline',
        NOBREAK: 'nobreak',
        GOODBREAK: 'goodbreak',
        BADBREAK: 'badbreak'
    };
    TexConstant.LineBreakStyle = {
        BEFORE: 'before',
        AFTER: 'after',
        DUPLICATE: 'duplicate',
        INFIXLINBREAKSTYLE: 'infixlinebreakstyle'
    };
    TexConstant.IndentAlign = {
        LEFT: 'left',
        CENTER: 'center',
        RIGHT: 'right',
        AUTO: 'auto',
        ID: 'id',
        INDENTALIGN: 'indentalign'
    };
    TexConstant.IndentShift = {
        INDENTSHIFT: 'indentshift'
    };
    TexConstant.LineThickness = {
        THIN: 'thin',
        MEDIUM: 'medium',
        THICK: 'thick'
    };
    TexConstant.Notation = {
        LONGDIV: 'longdiv',
        ACTUARIAL: 'actuarial',
        PHASORANGLE: 'phasorangle',
        RADICAL: 'radical',
        BOX: 'box',
        ROUNDEDBOX: 'roundedbox',
        CIRCLE: 'circle',
        LEFT: 'left',
        RIGHT: 'right',
        TOP: 'top',
        BOTTOM: 'bottom',
        UPDIAGONALSTRIKE: 'updiagonalstrike',
        DOWNDIAGONALSTRIKE: 'downdiagonalstrike',
        VERTICALSTRIKE: 'verticalstrike',
        HORIZONTALSTRIKE: 'horizontalstrike',
        NORTHEASTARROW: 'northeastarrow',
        MADRUWB: 'madruwb',
        UPDIAGONALARROW: 'updiagonalarrow'
    };
    TexConstant.Align = {
        TOP: 'top',
        BOTTOM: 'bottom',
        CENTER: 'center',
        BASELINE: 'baseline',
        AXIS: 'axis',
        LEFT: 'left',
        RIGHT: 'right'
    };
    TexConstant.Lines = {
        NONE: 'none',
        SOLID: 'solid',
        DASHED: 'dashed'
    };
    TexConstant.Side = {
        LEFT: 'left',
        RIGHT: 'right',
        LEFTOVERLAP: 'leftoverlap',
        RIGHTOVERLAP: 'rightoverlap'
    };
    TexConstant.Width = {
        AUTO: 'auto',
        FIT: 'fit'
    };
    TexConstant.Actiontype = {
        TOGGLE: 'toggle',
        STATUSLINE: 'statusline',
        TOOLTIP: 'tooltip',
        INPUT: 'input'
    };
    TexConstant.Overflow = {
        LINBREAK: 'linebreak',
        SCROLL: 'scroll',
        ELIDE: 'elide',
        TRUNCATE: 'truncate',
        SCALE: 'scale'
    };
    TexConstant.Unit = {
        EM: 'em',
        EX: 'ex',
        PX: 'px',
        IN: 'in',
        CM: 'cm',
        MM: 'mm',
        PT: 'pt',
        PC: 'pc'
    };
})(TexConstant = exports.TexConstant || (exports.TexConstant = {}));
//# sourceMappingURL=TexConstants.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/base/BaseConfiguration.js":
/*!**************************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/base/BaseConfiguration.js ***!
  \**************************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __values = (this && this.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _a;
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.BaseConfiguration = exports.BaseTags = exports.Other = void 0;
var Configuration_js_1 = __webpack_require__(/*! ../Configuration.js */ "./node_modules/mathjax-full/js/input/tex/Configuration.js");
var MapHandler_js_1 = __webpack_require__(/*! ../MapHandler.js */ "./node_modules/mathjax-full/js/input/tex/MapHandler.js");
var TexError_js_1 = __importDefault(__webpack_require__(/*! ../TexError.js */ "./node_modules/mathjax-full/js/input/tex/TexError.js"));
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ../NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var SymbolMap_js_1 = __webpack_require__(/*! ../SymbolMap.js */ "./node_modules/mathjax-full/js/input/tex/SymbolMap.js");
var bitem = __importStar(__webpack_require__(/*! ./BaseItems.js */ "./node_modules/mathjax-full/js/input/tex/base/BaseItems.js"));
var Tags_js_1 = __webpack_require__(/*! ../Tags.js */ "./node_modules/mathjax-full/js/input/tex/Tags.js");
__webpack_require__(/*! ./BaseMappings.js */ "./node_modules/mathjax-full/js/input/tex/base/BaseMappings.js");
var OperatorDictionary_js_1 = __webpack_require__(/*! ../../../core/MmlTree/OperatorDictionary.js */ "./node_modules/mathjax-full/js/core/MmlTree/OperatorDictionary.js");
new SymbolMap_js_1.CharacterMap('remap', null, {
    '-': '\u2212',
    '*': '\u2217',
    '`': '\u2018'
});
function Other(parser, char) {
    var font = parser.stack.env['font'];
    var def = font ?
        { mathvariant: parser.stack.env['font'] } : {};
    var remap = MapHandler_js_1.MapHandler.getMap('remap').lookup(char);
    var range = (0, OperatorDictionary_js_1.getRange)(char);
    var type = (range ? range[3] : 'mo');
    var mo = parser.create('token', type, def, (remap ? remap.char : char));
    range[4] && mo.attributes.set('mathvariant', range[4]);
    if (type === 'mo') {
        NodeUtil_js_1.default.setProperty(mo, 'fixStretchy', true);
        parser.configuration.addNode('fixStretchy', mo);
    }
    parser.Push(mo);
}
exports.Other = Other;
function csUndefined(_parser, name) {
    throw new TexError_js_1.default('UndefinedControlSequence', 'Undefined control sequence %1', '\\' + name);
}
function envUndefined(_parser, env) {
    throw new TexError_js_1.default('UnknownEnv', 'Unknown environment \'%1\'', env);
}
function filterNonscript(_a) {
    var e_1, _b;
    var data = _a.data;
    try {
        for (var _c = __values(data.getList('nonscript')), _d = _c.next(); !_d.done; _d = _c.next()) {
            var mml = _d.value;
            if (mml.attributes.get('scriptlevel') > 0) {
                var parent_1 = mml.parent;
                parent_1.childNodes.splice(parent_1.childIndex(mml), 1);
                data.removeFromList(mml.kind, [mml]);
                if (mml.isKind('mrow')) {
                    var mstyle = mml.childNodes[0];
                    data.removeFromList('mstyle', [mstyle]);
                    data.removeFromList('mspace', mstyle.childNodes[0].childNodes);
                }
            }
            else if (mml.isKind('mrow')) {
                mml.parent.replaceChild(mml.childNodes[0], mml);
                data.removeFromList('mrow', [mml]);
            }
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_d && !_d.done && (_b = _c.return)) _b.call(_c);
        }
        finally { if (e_1) throw e_1.error; }
    }
}
var BaseTags = (function (_super) {
    __extends(BaseTags, _super);
    function BaseTags() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return BaseTags;
}(Tags_js_1.AbstractTags));
exports.BaseTags = BaseTags;
exports.BaseConfiguration = Configuration_js_1.Configuration.create('base', {
    handler: {
        character: ['command', 'special', 'letter', 'digit'],
        delimiter: ['delimiter'],
        macro: ['delimiter', 'macros', 'mathchar0mi', 'mathchar0mo', 'mathchar7'],
        environment: ['environment']
    },
    fallback: {
        character: Other,
        macro: csUndefined,
        environment: envUndefined
    },
    items: (_a = {},
        _a[bitem.StartItem.prototype.kind] = bitem.StartItem,
        _a[bitem.StopItem.prototype.kind] = bitem.StopItem,
        _a[bitem.OpenItem.prototype.kind] = bitem.OpenItem,
        _a[bitem.CloseItem.prototype.kind] = bitem.CloseItem,
        _a[bitem.PrimeItem.prototype.kind] = bitem.PrimeItem,
        _a[bitem.SubsupItem.prototype.kind] = bitem.SubsupItem,
        _a[bitem.OverItem.prototype.kind] = bitem.OverItem,
        _a[bitem.LeftItem.prototype.kind] = bitem.LeftItem,
        _a[bitem.Middle.prototype.kind] = bitem.Middle,
        _a[bitem.RightItem.prototype.kind] = bitem.RightItem,
        _a[bitem.BeginItem.prototype.kind] = bitem.BeginItem,
        _a[bitem.EndItem.prototype.kind] = bitem.EndItem,
        _a[bitem.StyleItem.prototype.kind] = bitem.StyleItem,
        _a[bitem.PositionItem.prototype.kind] = bitem.PositionItem,
        _a[bitem.CellItem.prototype.kind] = bitem.CellItem,
        _a[bitem.MmlItem.prototype.kind] = bitem.MmlItem,
        _a[bitem.FnItem.prototype.kind] = bitem.FnItem,
        _a[bitem.NotItem.prototype.kind] = bitem.NotItem,
        _a[bitem.NonscriptItem.prototype.kind] = bitem.NonscriptItem,
        _a[bitem.DotsItem.prototype.kind] = bitem.DotsItem,
        _a[bitem.ArrayItem.prototype.kind] = bitem.ArrayItem,
        _a[bitem.EqnArrayItem.prototype.kind] = bitem.EqnArrayItem,
        _a[bitem.EquationItem.prototype.kind] = bitem.EquationItem,
        _a),
    options: {
        maxMacros: 1000,
        baseURL: (typeof (document) === 'undefined' ||
            document.getElementsByTagName('base').length === 0) ?
            '' : String(document.location).replace(/#.*$/, '')
    },
    tags: {
        base: BaseTags
    },
    postprocessors: [[filterNonscript, -4]]
});
//# sourceMappingURL=BaseConfiguration.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/base/BaseItems.js":
/*!******************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/base/BaseItems.js ***!
  \******************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.EquationItem = exports.EqnArrayItem = exports.ArrayItem = exports.DotsItem = exports.NonscriptItem = exports.NotItem = exports.FnItem = exports.MmlItem = exports.CellItem = exports.PositionItem = exports.StyleItem = exports.EndItem = exports.BeginItem = exports.RightItem = exports.Middle = exports.LeftItem = exports.OverItem = exports.SubsupItem = exports.PrimeItem = exports.CloseItem = exports.OpenItem = exports.StopItem = exports.StartItem = void 0;
var MapHandler_js_1 = __webpack_require__(/*! ../MapHandler.js */ "./node_modules/mathjax-full/js/input/tex/MapHandler.js");
var Entities_js_1 = __webpack_require__(/*! ../../../util/Entities.js */ "./node_modules/mathjax-full/js/util/Entities.js");
var MmlNode_js_1 = __webpack_require__(/*! ../../../core/MmlTree/MmlNode.js */ "./node_modules/mathjax-full/js/core/MmlTree/MmlNode.js");
var TexError_js_1 = __importDefault(__webpack_require__(/*! ../TexError.js */ "./node_modules/mathjax-full/js/input/tex/TexError.js"));
var ParseUtil_js_1 = __importDefault(__webpack_require__(/*! ../ParseUtil.js */ "./node_modules/mathjax-full/js/input/tex/ParseUtil.js"));
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ../NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var StackItem_js_1 = __webpack_require__(/*! ../StackItem.js */ "./node_modules/mathjax-full/js/input/tex/StackItem.js");
var StartItem = (function (_super) {
    __extends(StartItem, _super);
    function StartItem(factory, global) {
        var _this = _super.call(this, factory) || this;
        _this.global = global;
        return _this;
    }
    Object.defineProperty(StartItem.prototype, "kind", {
        get: function () {
            return 'start';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(StartItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    StartItem.prototype.checkItem = function (item) {
        if (item.isKind('stop')) {
            var node = this.toMml();
            if (!this.global.isInner) {
                node = this.factory.configuration.tags.finalize(node, this.env);
            }
            return [[this.factory.create('mml', node)], true];
        }
        return _super.prototype.checkItem.call(this, item);
    };
    return StartItem;
}(StackItem_js_1.BaseItem));
exports.StartItem = StartItem;
var StopItem = (function (_super) {
    __extends(StopItem, _super);
    function StopItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(StopItem.prototype, "kind", {
        get: function () {
            return 'stop';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(StopItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return StopItem;
}(StackItem_js_1.BaseItem));
exports.StopItem = StopItem;
var OpenItem = (function (_super) {
    __extends(OpenItem, _super);
    function OpenItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(OpenItem.prototype, "kind", {
        get: function () {
            return 'open';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(OpenItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    OpenItem.prototype.checkItem = function (item) {
        if (item.isKind('close')) {
            var mml = this.toMml();
            var node = this.create('node', 'TeXAtom', [mml]);
            return [[this.factory.create('mml', node)], true];
        }
        return _super.prototype.checkItem.call(this, item);
    };
    OpenItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {
        'stop': ['ExtraOpenMissingClose',
            'Extra open brace or missing close brace']
    });
    return OpenItem;
}(StackItem_js_1.BaseItem));
exports.OpenItem = OpenItem;
var CloseItem = (function (_super) {
    __extends(CloseItem, _super);
    function CloseItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(CloseItem.prototype, "kind", {
        get: function () {
            return 'close';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(CloseItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return CloseItem;
}(StackItem_js_1.BaseItem));
exports.CloseItem = CloseItem;
var PrimeItem = (function (_super) {
    __extends(PrimeItem, _super);
    function PrimeItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(PrimeItem.prototype, "kind", {
        get: function () {
            return 'prime';
        },
        enumerable: false,
        configurable: true
    });
    PrimeItem.prototype.checkItem = function (item) {
        var _a = __read(this.Peek(2), 2), top0 = _a[0], top1 = _a[1];
        if (!NodeUtil_js_1.default.isType(top0, 'msubsup') || NodeUtil_js_1.default.isType(top0, 'msup')) {
            var node = this.create('node', 'msup', [top0, top1]);
            return [[node, item], true];
        }
        NodeUtil_js_1.default.setChild(top0, top0.sup, top1);
        return [[top0, item], true];
    };
    return PrimeItem;
}(StackItem_js_1.BaseItem));
exports.PrimeItem = PrimeItem;
var SubsupItem = (function (_super) {
    __extends(SubsupItem, _super);
    function SubsupItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(SubsupItem.prototype, "kind", {
        get: function () {
            return 'subsup';
        },
        enumerable: false,
        configurable: true
    });
    SubsupItem.prototype.checkItem = function (item) {
        if (item.isKind('open') || item.isKind('left')) {
            return StackItem_js_1.BaseItem.success;
        }
        var top = this.First;
        var position = this.getProperty('position');
        if (item.isKind('mml')) {
            if (this.getProperty('primes')) {
                if (position !== 2) {
                    NodeUtil_js_1.default.setChild(top, 2, this.getProperty('primes'));
                }
                else {
                    NodeUtil_js_1.default.setProperty(this.getProperty('primes'), 'variantForm', true);
                    var node = this.create('node', 'mrow', [this.getProperty('primes'), item.First]);
                    item.First = node;
                }
            }
            NodeUtil_js_1.default.setChild(top, position, item.First);
            if (this.getProperty('movesupsub') != null) {
                NodeUtil_js_1.default.setProperty(top, 'movesupsub', this.getProperty('movesupsub'));
            }
            var result = this.factory.create('mml', top);
            return [[result], true];
        }
        if (_super.prototype.checkItem.call(this, item)[1]) {
            var error = this.getErrors(['', 'sub', 'sup'][position]);
            throw new (TexError_js_1.default.bind.apply(TexError_js_1.default, __spreadArray([void 0, error[0], error[1]], __read(error.splice(2)), false)))();
        }
        return null;
    };
    SubsupItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {
        'stop': ['MissingScript',
            'Missing superscript or subscript argument'],
        'sup': ['MissingOpenForSup',
            'Missing open brace for superscript'],
        'sub': ['MissingOpenForSub',
            'Missing open brace for subscript']
    });
    return SubsupItem;
}(StackItem_js_1.BaseItem));
exports.SubsupItem = SubsupItem;
var OverItem = (function (_super) {
    __extends(OverItem, _super);
    function OverItem(factory) {
        var _this = _super.call(this, factory) || this;
        _this.setProperty('name', '\\over');
        return _this;
    }
    Object.defineProperty(OverItem.prototype, "kind", {
        get: function () {
            return 'over';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(OverItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    OverItem.prototype.checkItem = function (item) {
        if (item.isKind('over')) {
            throw new TexError_js_1.default('AmbiguousUseOf', 'Ambiguous use of %1', item.getName());
        }
        if (item.isClose) {
            var mml = this.create('node', 'mfrac', [this.getProperty('num'), this.toMml(false)]);
            if (this.getProperty('thickness') != null) {
                NodeUtil_js_1.default.setAttribute(mml, 'linethickness', this.getProperty('thickness'));
            }
            if (this.getProperty('open') || this.getProperty('close')) {
                NodeUtil_js_1.default.setProperty(mml, 'withDelims', true);
                mml = ParseUtil_js_1.default.fixedFence(this.factory.configuration, this.getProperty('open'), mml, this.getProperty('close'));
            }
            return [[this.factory.create('mml', mml), item], true];
        }
        return _super.prototype.checkItem.call(this, item);
    };
    OverItem.prototype.toString = function () {
        return 'over[' + this.getProperty('num') +
            ' / ' + this.nodes.join('; ') + ']';
    };
    return OverItem;
}(StackItem_js_1.BaseItem));
exports.OverItem = OverItem;
var LeftItem = (function (_super) {
    __extends(LeftItem, _super);
    function LeftItem(factory, delim) {
        var _this = _super.call(this, factory) || this;
        _this.setProperty('delim', delim);
        return _this;
    }
    Object.defineProperty(LeftItem.prototype, "kind", {
        get: function () {
            return 'left';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(LeftItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    LeftItem.prototype.checkItem = function (item) {
        if (item.isKind('right')) {
            return [[this.factory.create('mml', ParseUtil_js_1.default.fenced(this.factory.configuration, this.getProperty('delim'), this.toMml(), item.getProperty('delim'), '', item.getProperty('color')))], true];
        }
        if (item.isKind('middle')) {
            var def = { stretchy: true };
            if (item.getProperty('color')) {
                def.mathcolor = item.getProperty('color');
            }
            this.Push(this.create('node', 'TeXAtom', [], { texClass: MmlNode_js_1.TEXCLASS.CLOSE }), this.create('token', 'mo', def, item.getProperty('delim')), this.create('node', 'TeXAtom', [], { texClass: MmlNode_js_1.TEXCLASS.OPEN }));
            this.env = {};
            return [[this], true];
        }
        return _super.prototype.checkItem.call(this, item);
    };
    LeftItem.errors = Object.assign(Object.create(StackItem_js_1.BaseItem.errors), {
        'stop': ['ExtraLeftMissingRight',
            'Extra \\left or missing \\right']
    });
    return LeftItem;
}(StackItem_js_1.BaseItem));
exports.LeftItem = LeftItem;
var Middle = (function (_super) {
    __extends(Middle, _super);
    function Middle(factory, delim, color) {
        var _this = _super.call(this, factory) || this;
        _this.setProperty('delim', delim);
        color && _this.setProperty('color', color);
        return _this;
    }
    Object.defineProperty(Middle.prototype, "kind", {
        get: function () {
            return 'middle';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Middle.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return Middle;
}(StackItem_js_1.BaseItem));
exports.Middle = Middle;
var RightItem = (function (_super) {
    __extends(RightItem, _super);
    function RightItem(factory, delim, color) {
        var _this = _super.call(this, factory) || this;
        _this.setProperty('delim', delim);
        color && _this.setProperty('color', color);
        return _this;
    }
    Object.defineProperty(RightItem.prototype, "kind", {
        get: function () {
            return 'right';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(RightItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return RightItem;
}(StackItem_js_1.BaseItem));
exports.RightItem = RightItem;
var BeginItem = (function (_super) {
    __extends(BeginItem, _super);
    function BeginItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(BeginItem.prototype, "kind", {
        get: function () {
            return 'begin';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BeginItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    BeginItem.prototype.checkItem = function (item) {
        if (item.isKind('end')) {
            if (item.getName() !== this.getName()) {
                throw new TexError_js_1.default('EnvBadEnd', '\\begin{%1} ended with \\end{%2}', this.getName(), item.getName());
            }
            if (!this.getProperty('end')) {
                return [[this.factory.create('mml', this.toMml())], true];
            }
            return StackItem_js_1.BaseItem.fail;
        }
        if (item.isKind('stop')) {
            throw new TexError_js_1.default('EnvMissingEnd', 'Missing \\end{%1}', this.getName());
        }
        return _super.prototype.checkItem.call(this, item);
    };
    return BeginItem;
}(StackItem_js_1.BaseItem));
exports.BeginItem = BeginItem;
var EndItem = (function (_super) {
    __extends(EndItem, _super);
    function EndItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(EndItem.prototype, "kind", {
        get: function () {
            return 'end';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(EndItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return EndItem;
}(StackItem_js_1.BaseItem));
exports.EndItem = EndItem;
var StyleItem = (function (_super) {
    __extends(StyleItem, _super);
    function StyleItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(StyleItem.prototype, "kind", {
        get: function () {
            return 'style';
        },
        enumerable: false,
        configurable: true
    });
    StyleItem.prototype.checkItem = function (item) {
        if (!item.isClose) {
            return _super.prototype.checkItem.call(this, item);
        }
        var mml = this.create('node', 'mstyle', this.nodes, this.getProperty('styles'));
        return [[this.factory.create('mml', mml), item], true];
    };
    return StyleItem;
}(StackItem_js_1.BaseItem));
exports.StyleItem = StyleItem;
var PositionItem = (function (_super) {
    __extends(PositionItem, _super);
    function PositionItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(PositionItem.prototype, "kind", {
        get: function () {
            return 'position';
        },
        enumerable: false,
        configurable: true
    });
    PositionItem.prototype.checkItem = function (item) {
        if (item.isClose) {
            throw new TexError_js_1.default('MissingBoxFor', 'Missing box for %1', this.getName());
        }
        if (item.isFinal) {
            var mml = item.toMml();
            switch (this.getProperty('move')) {
                case 'vertical':
                    mml = this.create('node', 'mpadded', [mml], { height: this.getProperty('dh'),
                        depth: this.getProperty('dd'),
                        voffset: this.getProperty('dh') });
                    return [[this.factory.create('mml', mml)], true];
                case 'horizontal':
                    return [[this.factory.create('mml', this.getProperty('left')), item,
                            this.factory.create('mml', this.getProperty('right'))], true];
            }
        }
        return _super.prototype.checkItem.call(this, item);
    };
    return PositionItem;
}(StackItem_js_1.BaseItem));
exports.PositionItem = PositionItem;
var CellItem = (function (_super) {
    __extends(CellItem, _super);
    function CellItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(CellItem.prototype, "kind", {
        get: function () {
            return 'cell';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(CellItem.prototype, "isClose", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    return CellItem;
}(StackItem_js_1.BaseItem));
exports.CellItem = CellItem;
var MmlItem = (function (_super) {
    __extends(MmlItem, _super);
    function MmlItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(MmlItem.prototype, "isFinal", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(MmlItem.prototype, "kind", {
        get: function () {
            return 'mml';
        },
        enumerable: false,
        configurable: true
    });
    return MmlItem;
}(StackItem_js_1.BaseItem));
exports.MmlItem = MmlItem;
var FnItem = (function (_super) {
    __extends(FnItem, _super);
    function FnItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(FnItem.prototype, "kind", {
        get: function () {
            return 'fn';
        },
        enumerable: false,
        configurable: true
    });
    FnItem.prototype.checkItem = function (item) {
        var top = this.First;
        if (top) {
            if (item.isOpen) {
                return StackItem_js_1.BaseItem.success;
            }
            if (!item.isKind('fn')) {
                var mml = item.First;
                if (!item.isKind('mml') || !mml) {
                    return [[top, item], true];
                }
                if ((NodeUtil_js_1.default.isType(mml, 'mstyle') && mml.childNodes.length &&
                    NodeUtil_js_1.default.isType(mml.childNodes[0].childNodes[0], 'mspace')) ||
                    NodeUtil_js_1.default.isType(mml, 'mspace')) {
                    return [[top, item], true];
                }
                if (NodeUtil_js_1.default.isEmbellished(mml)) {
                    mml = NodeUtil_js_1.default.getCoreMO(mml);
                }
                var form = NodeUtil_js_1.default.getForm(mml);
                if (form != null && [0, 0, 1, 1, 0, 1, 1, 0, 0, 0][form[2]]) {
                    return [[top, item], true];
                }
            }
            var node = this.create('token', 'mo', { texClass: MmlNode_js_1.TEXCLASS.NONE }, Entities_js_1.entities.ApplyFunction);
            return [[top, node, item], true];
        }
        return _super.prototype.checkItem.apply(this, arguments);
    };
    return FnItem;
}(StackItem_js_1.BaseItem));
exports.FnItem = FnItem;
var NotItem = (function (_super) {
    __extends(NotItem, _super);
    function NotItem() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.remap = MapHandler_js_1.MapHandler.getMap('not_remap');
        return _this;
    }
    Object.defineProperty(NotItem.prototype, "kind", {
        get: function () {
            return 'not';
        },
        enumerable: false,
        configurable: true
    });
    NotItem.prototype.checkItem = function (item) {
        var mml;
        var c;
        var textNode;
        if (item.isKind('open') || item.isKind('left')) {
            return StackItem_js_1.BaseItem.success;
        }
        if (item.isKind('mml') &&
            (NodeUtil_js_1.default.isType(item.First, 'mo') || NodeUtil_js_1.default.isType(item.First, 'mi') ||
                NodeUtil_js_1.default.isType(item.First, 'mtext'))) {
            mml = item.First;
            c = NodeUtil_js_1.default.getText(mml);
            if (c.length === 1 && !NodeUtil_js_1.default.getProperty(mml, 'movesupsub') &&
                NodeUtil_js_1.default.getChildren(mml).length === 1) {
                if (this.remap.contains(c)) {
                    textNode = this.create('text', this.remap.lookup(c).char);
                    NodeUtil_js_1.default.setChild(mml, 0, textNode);
                }
                else {
                    textNode = this.create('text', '\u0338');
                    NodeUtil_js_1.default.appendChildren(mml, [textNode]);
                }
                return [[item], true];
            }
        }
        textNode = this.create('text', '\u29F8');
        var mtextNode = this.create('node', 'mtext', [], {}, textNode);
        var paddedNode = this.create('node', 'mpadded', [mtextNode], { width: 0 });
        mml = this.create('node', 'TeXAtom', [paddedNode], { texClass: MmlNode_js_1.TEXCLASS.REL });
        return [[mml, item], true];
    };
    return NotItem;
}(StackItem_js_1.BaseItem));
exports.NotItem = NotItem;
var NonscriptItem = (function (_super) {
    __extends(NonscriptItem, _super);
    function NonscriptItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(NonscriptItem.prototype, "kind", {
        get: function () {
            return 'nonscript';
        },
        enumerable: false,
        configurable: true
    });
    NonscriptItem.prototype.checkItem = function (item) {
        if (item.isKind('mml') && item.Size() === 1) {
            var mml = item.First;
            if (mml.isKind('mstyle') && mml.notParent) {
                mml = NodeUtil_js_1.default.getChildren(NodeUtil_js_1.default.getChildren(mml)[0])[0];
            }
            if (mml.isKind('mspace')) {
                if (mml !== item.First) {
                    var mrow = this.create('node', 'mrow', [item.Pop()]);
                    item.Push(mrow);
                }
                this.factory.configuration.addNode('nonscript', item.First);
            }
        }
        return [[item], true];
    };
    return NonscriptItem;
}(StackItem_js_1.BaseItem));
exports.NonscriptItem = NonscriptItem;
var DotsItem = (function (_super) {
    __extends(DotsItem, _super);
    function DotsItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(DotsItem.prototype, "kind", {
        get: function () {
            return 'dots';
        },
        enumerable: false,
        configurable: true
    });
    DotsItem.prototype.checkItem = function (item) {
        if (item.isKind('open') || item.isKind('left')) {
            return StackItem_js_1.BaseItem.success;
        }
        var dots = this.getProperty('ldots');
        var top = item.First;
        if (item.isKind('mml') && NodeUtil_js_1.default.isEmbellished(top)) {
            var tclass = NodeUtil_js_1.default.getTexClass(NodeUtil_js_1.default.getCoreMO(top));
            if (tclass === MmlNode_js_1.TEXCLASS.BIN || tclass === MmlNode_js_1.TEXCLASS.REL) {
                dots = this.getProperty('cdots');
            }
        }
        return [[dots, item], true];
    };
    return DotsItem;
}(StackItem_js_1.BaseItem));
exports.DotsItem = DotsItem;
var ArrayItem = (function (_super) {
    __extends(ArrayItem, _super);
    function ArrayItem() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.table = [];
        _this.row = [];
        _this.frame = [];
        _this.hfill = [];
        _this.arraydef = {};
        _this.dashed = false;
        return _this;
    }
    Object.defineProperty(ArrayItem.prototype, "kind", {
        get: function () {
            return 'array';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ArrayItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ArrayItem.prototype, "copyEnv", {
        get: function () {
            return false;
        },
        enumerable: false,
        configurable: true
    });
    ArrayItem.prototype.checkItem = function (item) {
        if (item.isClose && !item.isKind('over')) {
            if (item.getProperty('isEntry')) {
                this.EndEntry();
                this.clearEnv();
                return StackItem_js_1.BaseItem.fail;
            }
            if (item.getProperty('isCR')) {
                this.EndEntry();
                this.EndRow();
                this.clearEnv();
                return StackItem_js_1.BaseItem.fail;
            }
            this.EndTable();
            this.clearEnv();
            var newItem = this.factory.create('mml', this.createMml());
            if (this.getProperty('requireClose')) {
                if (item.isKind('close')) {
                    return [[newItem], true];
                }
                throw new TexError_js_1.default('MissingCloseBrace', 'Missing close brace');
            }
            return [[newItem, item], true];
        }
        return _super.prototype.checkItem.call(this, item);
    };
    ArrayItem.prototype.createMml = function () {
        var scriptlevel = this.arraydef['scriptlevel'];
        delete this.arraydef['scriptlevel'];
        var mml = this.create('node', 'mtable', this.table, this.arraydef);
        if (scriptlevel) {
            mml.setProperty('scriptlevel', scriptlevel);
        }
        if (this.frame.length === 4) {
            NodeUtil_js_1.default.setAttribute(mml, 'frame', this.dashed ? 'dashed' : 'solid');
        }
        else if (this.frame.length) {
            if (this.arraydef['rowlines']) {
                this.arraydef['rowlines'] =
                    this.arraydef['rowlines'].replace(/none( none)+$/, 'none');
            }
            NodeUtil_js_1.default.setAttribute(mml, 'frame', '');
            mml = this.create('node', 'menclose', [mml], { notation: this.frame.join(' ') });
            if ((this.arraydef['columnlines'] || 'none') !== 'none' ||
                (this.arraydef['rowlines'] || 'none') !== 'none') {
                NodeUtil_js_1.default.setAttribute(mml, 'data-padding', 0);
            }
        }
        if (this.getProperty('open') || this.getProperty('close')) {
            mml = ParseUtil_js_1.default.fenced(this.factory.configuration, this.getProperty('open'), mml, this.getProperty('close'));
        }
        return mml;
    };
    ArrayItem.prototype.EndEntry = function () {
        var mtd = this.create('node', 'mtd', this.nodes);
        if (this.hfill.length) {
            if (this.hfill[0] === 0) {
                NodeUtil_js_1.default.setAttribute(mtd, 'columnalign', 'right');
            }
            if (this.hfill[this.hfill.length - 1] === this.Size()) {
                NodeUtil_js_1.default.setAttribute(mtd, 'columnalign', NodeUtil_js_1.default.getAttribute(mtd, 'columnalign') ? 'center' : 'left');
            }
        }
        this.row.push(mtd);
        this.Clear();
        this.hfill = [];
    };
    ArrayItem.prototype.EndRow = function () {
        var node;
        if (this.getProperty('isNumbered') && this.row.length === 3) {
            this.row.unshift(this.row.pop());
            node = this.create('node', 'mlabeledtr', this.row);
        }
        else {
            node = this.create('node', 'mtr', this.row);
        }
        this.table.push(node);
        this.row = [];
    };
    ArrayItem.prototype.EndTable = function () {
        if (this.Size() || this.row.length) {
            this.EndEntry();
            this.EndRow();
        }
        this.checkLines();
    };
    ArrayItem.prototype.checkLines = function () {
        if (this.arraydef['rowlines']) {
            var lines = this.arraydef['rowlines'].split(/ /);
            if (lines.length === this.table.length) {
                this.frame.push('bottom');
                lines.pop();
                this.arraydef['rowlines'] = lines.join(' ');
            }
            else if (lines.length < this.table.length - 1) {
                this.arraydef['rowlines'] += ' none';
            }
        }
        if (this.getProperty('rowspacing')) {
            var rows = this.arraydef['rowspacing'].split(/ /);
            while (rows.length < this.table.length) {
                rows.push(this.getProperty('rowspacing') + 'em');
            }
            this.arraydef['rowspacing'] = rows.join(' ');
        }
    };
    ArrayItem.prototype.addRowSpacing = function (spacing) {
        if (this.arraydef['rowspacing']) {
            var rows = this.arraydef['rowspacing'].split(/ /);
            if (!this.getProperty('rowspacing')) {
                var dimem = ParseUtil_js_1.default.dimen2em(rows[0]);
                this.setProperty('rowspacing', dimem);
            }
            var rowspacing = this.getProperty('rowspacing');
            while (rows.length < this.table.length) {
                rows.push(ParseUtil_js_1.default.Em(rowspacing));
            }
            rows[this.table.length - 1] = ParseUtil_js_1.default.Em(Math.max(0, rowspacing + ParseUtil_js_1.default.dimen2em(spacing)));
            this.arraydef['rowspacing'] = rows.join(' ');
        }
    };
    return ArrayItem;
}(StackItem_js_1.BaseItem));
exports.ArrayItem = ArrayItem;
var EqnArrayItem = (function (_super) {
    __extends(EqnArrayItem, _super);
    function EqnArrayItem(factory) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var _this = _super.call(this, factory) || this;
        _this.maxrow = 0;
        _this.factory.configuration.tags.start(args[0], args[2], args[1]);
        return _this;
    }
    Object.defineProperty(EqnArrayItem.prototype, "kind", {
        get: function () {
            return 'eqnarray';
        },
        enumerable: false,
        configurable: true
    });
    EqnArrayItem.prototype.EndEntry = function () {
        if (this.row.length) {
            ParseUtil_js_1.default.fixInitialMO(this.factory.configuration, this.nodes);
        }
        var node = this.create('node', 'mtd', this.nodes);
        this.row.push(node);
        this.Clear();
    };
    EqnArrayItem.prototype.EndRow = function () {
        if (this.row.length > this.maxrow) {
            this.maxrow = this.row.length;
        }
        var mtr = 'mtr';
        var tag = this.factory.configuration.tags.getTag();
        if (tag) {
            this.row = [tag].concat(this.row);
            mtr = 'mlabeledtr';
        }
        this.factory.configuration.tags.clearTag();
        var node = this.create('node', mtr, this.row);
        this.table.push(node);
        this.row = [];
    };
    EqnArrayItem.prototype.EndTable = function () {
        _super.prototype.EndTable.call(this);
        this.factory.configuration.tags.end();
        this.extendArray('columnalign', this.maxrow);
        this.extendArray('columnwidth', this.maxrow);
        this.extendArray('columnspacing', this.maxrow - 1);
    };
    EqnArrayItem.prototype.extendArray = function (name, max) {
        if (!this.arraydef[name])
            return;
        var repeat = this.arraydef[name].split(/ /);
        var columns = __spreadArray([], __read(repeat), false);
        if (columns.length > 1) {
            while (columns.length < max) {
                columns.push.apply(columns, __spreadArray([], __read(repeat), false));
            }
            this.arraydef[name] = columns.slice(0, max).join(' ');
        }
    };
    return EqnArrayItem;
}(ArrayItem));
exports.EqnArrayItem = EqnArrayItem;
var EquationItem = (function (_super) {
    __extends(EquationItem, _super);
    function EquationItem(factory) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var _this = _super.call(this, factory) || this;
        _this.factory.configuration.tags.start('equation', true, args[0]);
        return _this;
    }
    Object.defineProperty(EquationItem.prototype, "kind", {
        get: function () {
            return 'equation';
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(EquationItem.prototype, "isOpen", {
        get: function () {
            return true;
        },
        enumerable: false,
        configurable: true
    });
    EquationItem.prototype.checkItem = function (item) {
        if (item.isKind('end')) {
            var mml = this.toMml();
            var tag = this.factory.configuration.tags.getTag();
            this.factory.configuration.tags.end();
            return [[tag ? this.factory.configuration.tags.enTag(mml, tag) : mml, item], true];
        }
        if (item.isKind('stop')) {
            throw new TexError_js_1.default('EnvMissingEnd', 'Missing \\end{%1}', this.getName());
        }
        return _super.prototype.checkItem.call(this, item);
    };
    return EquationItem;
}(StackItem_js_1.BaseItem));
exports.EquationItem = EquationItem;
//# sourceMappingURL=BaseItems.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/base/BaseMappings.js":
/*!*********************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/base/BaseMappings.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var sm = __importStar(__webpack_require__(/*! ../SymbolMap.js */ "./node_modules/mathjax-full/js/input/tex/SymbolMap.js"));
var TexConstants_js_1 = __webpack_require__(/*! ../TexConstants.js */ "./node_modules/mathjax-full/js/input/tex/TexConstants.js");
var BaseMethods_js_1 = __importDefault(__webpack_require__(/*! ./BaseMethods.js */ "./node_modules/mathjax-full/js/input/tex/base/BaseMethods.js"));
var ParseMethods_js_1 = __importDefault(__webpack_require__(/*! ../ParseMethods.js */ "./node_modules/mathjax-full/js/input/tex/ParseMethods.js"));
var ParseUtil_js_1 = __importDefault(__webpack_require__(/*! ../ParseUtil.js */ "./node_modules/mathjax-full/js/input/tex/ParseUtil.js"));
var MmlNode_js_1 = __webpack_require__(/*! ../../../core/MmlTree/MmlNode.js */ "./node_modules/mathjax-full/js/core/MmlTree/MmlNode.js");
var lengths_js_1 = __webpack_require__(/*! ../../../util/lengths.js */ "./node_modules/mathjax-full/js/util/lengths.js");
new sm.RegExpMap('letter', ParseMethods_js_1.default.variable, /[a-z]/i);
new sm.RegExpMap('digit', ParseMethods_js_1.default.digit, /[0-9.,]/);
new sm.RegExpMap('command', ParseMethods_js_1.default.controlSequence, /^\\/);
new sm.MacroMap('special', {
    '{': 'Open',
    '}': 'Close',
    '~': 'Tilde',
    '^': 'Superscript',
    '_': 'Subscript',
    ' ': 'Space',
    '\t': 'Space',
    '\r': 'Space',
    '\n': 'Space',
    '\'': 'Prime',
    '%': 'Comment',
    '&': 'Entry',
    '#': 'Hash',
    '\u00A0': 'Space',
    '\u2019': 'Prime'
}, BaseMethods_js_1.default);
new sm.CharacterMap('mathchar0mi', ParseMethods_js_1.default.mathchar0mi, {
    alpha: '\u03B1',
    beta: '\u03B2',
    gamma: '\u03B3',
    delta: '\u03B4',
    epsilon: '\u03F5',
    zeta: '\u03B6',
    eta: '\u03B7',
    theta: '\u03B8',
    iota: '\u03B9',
    kappa: '\u03BA',
    lambda: '\u03BB',
    mu: '\u03BC',
    nu: '\u03BD',
    xi: '\u03BE',
    omicron: '\u03BF',
    pi: '\u03C0',
    rho: '\u03C1',
    sigma: '\u03C3',
    tau: '\u03C4',
    upsilon: '\u03C5',
    phi: '\u03D5',
    chi: '\u03C7',
    psi: '\u03C8',
    omega: '\u03C9',
    varepsilon: '\u03B5',
    vartheta: '\u03D1',
    varpi: '\u03D6',
    varrho: '\u03F1',
    varsigma: '\u03C2',
    varphi: '\u03C6',
    S: ['\u00A7', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    aleph: ['\u2135', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    hbar: ['\u210F', { variantForm: true }],
    imath: '\u0131',
    jmath: '\u0237',
    ell: '\u2113',
    wp: ['\u2118', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    Re: ['\u211C', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    Im: ['\u2111', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    partial: ['\u2202', { mathvariant: TexConstants_js_1.TexConstant.Variant.ITALIC }],
    infty: ['\u221E', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    prime: ['\u2032', { variantForm: true }],
    emptyset: ['\u2205', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    nabla: ['\u2207', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    top: ['\u22A4', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    bot: ['\u22A5', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    angle: ['\u2220', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    triangle: ['\u25B3', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    backslash: ['\u2216', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    forall: ['\u2200', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    exists: ['\u2203', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    neg: ['\u00AC', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    lnot: ['\u00AC', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    flat: ['\u266D', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    natural: ['\u266E', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    sharp: ['\u266F', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    clubsuit: ['\u2663', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    diamondsuit: ['\u2662', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    heartsuit: ['\u2661', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }],
    spadesuit: ['\u2660', { mathvariant: TexConstants_js_1.TexConstant.Variant.NORMAL }]
});
new sm.CharacterMap('mathchar0mo', ParseMethods_js_1.default.mathchar0mo, {
    surd: '\u221A',
    coprod: ['\u2210', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigvee: ['\u22C1', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigwedge: ['\u22C0', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    biguplus: ['\u2A04', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigcap: ['\u22C2', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigcup: ['\u22C3', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    'int': ['\u222B', { texClass: MmlNode_js_1.TEXCLASS.OP }],
    intop: ['\u222B', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true, movablelimits: true }],
    iint: ['\u222C', { texClass: MmlNode_js_1.TEXCLASS.OP }],
    iiint: ['\u222D', { texClass: MmlNode_js_1.TEXCLASS.OP }],
    prod: ['\u220F', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    sum: ['\u2211', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigotimes: ['\u2A02', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigoplus: ['\u2A01', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    bigodot: ['\u2A00', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    oint: ['\u222E', { texClass: MmlNode_js_1.TEXCLASS.OP }],
    bigsqcup: ['\u2A06', { texClass: MmlNode_js_1.TEXCLASS.OP,
            movesupsub: true }],
    smallint: ['\u222B', { largeop: false }],
    triangleleft: '\u25C3',
    triangleright: '\u25B9',
    bigtriangleup: '\u25B3',
    bigtriangledown: '\u25BD',
    wedge: '\u2227',
    land: '\u2227',
    vee: '\u2228',
    lor: '\u2228',
    cap: '\u2229',
    cup: '\u222A',
    ddagger: '\u2021',
    dagger: '\u2020',
    sqcap: '\u2293',
    sqcup: '\u2294',
    uplus: '\u228E',
    amalg: '\u2A3F',
    diamond: '\u22C4',
    bullet: '\u2219',
    wr: '\u2240',
    div: '\u00F7',
    divsymbol: '\u00F7',
    odot: ['\u2299', { largeop: false }],
    oslash: ['\u2298', { largeop: false }],
    otimes: ['\u2297', { largeop: false }],
    ominus: ['\u2296', { largeop: false }],
    oplus: ['\u2295', { largeop: false }],
    mp: '\u2213',
    pm: '\u00B1',
    circ: '\u2218',
    bigcirc: '\u25EF',
    setminus: '\u2216',
    cdot: '\u22C5',
    ast: '\u2217',
    times: '\u00D7',
    star: '\u22C6',
    propto: '\u221D',
    sqsubseteq: '\u2291',
    sqsupseteq: '\u2292',
    parallel: '\u2225',
    mid: '\u2223',
    dashv: '\u22A3',
    vdash: '\u22A2',
    leq: '\u2264',
    le: '\u2264',
    geq: '\u2265',
    ge: '\u2265',
    lt: '\u003C',
    gt: '\u003E',
    succ: '\u227B',
    prec: '\u227A',
    approx: '\u2248',
    succeq: '\u2AB0',
    preceq: '\u2AAF',
    supset: '\u2283',
    subset: '\u2282',
    supseteq: '\u2287',
    subseteq: '\u2286',
    'in': '\u2208',
    ni: '\u220B',
    notin: '\u2209',
    owns: '\u220B',
    gg: '\u226B',
    ll: '\u226A',
    sim: '\u223C',
    simeq: '\u2243',
    perp: '\u22A5',
    equiv: '\u2261',
    asymp: '\u224D',
    smile: '\u2323',
    frown: '\u2322',
    ne: '\u2260',
    neq: '\u2260',
    cong: '\u2245',
    doteq: '\u2250',
    bowtie: '\u22C8',
    models: '\u22A8',
    notChar: '\u29F8',
    Leftrightarrow: '\u21D4',
    Leftarrow: '\u21D0',
    Rightarrow: '\u21D2',
    leftrightarrow: '\u2194',
    leftarrow: '\u2190',
    gets: '\u2190',
    rightarrow: '\u2192',
    to: ['\u2192', { accent: false }],
    mapsto: '\u21A6',
    leftharpoonup: '\u21BC',
    leftharpoondown: '\u21BD',
    rightharpoonup: '\u21C0',
    rightharpoondown: '\u21C1',
    nearrow: '\u2197',
    searrow: '\u2198',
    nwarrow: '\u2196',
    swarrow: '\u2199',
    rightleftharpoons: '\u21CC',
    hookrightarrow: '\u21AA',
    hookleftarrow: '\u21A9',
    longleftarrow: '\u27F5',
    Longleftarrow: '\u27F8',
    longrightarrow: '\u27F6',
    Longrightarrow: '\u27F9',
    Longleftrightarrow: '\u27FA',
    longleftrightarrow: '\u27F7',
    longmapsto: '\u27FC',
    ldots: '\u2026',
    cdots: '\u22EF',
    vdots: '\u22EE',
    ddots: '\u22F1',
    dotsc: '\u2026',
    dotsb: '\u22EF',
    dotsm: '\u22EF',
    dotsi: '\u22EF',
    dotso: '\u2026',
    ldotp: ['\u002E', { texClass: MmlNode_js_1.TEXCLASS.PUNCT }],
    cdotp: ['\u22C5', { texClass: MmlNode_js_1.TEXCLASS.PUNCT }],
    colon: ['\u003A', { texClass: MmlNode_js_1.TEXCLASS.PUNCT }]
});
new sm.CharacterMap('mathchar7', ParseMethods_js_1.default.mathchar7, {
    Gamma: '\u0393',
    Delta: '\u0394',
    Theta: '\u0398',
    Lambda: '\u039B',
    Xi: '\u039E',
    Pi: '\u03A0',
    Sigma: '\u03A3',
    Upsilon: '\u03A5',
    Phi: '\u03A6',
    Psi: '\u03A8',
    Omega: '\u03A9',
    '_': '\u005F',
    '#': '\u0023',
    '$': '\u0024',
    '%': '\u0025',
    '&': '\u0026',
    And: '\u0026'
});
new sm.DelimiterMap('delimiter', ParseMethods_js_1.default.delimiter, {
    '(': '(',
    ')': ')',
    '[': '[',
    ']': ']',
    '<': '\u27E8',
    '>': '\u27E9',
    '\\lt': '\u27E8',
    '\\gt': '\u27E9',
    '/': '/',
    '|': ['|', { texClass: MmlNode_js_1.TEXCLASS.ORD }],
    '.': '',
    '\\\\': '\\',
    '\\lmoustache': '\u23B0',
    '\\rmoustache': '\u23B1',
    '\\lgroup': '\u27EE',
    '\\rgroup': '\u27EF',
    '\\arrowvert': '\u23D0',
    '\\Arrowvert': '\u2016',
    '\\bracevert': '\u23AA',
    '\\Vert': ['\u2016', { texClass: MmlNode_js_1.TEXCLASS.ORD }],
    '\\|': ['\u2016', { texClass: MmlNode_js_1.TEXCLASS.ORD }],
    '\\vert': ['|', { texClass: MmlNode_js_1.TEXCLASS.ORD }],
    '\\uparrow': '\u2191',
    '\\downarrow': '\u2193',
    '\\updownarrow': '\u2195',
    '\\Uparrow': '\u21D1',
    '\\Downarrow': '\u21D3',
    '\\Updownarrow': '\u21D5',
    '\\backslash': '\\',
    '\\rangle': '\u27E9',
    '\\langle': '\u27E8',
    '\\rbrace': '}',
    '\\lbrace': '{',
    '\\}': '}',
    '\\{': '{',
    '\\rceil': '\u2309',
    '\\lceil': '\u2308',
    '\\rfloor': '\u230B',
    '\\lfloor': '\u230A',
    '\\lbrack': '[',
    '\\rbrack': ']'
});
new sm.CommandMap('macros', {
    displaystyle: ['SetStyle', 'D', true, 0],
    textstyle: ['SetStyle', 'T', false, 0],
    scriptstyle: ['SetStyle', 'S', false, 1],
    scriptscriptstyle: ['SetStyle', 'SS', false, 2],
    rm: ['SetFont', TexConstants_js_1.TexConstant.Variant.NORMAL],
    mit: ['SetFont', TexConstants_js_1.TexConstant.Variant.ITALIC],
    oldstyle: ['SetFont', TexConstants_js_1.TexConstant.Variant.OLDSTYLE],
    cal: ['SetFont', TexConstants_js_1.TexConstant.Variant.CALLIGRAPHIC],
    it: ['SetFont', TexConstants_js_1.TexConstant.Variant.MATHITALIC],
    bf: ['SetFont', TexConstants_js_1.TexConstant.Variant.BOLD],
    bbFont: ['SetFont', TexConstants_js_1.TexConstant.Variant.DOUBLESTRUCK],
    scr: ['SetFont', TexConstants_js_1.TexConstant.Variant.SCRIPT],
    frak: ['SetFont', TexConstants_js_1.TexConstant.Variant.FRAKTUR],
    sf: ['SetFont', TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    tt: ['SetFont', TexConstants_js_1.TexConstant.Variant.MONOSPACE],
    mathrm: ['MathFont', TexConstants_js_1.TexConstant.Variant.NORMAL],
    mathup: ['MathFont', TexConstants_js_1.TexConstant.Variant.NORMAL],
    mathnormal: ['MathFont', ''],
    mathbf: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLD],
    mathbfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLD],
    mathit: ['MathFont', TexConstants_js_1.TexConstant.Variant.MATHITALIC],
    mathbfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDITALIC],
    mathbb: ['MathFont', TexConstants_js_1.TexConstant.Variant.DOUBLESTRUCK],
    Bbb: ['MathFont', TexConstants_js_1.TexConstant.Variant.DOUBLESTRUCK],
    mathfrak: ['MathFont', TexConstants_js_1.TexConstant.Variant.FRAKTUR],
    mathbffrak: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDFRAKTUR],
    mathscr: ['MathFont', TexConstants_js_1.TexConstant.Variant.SCRIPT],
    mathbfscr: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSCRIPT],
    mathsf: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    mathsfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    mathbfsf: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSANSSERIF],
    mathbfsfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSANSSERIF],
    mathsfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIFITALIC],
    mathbfsfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIFBOLDITALIC],
    mathtt: ['MathFont', TexConstants_js_1.TexConstant.Variant.MONOSPACE],
    mathcal: ['MathFont', TexConstants_js_1.TexConstant.Variant.CALLIGRAPHIC],
    mathbfcal: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDCALLIGRAPHIC],
    symrm: ['MathFont', TexConstants_js_1.TexConstant.Variant.NORMAL],
    symup: ['MathFont', TexConstants_js_1.TexConstant.Variant.NORMAL],
    symnormal: ['MathFont', ''],
    symbf: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLD],
    symbfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLD],
    symit: ['MathFont', TexConstants_js_1.TexConstant.Variant.ITALIC],
    symbfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDITALIC],
    symbb: ['MathFont', TexConstants_js_1.TexConstant.Variant.DOUBLESTRUCK],
    symfrak: ['MathFont', TexConstants_js_1.TexConstant.Variant.FRAKTUR],
    symbffrak: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDFRAKTUR],
    symscr: ['MathFont', TexConstants_js_1.TexConstant.Variant.SCRIPT],
    symbfscr: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSCRIPT],
    symsf: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    symsfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    symbfsf: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSANSSERIF],
    symbfsfup: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDSANSSERIF],
    symsfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIFITALIC],
    symbfsfit: ['MathFont', TexConstants_js_1.TexConstant.Variant.SANSSERIFBOLDITALIC],
    symtt: ['MathFont', TexConstants_js_1.TexConstant.Variant.MONOSPACE],
    symcal: ['MathFont', TexConstants_js_1.TexConstant.Variant.CALLIGRAPHIC],
    symbfcal: ['MathFont', TexConstants_js_1.TexConstant.Variant.BOLDCALLIGRAPHIC],
    textrm: ['HBox', null, TexConstants_js_1.TexConstant.Variant.NORMAL],
    textup: ['HBox', null, TexConstants_js_1.TexConstant.Variant.NORMAL],
    textnormal: ['HBox'],
    textit: ['HBox', null, TexConstants_js_1.TexConstant.Variant.ITALIC],
    textbf: ['HBox', null, TexConstants_js_1.TexConstant.Variant.BOLD],
    textsf: ['HBox', null, TexConstants_js_1.TexConstant.Variant.SANSSERIF],
    texttt: ['HBox', null, TexConstants_js_1.TexConstant.Variant.MONOSPACE],
    tiny: ['SetSize', 0.5],
    Tiny: ['SetSize', 0.6],
    scriptsize: ['SetSize', 0.7],
    small: ['SetSize', 0.85],
    normalsize: ['SetSize', 1.0],
    large: ['SetSize', 1.2],
    Large: ['SetSize', 1.44],
    LARGE: ['SetSize', 1.73],
    huge: ['SetSize', 2.07],
    Huge: ['SetSize', 2.49],
    arcsin: 'NamedFn',
    arccos: 'NamedFn',
    arctan: 'NamedFn',
    arg: 'NamedFn',
    cos: 'NamedFn',
    cosh: 'NamedFn',
    cot: 'NamedFn',
    coth: 'NamedFn',
    csc: 'NamedFn',
    deg: 'NamedFn',
    det: 'NamedOp',
    dim: 'NamedFn',
    exp: 'NamedFn',
    gcd: 'NamedOp',
    hom: 'NamedFn',
    inf: 'NamedOp',
    ker: 'NamedFn',
    lg: 'NamedFn',
    lim: 'NamedOp',
    liminf: ['NamedOp', 'lim&thinsp;inf'],
    limsup: ['NamedOp', 'lim&thinsp;sup'],
    ln: 'NamedFn',
    log: 'NamedFn',
    max: 'NamedOp',
    min: 'NamedOp',
    Pr: 'NamedOp',
    sec: 'NamedFn',
    sin: 'NamedFn',
    sinh: 'NamedFn',
    sup: 'NamedOp',
    tan: 'NamedFn',
    tanh: 'NamedFn',
    limits: ['Limits', 1],
    nolimits: ['Limits', 0],
    overline: ['UnderOver', '2015'],
    underline: ['UnderOver', '2015'],
    overbrace: ['UnderOver', '23DE', 1],
    underbrace: ['UnderOver', '23DF', 1],
    overparen: ['UnderOver', '23DC'],
    underparen: ['UnderOver', '23DD'],
    overrightarrow: ['UnderOver', '2192'],
    underrightarrow: ['UnderOver', '2192'],
    overleftarrow: ['UnderOver', '2190'],
    underleftarrow: ['UnderOver', '2190'],
    overleftrightarrow: ['UnderOver', '2194'],
    underleftrightarrow: ['UnderOver', '2194'],
    overset: 'Overset',
    underset: 'Underset',
    overunderset: 'Overunderset',
    stackrel: ['Macro', '\\mathrel{\\mathop{#2}\\limits^{#1}}', 2],
    stackbin: ['Macro', '\\mathbin{\\mathop{#2}\\limits^{#1}}', 2],
    over: 'Over',
    overwithdelims: 'Over',
    atop: 'Over',
    atopwithdelims: 'Over',
    above: 'Over',
    abovewithdelims: 'Over',
    brace: ['Over', '{', '}'],
    brack: ['Over', '[', ']'],
    choose: ['Over', '(', ')'],
    frac: 'Frac',
    sqrt: 'Sqrt',
    root: 'Root',
    uproot: ['MoveRoot', 'upRoot'],
    leftroot: ['MoveRoot', 'leftRoot'],
    left: 'LeftRight',
    right: 'LeftRight',
    middle: 'LeftRight',
    llap: 'Lap',
    rlap: 'Lap',
    raise: 'RaiseLower',
    lower: 'RaiseLower',
    moveleft: 'MoveLeftRight',
    moveright: 'MoveLeftRight',
    ',': ['Spacer', lengths_js_1.MATHSPACE.thinmathspace],
    ':': ['Spacer', lengths_js_1.MATHSPACE.mediummathspace],
    '>': ['Spacer', lengths_js_1.MATHSPACE.mediummathspace],
    ';': ['Spacer', lengths_js_1.MATHSPACE.thickmathspace],
    '!': ['Spacer', lengths_js_1.MATHSPACE.negativethinmathspace],
    enspace: ['Spacer', .5],
    quad: ['Spacer', 1],
    qquad: ['Spacer', 2],
    thinspace: ['Spacer', lengths_js_1.MATHSPACE.thinmathspace],
    negthinspace: ['Spacer', lengths_js_1.MATHSPACE.negativethinmathspace],
    hskip: 'Hskip',
    hspace: 'Hskip',
    kern: 'Hskip',
    mskip: 'Hskip',
    mspace: 'Hskip',
    mkern: 'Hskip',
    rule: 'rule',
    Rule: ['Rule'],
    Space: ['Rule', 'blank'],
    nonscript: 'Nonscript',
    big: ['MakeBig', MmlNode_js_1.TEXCLASS.ORD, 0.85],
    Big: ['MakeBig', MmlNode_js_1.TEXCLASS.ORD, 1.15],
    bigg: ['MakeBig', MmlNode_js_1.TEXCLASS.ORD, 1.45],
    Bigg: ['MakeBig', MmlNode_js_1.TEXCLASS.ORD, 1.75],
    bigl: ['MakeBig', MmlNode_js_1.TEXCLASS.OPEN, 0.85],
    Bigl: ['MakeBig', MmlNode_js_1.TEXCLASS.OPEN, 1.15],
    biggl: ['MakeBig', MmlNode_js_1.TEXCLASS.OPEN, 1.45],
    Biggl: ['MakeBig', MmlNode_js_1.TEXCLASS.OPEN, 1.75],
    bigr: ['MakeBig', MmlNode_js_1.TEXCLASS.CLOSE, 0.85],
    Bigr: ['MakeBig', MmlNode_js_1.TEXCLASS.CLOSE, 1.15],
    biggr: ['MakeBig', MmlNode_js_1.TEXCLASS.CLOSE, 1.45],
    Biggr: ['MakeBig', MmlNode_js_1.TEXCLASS.CLOSE, 1.75],
    bigm: ['MakeBig', MmlNode_js_1.TEXCLASS.REL, 0.85],
    Bigm: ['MakeBig', MmlNode_js_1.TEXCLASS.REL, 1.15],
    biggm: ['MakeBig', MmlNode_js_1.TEXCLASS.REL, 1.45],
    Biggm: ['MakeBig', MmlNode_js_1.TEXCLASS.REL, 1.75],
    mathord: ['TeXAtom', MmlNode_js_1.TEXCLASS.ORD],
    mathop: ['TeXAtom', MmlNode_js_1.TEXCLASS.OP],
    mathopen: ['TeXAtom', MmlNode_js_1.TEXCLASS.OPEN],
    mathclose: ['TeXAtom', MmlNode_js_1.TEXCLASS.CLOSE],
    mathbin: ['TeXAtom', MmlNode_js_1.TEXCLASS.BIN],
    mathrel: ['TeXAtom', MmlNode_js_1.TEXCLASS.REL],
    mathpunct: ['TeXAtom', MmlNode_js_1.TEXCLASS.PUNCT],
    mathinner: ['TeXAtom', MmlNode_js_1.TEXCLASS.INNER],
    vcenter: ['TeXAtom', MmlNode_js_1.TEXCLASS.VCENTER],
    buildrel: 'BuildRel',
    hbox: ['HBox', 0],
    text: 'HBox',
    mbox: ['HBox', 0],
    fbox: 'FBox',
    boxed: ['Macro', '\\fbox{$\\displaystyle{#1}$}', 1],
    framebox: 'FrameBox',
    strut: 'Strut',
    mathstrut: ['Macro', '\\vphantom{(}'],
    phantom: 'Phantom',
    vphantom: ['Phantom', 1, 0],
    hphantom: ['Phantom', 0, 1],
    smash: 'Smash',
    acute: ['Accent', '00B4'],
    grave: ['Accent', '0060'],
    ddot: ['Accent', '00A8'],
    tilde: ['Accent', '007E'],
    bar: ['Accent', '00AF'],
    breve: ['Accent', '02D8'],
    check: ['Accent', '02C7'],
    hat: ['Accent', '005E'],
    vec: ['Accent', '2192'],
    dot: ['Accent', '02D9'],
    widetilde: ['Accent', '007E', 1],
    widehat: ['Accent', '005E', 1],
    matrix: 'Matrix',
    array: 'Matrix',
    pmatrix: ['Matrix', '(', ')'],
    cases: ['Matrix', '{', '', 'left left', null, '.1em', null,
        true],
    eqalign: ['Matrix', null, null, 'right left',
        (0, lengths_js_1.em)(lengths_js_1.MATHSPACE.thickmathspace), '.5em', 'D'],
    displaylines: ['Matrix', null, null, 'center', null, '.5em', 'D'],
    cr: 'Cr',
    '\\': 'CrLaTeX',
    newline: ['CrLaTeX', true],
    hline: ['HLine', 'solid'],
    hdashline: ['HLine', 'dashed'],
    eqalignno: ['Matrix', null, null, 'right left',
        (0, lengths_js_1.em)(lengths_js_1.MATHSPACE.thickmathspace), '.5em', 'D', null,
        'right'],
    leqalignno: ['Matrix', null, null, 'right left',
        (0, lengths_js_1.em)(lengths_js_1.MATHSPACE.thickmathspace), '.5em', 'D', null,
        'left'],
    hfill: 'HFill',
    hfil: 'HFill',
    hfilll: 'HFill',
    bmod: ['Macro', '\\mmlToken{mo}[lspace="thickmathspace"' +
            ' rspace="thickmathspace"]{mod}'],
    pmod: ['Macro', '\\pod{\\mmlToken{mi}{mod}\\kern 6mu #1}', 1],
    mod: ['Macro', '\\mathchoice{\\kern18mu}{\\kern12mu}' +
            '{\\kern12mu}{\\kern12mu}\\mmlToken{mi}{mod}\\,\\,#1',
        1],
    pod: ['Macro', '\\mathchoice{\\kern18mu}{\\kern8mu}' +
            '{\\kern8mu}{\\kern8mu}(#1)', 1],
    iff: ['Macro', '\\;\\Longleftrightarrow\\;'],
    skew: ['Macro', '{{#2{#3\\mkern#1mu}\\mkern-#1mu}{}}', 3],
    pmb: ['Macro', '\\rlap{#1}\\kern1px{#1}', 1],
    TeX: ['Macro', 'T\\kern-.14em\\lower.5ex{E}\\kern-.115em X'],
    LaTeX: ['Macro', 'L\\kern-.325em\\raise.21em' +
            '{\\scriptstyle{A}}\\kern-.17em\\TeX'],
    ' ': ['Macro', '\\text{ }'],
    not: 'Not',
    dots: 'Dots',
    space: 'Tilde',
    '\u00A0': 'Tilde',
    begin: 'BeginEnd',
    end: 'BeginEnd',
    label: 'HandleLabel',
    ref: 'HandleRef',
    nonumber: 'HandleNoTag',
    mathchoice: 'MathChoice',
    mmlToken: 'MmlToken'
}, BaseMethods_js_1.default);
new sm.EnvironmentMap('environment', ParseMethods_js_1.default.environment, {
    array: ['AlignedArray'],
    equation: ['Equation', null, true],
    eqnarray: ['EqnArray', null, true, true, 'rcl',
        ParseUtil_js_1.default.cols(0, lengths_js_1.MATHSPACE.thickmathspace), '.5em']
}, BaseMethods_js_1.default);
new sm.CharacterMap('not_remap', null, {
    '\u2190': '\u219A',
    '\u2192': '\u219B',
    '\u2194': '\u21AE',
    '\u21D0': '\u21CD',
    '\u21D2': '\u21CF',
    '\u21D4': '\u21CE',
    '\u2208': '\u2209',
    '\u220B': '\u220C',
    '\u2223': '\u2224',
    '\u2225': '\u2226',
    '\u223C': '\u2241',
    '\u007E': '\u2241',
    '\u2243': '\u2244',
    '\u2245': '\u2247',
    '\u2248': '\u2249',
    '\u224D': '\u226D',
    '\u003D': '\u2260',
    '\u2261': '\u2262',
    '\u003C': '\u226E',
    '\u003E': '\u226F',
    '\u2264': '\u2270',
    '\u2265': '\u2271',
    '\u2272': '\u2274',
    '\u2273': '\u2275',
    '\u2276': '\u2278',
    '\u2277': '\u2279',
    '\u227A': '\u2280',
    '\u227B': '\u2281',
    '\u2282': '\u2284',
    '\u2283': '\u2285',
    '\u2286': '\u2288',
    '\u2287': '\u2289',
    '\u22A2': '\u22AC',
    '\u22A8': '\u22AD',
    '\u22A9': '\u22AE',
    '\u22AB': '\u22AF',
    '\u227C': '\u22E0',
    '\u227D': '\u22E1',
    '\u2291': '\u22E2',
    '\u2292': '\u22E3',
    '\u22B2': '\u22EA',
    '\u22B3': '\u22EB',
    '\u22B4': '\u22EC',
    '\u22B5': '\u22ED',
    '\u2203': '\u2204'
});
//# sourceMappingURL=BaseMappings.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/input/tex/base/BaseMethods.js":
/*!********************************************************************!*\
  !*** ./node_modules/mathjax-full/js/input/tex/base/BaseMethods.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
var sitem = __importStar(__webpack_require__(/*! ./BaseItems.js */ "./node_modules/mathjax-full/js/input/tex/base/BaseItems.js"));
var NodeUtil_js_1 = __importDefault(__webpack_require__(/*! ../NodeUtil.js */ "./node_modules/mathjax-full/js/input/tex/NodeUtil.js"));
var TexError_js_1 = __importDefault(__webpack_require__(/*! ../TexError.js */ "./node_modules/mathjax-full/js/input/tex/TexError.js"));
var TexParser_js_1 = __importDefault(__webpack_require__(/*! ../TexParser.js */ "./node_modules/mathjax-full/js/input/tex/TexParser.js"));
var TexConstants_js_1 = __webpack_require__(/*! ../TexConstants.js */ "./node_modules/mathjax-full/js/input/tex/TexConstants.js");
var ParseUtil_js_1 = __importDefault(__webpack_require__(/*! ../ParseUtil.js */ "./node_modules/mathjax-full/js/input/tex/ParseUtil.js"));
var MmlNode_js_1 = __webpack_require__(/*! ../../../core/MmlTree/MmlNode.js */ "./node_modules/mathjax-full/js/core/MmlTree/MmlNode.js");
var Tags_js_1 = __webpack_require__(/*! ../Tags.js */ "./node_modules/mathjax-full/js/input/tex/Tags.js");
var lengths_js_1 = __webpack_require__(/*! ../../../util/lengths.js */ "./node_modules/mathjax-full/js/util/lengths.js");
var Entities_js_1 = __webpack_require__(/*! ../../../util/Entities.js */ "./node_modules/mathjax-full/js/util/Entities.js");
var Options_js_1 = __webpack_require__(/*! ../../../util/Options.js */ "./node_modules/mathjax-full/js/util/Options.js");
var BaseMethods = {};
var P_HEIGHT = 1.2 / .85;
var MmlTokenAllow = {
    fontfamily: 1, fontsize: 1, fontweight: 1, fontstyle: 1,
    color: 1, background: 1,
    id: 1, 'class': 1, href: 1, style: 1
};
BaseMethods.Open = function (parser, _c) {
    parser.Push(parser.itemFactory.create('open'));
};
BaseMethods.Close = function (parser, _c) {
    parser.Push(parser.itemFactory.create('close'));
};
BaseMethods.Tilde = function (parser, _c) {
    parser.Push(parser.create('token', 'mtext', {}, Entities_js_1.entities.nbsp));
};
BaseMethods.Space = function (_parser, _c) { };
BaseMethods.Superscript = function (parser, _c) {
    var _a;
    if (parser.GetNext().match(/\d/)) {
        parser.string = parser.string.substr(0, parser.i + 1) +
            ' ' + parser.string.substr(parser.i + 1);
    }
    var primes;
    var base;
    var top = parser.stack.Top();
    if (top.isKind('prime')) {
        _a = __read(top.Peek(2), 2), base = _a[0], primes = _a[1];
        parser.stack.Pop();
    }
    else {
        base = parser.stack.Prev();
        if (!base) {
            base = parser.create('token', 'mi', {}, '');
        }
    }
    var movesupsub = NodeUtil_js_1.default.getProperty(base, 'movesupsub');
    var position = NodeUtil_js_1.default.isType(base, 'msubsup') ? base.sup :
        base.over;
    if ((NodeUtil_js_1.default.isType(base, 'msubsup') && !NodeUtil_js_1.default.isType(base, 'msup') &&
        NodeUtil_js_1.default.getChildAt(base, base.sup)) ||
        (NodeUtil_js_1.default.isType(base, 'munderover') && !NodeUtil_js_1.default.isType(base, 'mover') &&
            NodeUtil_js_1.default.getChildAt(base, base.over) &&
            !NodeUtil_js_1.default.getProperty(base, 'subsupOK'))) {
        throw new TexError_js_1.default('DoubleExponent', 'Double exponent: use braces to clarify');
    }
    if (!NodeUtil_js_1.default.isType(base, 'msubsup') || NodeUtil_js_1.default.isType(base, 'msup')) {
        if (movesupsub) {
            if (!NodeUtil_js_1.default.isType(base, 'munderover') || NodeUtil_js_1.default.isType(base, 'mover') ||
                NodeUtil_js_1.default.getChildAt(base, base.over)) {
                base = parser.create('node', 'munderover', [base], { movesupsub: true });
            }
            position = base.over;
        }
        else {
            base = parser.create('node', 'msubsup', [base]);
            position = base.sup;
        }
    }
    parser.Push(parser.itemFactory.create('subsup', base).setProperties({
        position: position, primes: primes, movesupsub: movesupsub
    }));
};
BaseMethods.Subscript = function (parser, _c) {
    var _a;
    if (parser.GetNext().match(/\d/)) {
        parser.string =
            parser.string.substr(0, parser.i + 1) + ' ' +
                parser.string.substr(parser.i + 1);
    }
    var primes, base;
    var top = parser.stack.Top();
    if (top.isKind('prime')) {
        _a = __read(top.Peek(2), 2), base = _a[0], primes = _a[1];
        parser.stack.Pop();
    }
    else {
        base = parser.stack.Prev();
        if (!base) {
            base = parser.create('token', 'mi', {}, '');
        }
    }
    var movesupsub = NodeUtil_js_1.default.getProperty(base, 'movesupsub');
    var position = NodeUtil_js_1.default.isType(base, 'msubsup') ?
        base.sub : base.under;
    if ((NodeUtil_js_1.default.isType(base, 'msubsup') && !NodeUtil_js_1.default.isType(base, 'msup') &&
        NodeUtil_js_1.default.getChildAt(base, base.sub)) ||
        (NodeUtil_js_1.default.isType(base, 'munderover') && !NodeUtil_js_1.default.isType(base, 'mover') &&
            NodeUtil_js_1.default.getChildAt(base, base.under) &&
            !NodeUtil_js_1.default.getProperty(base, 'subsupOK'))) {
        throw new TexError_js_1.default('DoubleSubscripts', 'Double subscripts: use braces to clarify');
    }
    if (!NodeUtil_js_1.default.isType(base, 'msubsup') || NodeUtil_js_1.default.isType(base, 'msup')) {
        if (movesupsub) {
            if (!NodeUtil_js_1.default.isType(base, 'munderover') || NodeUtil_js_1.default.isType(base, 'mover') ||
                NodeUtil_js_1.default.getChildAt(base, base.under)) {
                base = parser.create('node', 'munderover', [base], { movesupsub: true });
            }
            position = base.under;
        }
        else {
            base = parser.create('node', 'msubsup', [base]);
            position = base.sub;
        }
    }
    parser.Push(parser.itemFactory.create('subsup', base).setProperties({
        position: position, primes: primes, movesupsub: movesupsub
    }));
};
BaseMethods.Prime = function (parser, c) {
    var base = parser.stack.Prev();
    if (!base) {
        base = parser.create('node', 'mi');
    }
    if (NodeUtil_js_1.default.isType(base, 'msubsup') && !NodeUtil_js_1.default.isType(base, 'msup') &&
        NodeUtil_js_1.default.getChildAt(base, base.sup)) {
        throw new TexError_js_1.default('DoubleExponentPrime', 'Prime causes double exponent: use braces to clarify');
    }
    var sup = '';
    parser.i--;
    do {
        sup += Entities_js_1.entities.prime;
        parser.i++, c = parser.GetNext();
    } while (c === '\'' || c === Entities_js_1.entities.rsquo);
    sup = ['', '\u2032', '\u2033', '\u2034', '\u2057'][sup.length] || sup;
    var node = parser.create('token', 'mo', { variantForm: true }, sup);
    parser.Push(parser.itemFactory.create('prime', base, node));
};
BaseMethods.Comment = function (parser, _c) {
    while (parser.i < parser.string.length && parser.string.charAt(parser.i) !== '\n') {
        parser.i++;
    }
};
BaseMethods.Hash = function (_parser, _c) {
    throw new TexError_js_1.default('CantUseHash1', 'You can\'t use \'macro parameter character #\' in math mode');
};
BaseMethods.MathFont = function (parser, name, variant) {
    var text = parser.GetArgument(name);
    var mml = new TexParser_js_1.default(text, __assign(__assign({}, parser.stack.env), { font: variant, multiLetterIdentifiers: /^[a-zA-Z]+/, noAutoOP: true }), parser.configuration).mml();
    parser.Push(parser.create('node', 'TeXAtom', [mml]));
};
BaseMethods.SetFont = function (parser, _name, font) {
    parser.stack.env['font'] = font;
};
BaseMethods.SetStyle = function (parser, _name, texStyle, style, level) {
    parser.stack.env['style'] = texStyle;
    parser.stack.env['level'] = level;
    parser.Push(parser.itemFactory.create('style').setProperty('styles', { displaystyle: style, scriptlevel: level }));
};
BaseMethods.SetSize = function (parser, _name, size) {
    parser.stack.env['size'] = size;
    parser.Push(parser.itemFactory.create('style').setProperty('styles', { mathsize: (0, lengths_js_1.em)(size) }));
};
BaseMethods.Spacer = function (parser, _name, space) {
    var node = parser.create('node', 'mspace', [], { width: (0, lengths_js_1.em)(space) });
    var style = parser.create('node', 'mstyle', [node], { scriptlevel: 0 });
    parser.Push(style);
};
BaseMethods.LeftRight = function (parser, name) {
    var first = name.substr(1);
    parser.Push(parser.itemFactory.create(first, parser.GetDelimiter(name), parser.stack.env.color));
};
BaseMethods.NamedFn = function (parser, name, id) {
    if (!id) {
        id = name.substr(1);
    }
    var mml = parser.create('token', 'mi', { texClass: MmlNode_js_1.TEXCLASS.OP }, id);
    parser.Push(parser.itemFactory.create('fn', mml));
};
BaseMethods.NamedOp = function (parser, name, id) {
    if (!id) {
        id = name.substr(1);
    }
    id = id.replace(/&thinsp;/, '\u2006');
    var mml = parser.create('token', 'mo', {
        movablelimits: true,
        movesupsub: true,
        form: TexConstants_js_1.TexConstant.Form.PREFIX,
        texClass: MmlNode_js_1.TEXCLASS.OP
    }, id);
    parser.Push(mml);
};
BaseMethods.Limits = function (parser, _name, limits) {
    var op = parser.stack.Prev(true);
    if (!op || (NodeUtil_js_1.default.getTexClass(NodeUtil_js_1.default.getCoreMO(op)) !== MmlNode_js_1.TEXCLASS.OP &&
        NodeUtil_js_1.default.getProperty(op, 'movesupsub') == null)) {
        throw new TexError_js_1.default('MisplacedLimits', '%1 is allowed only on operators', parser.currentCS);
    }
    var top = parser.stack.Top();
    var node;
    if (NodeUtil_js_1.default.isType(op, 'munderover') && !limits) {
        node = parser.create('node', 'msubsup');
        NodeUtil_js_1.default.copyChildren(op, node);
        op = top.Last = node;
    }
    else if (NodeUtil_js_1.default.isType(op, 'msubsup') && limits) {
        node = parser.create('node', 'munderover');
        NodeUtil_js_1.default.copyChildren(op, node);
        op = top.Last = node;
    }
    NodeUtil_js_1.default.setProperty(op, 'movesupsub', limits ? true : false);
    NodeUtil_js_1.default.setProperties(NodeUtil_js_1.default.getCoreMO(op), { 'movablelimits': false });
    if (NodeUtil_js_1.default.getAttribute(op, 'movablelimits') ||
        NodeUtil_js_1.default.getProperty(op, 'movablelimits')) {
        NodeUtil_js_1.default.setProperties(op, { 'movablelimits': false });
    }
};
BaseMethods.Over = function (parser, name, open, close) {
    var mml = parser.itemFactory.create('over').setProperty('name', parser.currentCS);
    if (open || close) {
        mml.setProperty('open', open);
        mml.setProperty('close', close);
    }
    else if (name.match(/withdelims$/)) {
        mml.setProperty('open', parser.GetDelimiter(name));
        mml.setProperty('close', parser.GetDelimiter(name));
    }
    if (name.match(/^\\above/)) {
        mml.setProperty('thickness', parser.GetDimen(name));
    }
    else if (name.match(/^\\atop/) || open || close) {
        mml.setProperty('thickness', 0);
    }
    parser.Push(mml);
};
BaseMethods.Frac = function (parser, name) {
    var num = parser.ParseArg(name);
    var den = parser.ParseArg(name);
    var node = parser.create('node', 'mfrac', [num, den]);
    parser.Push(node);
};
BaseMethods.Sqrt = function (parser, name) {
    var n = parser.GetBrackets(name);
    var arg = parser.GetArgument(name);
    if (arg === '\\frac') {
        arg += '{' + parser.GetArgument(arg) + '}{' + parser.GetArgument(arg) + '}';
    }
    var mml = new TexParser_js_1.default(arg, parser.stack.env, parser.configuration).mml();
    if (!n) {
        mml = parser.create('node', 'msqrt', [mml]);
    }
    else {
        mml = parser.create('node', 'mroot', [mml, parseRoot(parser, n)]);
    }
    parser.Push(mml);
};
function parseRoot(parser, n) {
    var env = parser.stack.env;
    var inRoot = env['inRoot'];
    env['inRoot'] = true;
    var newParser = new TexParser_js_1.default(n, env, parser.configuration);
    var node = newParser.mml();
    var global = newParser.stack.global;
    if (global['leftRoot'] || global['upRoot']) {
        var def = {};
        if (global['leftRoot']) {
            def['width'] = global['leftRoot'];
        }
        if (global['upRoot']) {
            def['voffset'] = global['upRoot'];
            def['height'] = global['upRoot'];
        }
        node = parser.create('node', 'mpadded', [node], def);
    }
    env['inRoot'] = inRoot;
    return node;
}
BaseMethods.Root = function (parser, name) {
    var n = parser.GetUpTo(name, '\\of');
    var arg = parser.ParseArg(name);
    var node = parser.create('node', 'mroot', [arg, parseRoot(parser, n)]);
    parser.Push(node);
};
BaseMethods.MoveRoot = function (parser, name, id) {
    if (!parser.stack.env['inRoot']) {
        throw new TexError_js_1.default('MisplacedMoveRoot', '%1 can appear only within a root', parser.currentCS);
    }
    if (parser.stack.global[id]) {
        throw new TexError_js_1.default('MultipleMoveRoot', 'Multiple use of %1', parser.currentCS);
    }
    var n = parser.GetArgument(name);
    if (!n.match(/-?[0-9]+/)) {
        throw new TexError_js_1.default('IntegerArg', 'The argument to %1 must be an integer', parser.currentCS);
    }
    n = (parseInt(n, 10) / 15) + 'em';
    if (n.substr(0, 1) !== '-') {
        n = '+' + n;
    }
    parser.stack.global[id] = n;
};
BaseMethods.Accent = function (parser, name, accent, stretchy) {
    var c = parser.ParseArg(name);
    var def = __assign(__assign({}, ParseUtil_js_1.default.getFontDef(parser)), { accent: true, mathaccent: true });
    var entity = NodeUtil_js_1.default.createEntity(accent);
    var moNode = parser.create('token', 'mo', def, entity);
    var mml = moNode;
    NodeUtil_js_1.default.setAttribute(mml, 'stretchy', stretchy ? true : false);
    var mo = (NodeUtil_js_1.default.isEmbellished(c) ? NodeUtil_js_1.default.getCoreMO(c) : c);
    if (NodeUtil_js_1.default.isType(mo, 'mo') || NodeUtil_js_1.default.getProperty(mo, 'movablelimits')) {
        NodeUtil_js_1.default.setProperties(mo, { 'movablelimits': false });
    }
    var muoNode = parser.create('node', 'munderover');
    NodeUtil_js_1.default.setChild(muoNode, 0, c);
    NodeUtil_js_1.default.setChild(muoNode, 1, null);
    NodeUtil_js_1.default.setChild(muoNode, 2, mml);
    var texAtom = parser.create('node', 'TeXAtom', [muoNode]);
    parser.Push(texAtom);
};
BaseMethods.UnderOver = function (parser, name, c, stack) {
    var entity = NodeUtil_js_1.default.createEntity(c);
    var mo = parser.create('token', 'mo', { stretchy: true, accent: true }, entity);
    var pos = (name.charAt(1) === 'o' ? 'over' : 'under');
    var base = parser.ParseArg(name);
    parser.Push(ParseUtil_js_1.default.underOver(parser, base, mo, pos, stack));
};
BaseMethods.Overset = function (parser, name) {
    var top = parser.ParseArg(name);
    var base = parser.ParseArg(name);
    ParseUtil_js_1.default.checkMovableLimits(base);
    if (top.isKind('mo')) {
        NodeUtil_js_1.default.setAttribute(top, 'accent', false);
    }
    var node = parser.create('node', 'mover', [base, top]);
    parser.Push(node);
};
BaseMethods.Underset = function (parser, name) {
    var bot = parser.ParseArg(name);
    var base = parser.ParseArg(name);
    ParseUtil_js_1.default.checkMovableLimits(base);
    if (bot.isKind('mo')) {
        NodeUtil_js_1.default.setAttribute(bot, 'accent', false);
    }
    var node = parser.create('node', 'munder', [base, bot], { accentunder: false });
    parser.Push(node);
};
BaseMethods.Overunderset = function (parser, name) {
    var top = parser.ParseArg(name);
    var bot = parser.ParseArg(name);
    var base = parser.ParseArg(name);
    ParseUtil_js_1.default.checkMovableLimits(base);
    if (top.isKind('mo')) {
        NodeUtil_js_1.default.setAttribute(top, 'accent', false);
    }
    if (bot.isKind('mo')) {
        NodeUtil_js_1.default.setAttribute(bot, 'accent', false);
    }
    var node = parser.create('node', 'munderover', [base, bot, top], { accent: false, accentunder: false });
    parser.Push(node);
};
BaseMethods.TeXAtom = function (parser, name, mclass) {
    var def = { texClass: mclass };
    var mml;
    var node;
    var parsed;
    if (mclass === MmlNode_js_1.TEXCLASS.OP) {
        def['movesupsub'] = def['movablelimits'] = true;
        var arg = parser.GetArgument(name);
        var match = arg.match(/^\s*\\rm\s+([a-zA-Z0-9 ]+)$/);
        if (match) {
            def['mathvariant'] = TexConstants_js_1.TexConstant.Variant.NORMAL;
            node = parser.create('token', 'mi', def, match[1]);
        }
        else {
            parsed = new TexParser_js_1.default(arg, parser.stack.env, parser.configuration).mml();
            node = parser.create('node', 'TeXAtom', [parsed], def);
        }
        mml = parser.itemFactory.create('fn', node);
    }
    else {
        parsed = parser.ParseArg(name);
        mml = parser.create('node', 'TeXAtom', [parsed], def);
    }
    parser.Push(mml);
};
BaseMethods.MmlToken = function (parser, name) {
    var kind = parser.GetArgument(name);
    var attr = parser.GetBrackets(name, '').replace(/^\s+/, '');
    var text = parser.GetArgument(name);
    var def = {};
    var keep = [];
    var node;
    try {
        node = parser.create('node', kind);
    }
    catch (e) {
        node = null;
    }
    if (!node || !node.isToken) {
        throw new TexError_js_1.default('NotMathMLToken', '%1 is not a token element', kind);
    }
    while (attr !== '') {
        var match = attr.match(/^([a-z]+)\s*=\s*('[^']*'|"[^"]*"|[^ ,]*)\s*,?\s*/i);
        if (!match) {
            throw new TexError_js_1.default('InvalidMathMLAttr', 'Invalid MathML attribute: %1', attr);
        }
        if (!node.attributes.hasDefault(match[1]) && !MmlTokenAllow[match[1]]) {
            throw new TexError_js_1.default('UnknownAttrForElement', '%1 is not a recognized attribute for %2', match[1], kind);
        }
        var value = ParseUtil_js_1.default.MmlFilterAttribute(parser, match[1], match[2].replace(/^(['"])(.*)\1$/, '$2'));
        if (value) {
            if (value.toLowerCase() === 'true') {
                value = true;
            }
            else if (value.toLowerCase() === 'false') {
                value = false;
            }
            def[match[1]] = value;
            keep.push(match[1]);
        }
        attr = attr.substr(match[0].length);
    }
    if (keep.length) {
        def['mjx-keep-attrs'] = keep.join(' ');
    }
    var textNode = parser.create('text', text);
    node.appendChild(textNode);
    NodeUtil_js_1.default.setProperties(node, def);
    parser.Push(node);
};
BaseMethods.Strut = function (parser, _name) {
    var row = parser.create('node', 'mrow');
    var padded = parser.create('node', 'mpadded', [row], { height: '8.6pt', depth: '3pt', width: 0 });
    parser.Push(padded);
};
BaseMethods.Phantom = function (parser, name, v, h) {
    var box = parser.create('node', 'mphantom', [parser.ParseArg(name)]);
    if (v || h) {
        box = parser.create('node', 'mpadded', [box]);
        if (h) {
            NodeUtil_js_1.default.setAttribute(box, 'height', 0);
            NodeUtil_js_1.default.setAttribute(box, 'depth', 0);
        }
        if (v) {
            NodeUtil_js_1.default.setAttribute(box, 'width', 0);
        }
    }
    var atom = parser.create('node', 'TeXAtom', [box]);
    parser.Push(atom);
};
BaseMethods.Smash = function (parser, name) {
    var bt = ParseUtil_js_1.default.trimSpaces(parser.GetBrackets(name, ''));
    var smash = parser.create('node', 'mpadded', [parser.ParseArg(name)]);
    switch (bt) {
        case 'b':
            NodeUtil_js_1.default.setAttribute(smash, 'depth', 0);
            break;
        case 't':
            NodeUtil_js_1.default.setAttribute(smash, 'height', 0);
            break;
        default:
            NodeUtil_js_1.default.setAttribute(smash, 'height', 0);
            NodeUtil_js_1.default.setAttribute(smash, 'depth', 0);
    }
    var atom = parser.create('node', 'TeXAtom', [smash]);
    parser.Push(atom);
};
BaseMethods.Lap = function (parser, name) {
    var mml = parser.create('node', 'mpadded', [parser.ParseArg(name)], { width: 0 });
    if (name === '\\llap') {
        NodeUtil_js_1.default.setAttribute(mml, 'lspace', '-1width');
    }
    var atom = parser.create('node', 'TeXAtom', [mml]);
    parser.Push(atom);
};
BaseMethods.RaiseLower = function (parser, name) {
    var h = parser.GetDimen(name);
    var item = parser.itemFactory.create('position').setProperties({ name: parser.currentCS, move: 'vertical' });
    if (h.charAt(0) === '-') {
        h = h.slice(1);
        name = name.substr(1) === 'raise' ? '\\lower' : '\\raise';
    }
    if (name === '\\lower') {
        item.setProperty('dh', '-' + h);
        item.setProperty('dd', '+' + h);
    }
    else {
        item.setProperty('dh', '+' + h);
        item.setProperty('dd', '-' + h);
    }
    parser.Push(item);
};
BaseMethods.MoveLeftRight = function (parser, name) {
    var h = parser.GetDimen(name);
    var nh = (h.charAt(0) === '-' ? h.slice(1) : '-' + h);
    if (name === '\\moveleft') {
        var tmp = h;
        h = nh;
        nh = tmp;
    }
    parser.Push(parser.itemFactory.create('position').setProperties({
        name: parser.currentCS, move: 'horizontal',
        left: parser.create('node', 'mspace', [], { width: h }),
        right: parser.create('node', 'mspace', [], { width: nh })
    }));
};
BaseMethods.Hskip = function (parser, name) {
    var node = parser.create('node', 'mspace', [], { width: parser.GetDimen(name) });
    parser.Push(node);
};
BaseMethods.Nonscript = function (parser, _name) {
    parser.Push(parser.itemFactory.create('nonscript'));
};
BaseMethods.Rule = function (parser, name, style) {
    var w = parser.GetDimen(name), h = parser.GetDimen(name), d = parser.GetDimen(name);
    var def = { width: w, height: h, depth: d };
    if (style !== 'blank') {
        def['mathbackground'] = (parser.stack.env['color'] || 'black');
    }
    var node = parser.create('node', 'mspace', [], def);
    parser.Push(node);
};
BaseMethods.rule = function (parser, name) {
    var v = parser.GetBrackets(name), w = parser.GetDimen(name), h = parser.GetDimen(name);
    var mml = parser.create('node', 'mspace', [], {
        width: w, height: h,
        mathbackground: (parser.stack.env['color'] || 'black')
    });
    if (v) {
        mml = parser.create('node', 'mpadded', [mml], { voffset: v });
        if (v.match(/^\-/)) {
            NodeUtil_js_1.default.setAttribute(mml, 'height', v);
            NodeUtil_js_1.default.setAttribute(mml, 'depth', '+' + v.substr(1));
        }
        else {
            NodeUtil_js_1.default.setAttribute(mml, 'height', '+' + v);
        }
    }
    parser.Push(mml);
};
BaseMethods.MakeBig = function (parser, name, mclass, size) {
    size *= P_HEIGHT;
    var sizeStr = String(size).replace(/(\.\d\d\d).+/, '$1') + 'em';
    var delim = parser.GetDelimiter(name, true);
    var mo = parser.create('token', 'mo', {
        minsize: sizeStr, maxsize: sizeStr,
        fence: true, stretchy: true, symmetric: true
    }, delim);
    var node = parser.create('node', 'TeXAtom', [mo], { texClass: mclass });
    parser.Push(node);
};
BaseMethods.BuildRel = function (parser, name) {
    var top = parser.ParseUpTo(name, '\\over');
    var bot = parser.ParseArg(name);
    var node = parser.create('node', 'munderover');
    NodeUtil_js_1.default.setChild(node, 0, bot);
    NodeUtil_js_1.default.setChild(node, 1, null);
    NodeUtil_js_1.default.setChild(node, 2, top);
    var atom = parser.create('node', 'TeXAtom', [node], { texClass: MmlNode_js_1.TEXCLASS.REL });
    parser.Push(atom);
};
BaseMethods.HBox = function (parser, name, style, font) {
    parser.PushAll(ParseUtil_js_1.default.internalMath(parser, parser.GetArgument(name), style, font));
};
BaseMethods.FBox = function (parser, name) {
    var internal = ParseUtil_js_1.default.internalMath(parser, parser.GetArgument(name));
    var node = parser.create('node', 'menclose', internal, { notation: 'box' });
    parser.Push(node);
};
BaseMethods.FrameBox = function (parser, name) {
    var width = parser.GetBrackets(name);
    var pos = parser.GetBrackets(name) || 'c';
    var mml = ParseUtil_js_1.default.internalMath(parser, parser.GetArgument(name));
    if (width) {
        mml = [parser.create('node', 'mpadded', mml, {
                width: width,
                'data-align': (0, Options_js_1.lookup)(pos, { l: 'left', r: 'right' }, 'center')
            })];
    }
    var node = parser.create('node', 'TeXAtom', [parser.create('node', 'menclose', mml, { notation: 'box' })], { texClass: MmlNode_js_1.TEXCLASS.ORD });
    parser.Push(node);
};
BaseMethods.Not = function (parser, _name) {
    parser.Push(parser.itemFactory.create('not'));
};
BaseMethods.Dots = function (parser, _name) {
    var ldotsEntity = NodeUtil_js_1.default.createEntity('2026');
    var cdotsEntity = NodeUtil_js_1.default.createEntity('22EF');
    var ldots = parser.create('token', 'mo', { stretchy: false }, ldotsEntity);
    var cdots = parser.create('token', 'mo', { stretchy: false }, cdotsEntity);
    parser.Push(parser.itemFactory.create('dots').setProperties({
        ldots: ldots,
        cdots: cdots
    }));
};
BaseMethods.Matrix = function (parser, _name, open, close, align, spacing, vspacing, style, cases, numbered) {
    var c = parser.GetNext();
    if (c === '') {
        throw new TexError_js_1.default('MissingArgFor', 'Missing argument for %1', parser.currentCS);
    }
    if (c === '{') {
        parser.i++;
    }
    else {
        parser.string = c + '}' + parser.string.slice(parser.i + 1);
        parser.i = 0;
    }
    var array = parser.itemFactory.create('array').setProperty('requireClose', true);
    array.arraydef = {
        rowspacing: (vspacing || '4pt'),
        columnspacing: (spacing || '1em')
    };
    if (cases) {
        array.setProperty('isCases', true);
    }
    if (numbered) {
        array.setProperty('isNumbered', true);
        array.arraydef.side = numbered;
    }
    if (open || close) {
        array.setProperty('open', open);
        array.setProperty('close', close);
    }
    if (style === 'D') {
        array.arraydef.displaystyle = true;
    }
    if (align != null) {
        array.arraydef.columnalign = align;
    }
    parser.Push(array);
};
BaseMethods.Entry = function (parser, name) {
    parser.Push(parser.itemFactory.create('cell').setProperties({ isEntry: true, name: name }));
    var top = parser.stack.Top();
    var env = top.getProperty('casesEnv');
    var cases = top.getProperty('isCases');
    if (!cases && !env)
        return;
    var str = parser.string;
    var braces = 0, close = -1, i = parser.i, m = str.length;
    var end = (env ? new RegExp("^\\\\end\\s*\\{".concat(env.replace(/\*/, '\\*'), "\\}")) : null);
    while (i < m) {
        var c = str.charAt(i);
        if (c === '{') {
            braces++;
            i++;
        }
        else if (c === '}') {
            if (braces === 0) {
                m = 0;
            }
            else {
                braces--;
                if (braces === 0 && close < 0) {
                    close = i - parser.i;
                }
                i++;
            }
        }
        else if (c === '&' && braces === 0) {
            throw new TexError_js_1.default('ExtraAlignTab', 'Extra alignment tab in \\cases text');
        }
        else if (c === '\\') {
            var rest = str.substr(i);
            if (rest.match(/^((\\cr)[^a-zA-Z]|\\\\)/) || (end && rest.match(end))) {
                m = 0;
            }
            else {
                i += 2;
            }
        }
        else {
            i++;
        }
    }
    var text = str.substr(parser.i, i - parser.i);
    if (!text.match(/^\s*\\text[^a-zA-Z]/) || close !== text.replace(/\s+$/, '').length - 1) {
        var internal = ParseUtil_js_1.default.internalMath(parser, ParseUtil_js_1.default.trimSpaces(text), 0);
        parser.PushAll(internal);
        parser.i = i;
    }
};
BaseMethods.Cr = function (parser, name) {
    parser.Push(parser.itemFactory.create('cell').setProperties({ isCR: true, name: name }));
};
BaseMethods.CrLaTeX = function (parser, name, nobrackets) {
    if (nobrackets === void 0) { nobrackets = false; }
    var n;
    if (!nobrackets) {
        if (parser.string.charAt(parser.i) === '*') {
            parser.i++;
        }
        if (parser.string.charAt(parser.i) === '[') {
            var dim = parser.GetBrackets(name, '');
            var _a = __read(ParseUtil_js_1.default.matchDimen(dim), 2), value = _a[0], unit = _a[1];
            if (dim && !value) {
                throw new TexError_js_1.default('BracketMustBeDimension', 'Bracket argument to %1 must be a dimension', parser.currentCS);
            }
            n = value + unit;
        }
    }
    parser.Push(parser.itemFactory.create('cell').setProperties({ isCR: true, name: name, linebreak: true }));
    var top = parser.stack.Top();
    var node;
    if (top instanceof sitem.ArrayItem) {
        if (n) {
            top.addRowSpacing(n);
        }
    }
    else {
        if (n) {
            node = parser.create('node', 'mspace', [], { depth: n });
            parser.Push(node);
        }
        node = parser.create('node', 'mspace', [], { linebreak: TexConstants_js_1.TexConstant.LineBreak.NEWLINE });
        parser.Push(node);
    }
};
BaseMethods.HLine = function (parser, _name, style) {
    if (style == null) {
        style = 'solid';
    }
    var top = parser.stack.Top();
    if (!(top instanceof sitem.ArrayItem) || top.Size()) {
        throw new TexError_js_1.default('Misplaced', 'Misplaced %1', parser.currentCS);
    }
    if (!top.table.length) {
        top.frame.push('top');
    }
    else {
        var lines = (top.arraydef['rowlines'] ? top.arraydef['rowlines'].split(/ /) : []);
        while (lines.length < top.table.length) {
            lines.push('none');
        }
        lines[top.table.length - 1] = style;
        top.arraydef['rowlines'] = lines.join(' ');
    }
};
BaseMethods.HFill = function (parser, _name) {
    var top = parser.stack.Top();
    if (top instanceof sitem.ArrayItem) {
        top.hfill.push(top.Size());
    }
    else {
        throw new TexError_js_1.default('UnsupportedHFill', 'Unsupported use of %1', parser.currentCS);
    }
};
BaseMethods.BeginEnd = function (parser, name) {
    var env = parser.GetArgument(name);
    if (env.match(/\\/i)) {
        throw new TexError_js_1.default('InvalidEnv', 'Invalid environment name \'%1\'', env);
    }
    var macro = parser.configuration.handlers.get('environment').lookup(env);
    if (macro && name === '\\end') {
        if (!macro.args[0]) {
            var mml = parser.itemFactory.create('end').setProperty('name', env);
            parser.Push(mml);
            return;
        }
        parser.stack.env['closing'] = env;
    }
    ParseUtil_js_1.default.checkMaxMacros(parser, false);
    parser.parse('environment', [parser, env]);
};
BaseMethods.Array = function (parser, begin, open, close, align, spacing, vspacing, style, raggedHeight) {
    if (!align) {
        align = parser.GetArgument('\\begin{' + begin.getName() + '}');
    }
    var lines = ('c' + align).replace(/[^clr|:]/g, '').replace(/[^|:]([|:])+/g, '$1');
    align = align.replace(/[^clr]/g, '').split('').join(' ');
    align = align.replace(/l/g, 'left').replace(/r/g, 'right').replace(/c/g, 'center');
    var array = parser.itemFactory.create('array');
    array.arraydef = {
        columnalign: align,
        columnspacing: (spacing || '1em'),
        rowspacing: (vspacing || '4pt')
    };
    if (lines.match(/[|:]/)) {
        if (lines.charAt(0).match(/[|:]/)) {
            array.frame.push('left');
            array.dashed = lines.charAt(0) === ':';
        }
        if (lines.charAt(lines.length - 1).match(/[|:]/)) {
            array.frame.push('right');
        }
        lines = lines.substr(1, lines.length - 2);
        array.arraydef.columnlines =
            lines.split('').join(' ').replace(/[^|: ]/g, 'none').replace(/\|/g, 'solid').replace(/:/g, 'dashed');
    }
    if (open) {
        array.setProperty('open', parser.convertDelimiter(open));
    }
    if (close) {
        array.setProperty('close', parser.convertDelimiter(close));
    }
    if ((style || '').charAt(1) === '\'') {
        array.arraydef['data-cramped'] = true;
        style = style.charAt(0);
    }
    if (style === 'D') {
        array.arraydef['displaystyle'] = true;
    }
    else if (style) {
        array.arraydef['displaystyle'] = false;
    }
    if (style === 'S') {
        array.arraydef['scriptlevel'] = 1;
    }
    if (raggedHeight) {
        array.arraydef['useHeight'] = false;
    }
    parser.Push(begin);
    return array;
};
BaseMethods.AlignedArray = function (parser, begin) {
    var align = parser.GetBrackets('\\begin{' + begin.getName() + '}');
    var item = BaseMethods.Array(parser, begin);
    return ParseUtil_js_1.default.setArrayAlign(item, align);
};
BaseMethods.Equation = function (parser, begin, numbered) {
    parser.Push(begin);
    ParseUtil_js_1.default.checkEqnEnv(parser);
    return parser.itemFactory.create('equation', numbered).
        setProperty('name', begin.getName());
};
BaseMethods.EqnArray = function (parser, begin, numbered, taggable, align, spacing) {
    parser.Push(begin);
    if (taggable) {
        ParseUtil_js_1.default.checkEqnEnv(parser);
    }
    align = align.replace(/[^clr]/g, '').split('').join(' ');
    align = align.replace(/l/g, 'left').replace(/r/g, 'right').replace(/c/g, 'center');
    var newItem = parser.itemFactory.create('eqnarray', begin.getName(), numbered, taggable, parser.stack.global);
    newItem.arraydef = {
        displaystyle: true,
        columnalign: align,
        columnspacing: (spacing || '1em'),
        rowspacing: '3pt',
        side: parser.options['tagSide'],
        minlabelspacing: parser.options['tagIndent']
    };
    return newItem;
};
BaseMethods.HandleNoTag = function (parser, _name) {
    parser.tags.notag();
};
BaseMethods.HandleLabel = function (parser, name) {
    var label = parser.GetArgument(name);
    if (label === '') {
        return;
    }
    if (!parser.tags.refUpdate) {
        if (parser.tags.label) {
            throw new TexError_js_1.default('MultipleCommand', 'Multiple %1', parser.currentCS);
        }
        parser.tags.label = label;
        if ((parser.tags.allLabels[label] || parser.tags.labels[label]) && !parser.options['ignoreDuplicateLabels']) {
            throw new TexError_js_1.default('MultipleLabel', 'Label \'%1\' multiply defined', label);
        }
        parser.tags.labels[label] = new Tags_js_1.Label();
    }
};
BaseMethods.HandleRef = function (parser, name, eqref) {
    var label = parser.GetArgument(name);
    var ref = parser.tags.allLabels[label] || parser.tags.labels[label];
    if (!ref) {
        if (!parser.tags.refUpdate) {
            parser.tags.redo = true;
        }
        ref = new Tags_js_1.Label();
    }
    var tag = ref.tag;
    if (eqref) {
        tag = parser.tags.formatTag(tag);
    }
    var node = parser.create('node', 'mrow', ParseUtil_js_1.default.internalMath(parser, tag), {
        href: parser.tags.formatUrl(ref.id, parser.options.baseURL), 'class': 'MathJax_ref'
    });
    parser.Push(node);
};
BaseMethods.Macro = function (parser, name, macro, argcount, def) {
    if (argcount) {
        var args = [];
        if (def != null) {
            var optional = parser.GetBrackets(name);
            args.push(optional == null ? def : optional);
        }
        for (var i = args.length; i < argcount; i++) {
            args.push(parser.GetArgument(name));
        }
        macro = ParseUtil_js_1.default.substituteArgs(parser, args, macro);
    }
    parser.string = ParseUtil_js_1.default.addArgs(parser, macro, parser.string.slice(parser.i));
    parser.i = 0;
    ParseUtil_js_1.default.checkMaxMacros(parser);
};
BaseMethods.MathChoice = function (parser, name) {
    var D = parser.ParseArg(name);
    var T = parser.ParseArg(name);
    var S = parser.ParseArg(name);
    var SS = parser.ParseArg(name);
    parser.Push(parser.create('node', 'MathChoice', [D, T, S, SS]));
};
exports["default"] = BaseMethods;
//# sourceMappingURL=BaseMethods.js.map

/***/ }),

/***/ "./node_modules/mathjax-full/js/util/lengths.js":
/*!******************************************************!*\
  !*** ./node_modules/mathjax-full/js/util/lengths.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, exports) => {


Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.px = exports.emRounded = exports.em = exports.percent = exports.length2em = exports.MATHSPACE = exports.RELUNITS = exports.UNITS = exports.BIGDIMEN = void 0;
exports.BIGDIMEN = 1000000;
exports.UNITS = {
    px: 1,
    'in': 96,
    cm: 96 / 2.54,
    mm: 96 / 25.4
};
exports.RELUNITS = {
    em: 1,
    ex: .431,
    pt: 1 / 10,
    pc: 12 / 10,
    mu: 1 / 18
};
exports.MATHSPACE = {
    veryverythinmathspace: 1 / 18,
    verythinmathspace: 2 / 18,
    thinmathspace: 3 / 18,
    mediummathspace: 4 / 18,
    thickmathspace: 5 / 18,
    verythickmathspace: 6 / 18,
    veryverythickmathspace: 7 / 18,
    negativeveryverythinmathspace: -1 / 18,
    negativeverythinmathspace: -2 / 18,
    negativethinmathspace: -3 / 18,
    negativemediummathspace: -4 / 18,
    negativethickmathspace: -5 / 18,
    negativeverythickmathspace: -6 / 18,
    negativeveryverythickmathspace: -7 / 18,
    thin: .04,
    medium: .06,
    thick: .1,
    normal: 1,
    big: 2,
    small: 1 / Math.sqrt(2),
    infinity: exports.BIGDIMEN
};
function length2em(length, size, scale, em) {
    if (size === void 0) { size = 0; }
    if (scale === void 0) { scale = 1; }
    if (em === void 0) { em = 16; }
    if (typeof length !== 'string') {
        length = String(length);
    }
    if (length === '' || length == null) {
        return size;
    }
    if (exports.MATHSPACE[length]) {
        return exports.MATHSPACE[length];
    }
    var match = length.match(/^\s*([-+]?(?:\.\d+|\d+(?:\.\d*)?))?(pt|em|ex|mu|px|pc|in|mm|cm|%)?/);
    if (!match) {
        return size;
    }
    var m = parseFloat(match[1] || '1'), unit = match[2];
    if (exports.UNITS.hasOwnProperty(unit)) {
        return m * exports.UNITS[unit] / em / scale;
    }
    if (exports.RELUNITS.hasOwnProperty(unit)) {
        return m * exports.RELUNITS[unit];
    }
    if (unit === '%') {
        return m / 100 * size;
    }
    return m * size;
}
exports.length2em = length2em;
function percent(m) {
    return (100 * m).toFixed(1).replace(/\.?0+$/, '') + '%';
}
exports.percent = percent;
function em(m) {
    if (Math.abs(m) < .001)
        return '0';
    return (m.toFixed(3).replace(/\.?0+$/, '')) + 'em';
}
exports.em = em;
function emRounded(m, em) {
    if (em === void 0) { em = 16; }
    m = (Math.round(m * em) + .05) / em;
    if (Math.abs(m) < .001)
        return '0em';
    return m.toFixed(3).replace(/\.?0+$/, '') + 'em';
}
exports.emRounded = emRounded;
function px(m, M, em) {
    if (M === void 0) { M = -exports.BIGDIMEN; }
    if (em === void 0) { em = 16; }
    m *= em;
    if (M && m < M)
        m = M;
    if (Math.abs(m) < .1)
        return '0';
    return m.toFixed(1).replace(/\.0$/, '') + 'px';
}
exports.px = px;
//# sourceMappingURL=lengths.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfbWF0aGpheC1mdWxsX2pzX2lucHV0X3RleF9QYXJzZU9wdGlvbnNfanMtbm9kZV9tb2R1bGVzX21hdGhqYXgtZnVsbF9qc19pLTBjNWQ5Mi42MjM3MzYzNDNmYzc1Y2E0MDkxOC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsT0FBTztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLFVBQVU7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsdUJBQXVCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUJBQXVCO0FBQ3ZCOzs7Ozs7Ozs7O0FDbkdhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxPQUFPO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsbUJBQW1CO0FBQ25CLG9DQUFvQyxtQkFBTyxDQUFDLDJFQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QiwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRDtBQUMxRCxnRUFBZ0UsMkJBQTJCO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsbUJBQW1CO0FBQ25COzs7Ozs7Ozs7O0FDbkdhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxPQUFPO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsb0NBQW9DLG1CQUFPLENBQUMsMkVBQWU7QUFDM0Qsd0JBQXdCLG1CQUFPLENBQUMsbUZBQW1CO0FBQ25ELHFDQUFxQyxtQkFBTyxDQUFDLDZFQUFnQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFFQUFxRTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLCtCQUErQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUscUJBQXFCO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxvQ0FBb0M7QUFDckMsa0JBQWU7QUFDZjs7Ozs7Ozs7OztBQzdHYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLE1BQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsT0FBTztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELDRDQUE0QyxtQkFBTyxDQUFDLDJGQUF1QjtBQUMzRSx1QkFBdUIsbUJBQU8sQ0FBQyxpRkFBa0I7QUFDakQsb0NBQW9DLG1CQUFPLENBQUMsMkVBQWU7QUFDM0QsbUJBQW1CLG1CQUFPLENBQUMsNkVBQXVCO0FBQ2xEO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLGdCQUFnQjtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsUUFBUTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLGlCQUFpQjtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixRQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxrQkFBZTtBQUNmOzs7Ozs7Ozs7O0FDbEphO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxPQUFPO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsZ0JBQWdCLEdBQUcsZ0JBQWdCO0FBQ25DLG9DQUFvQyxtQkFBTyxDQUFDLDJFQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQSxzRkFBc0Y7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSxVQUFVO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFFBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELElBQUksZUFBZSxHQUFHO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCO0FBQ2hCOzs7Ozs7Ozs7O0FDdlFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QscUJBQXFCLG1CQUFPLENBQUMsNkVBQWdCO0FBQzdDLG1CQUFtQixtQkFBTyxDQUFDLHVGQUE0QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsa0JBQWU7QUFDZjs7Ozs7Ozs7OztBQ3pDYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0NBQXdDLG1CQUFtQixLQUFLO0FBQ2pFOzs7Ozs7Ozs7O0FDcElhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9DQUFvQztBQUNuRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQ0FBMEMsNEJBQTRCO0FBQ3RFLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QseUJBQXlCLEdBQUcsZ0JBQWdCLEdBQUcsYUFBYTtBQUM1RCx5QkFBeUIsbUJBQU8sQ0FBQyxzRkFBcUI7QUFDdEQsc0JBQXNCLG1CQUFPLENBQUMsZ0ZBQWtCO0FBQ2hELG9DQUFvQyxtQkFBTyxDQUFDLDRFQUFnQjtBQUM1RCxvQ0FBb0MsbUJBQU8sQ0FBQyw0RUFBZ0I7QUFDNUQscUJBQXFCLG1CQUFPLENBQUMsOEVBQWlCO0FBQzlDLHlCQUF5QixtQkFBTyxDQUFDLGtGQUFnQjtBQUNqRCxnQkFBZ0IsbUJBQU8sQ0FBQyxvRUFBWTtBQUNwQyxtQkFBTyxDQUFDLHdGQUFtQjtBQUMzQiw4QkFBOEIsbUJBQU8sQ0FBQyxzSEFBNkM7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsVUFBVSx3Q0FBd0M7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSxVQUFVO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGdCQUFnQjtBQUNoQix5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7O0FDbExhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsTUFBTTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxPQUFPO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsb0JBQW9CLEdBQUcsb0JBQW9CLEdBQUcsaUJBQWlCLEdBQUcsZ0JBQWdCLEdBQUcscUJBQXFCLEdBQUcsZUFBZSxHQUFHLGNBQWMsR0FBRyxlQUFlLEdBQUcsZ0JBQWdCLEdBQUcsb0JBQW9CLEdBQUcsaUJBQWlCLEdBQUcsZUFBZSxHQUFHLGlCQUFpQixHQUFHLGlCQUFpQixHQUFHLGNBQWMsR0FBRyxnQkFBZ0IsR0FBRyxnQkFBZ0IsR0FBRyxrQkFBa0IsR0FBRyxpQkFBaUIsR0FBRyxpQkFBaUIsR0FBRyxnQkFBZ0IsR0FBRyxnQkFBZ0IsR0FBRyxpQkFBaUI7QUFDcmMsc0JBQXNCLG1CQUFPLENBQUMsZ0ZBQWtCO0FBQ2hELG9CQUFvQixtQkFBTyxDQUFDLGtGQUEyQjtBQUN2RCxtQkFBbUIsbUJBQU8sQ0FBQyxnR0FBa0M7QUFDN0Qsb0NBQW9DLG1CQUFPLENBQUMsNEVBQWdCO0FBQzVELHFDQUFxQyxtQkFBTyxDQUFDLDhFQUFpQjtBQUM5RCxvQ0FBb0MsbUJBQU8sQ0FBQyw0RUFBZ0I7QUFDNUQscUJBQXFCLG1CQUFPLENBQUMsOEVBQWlCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0EsQ0FBQztBQUNELGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELHVDQUF1QyxvR0FBb0csc0NBQXNDO0FBQzVPO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLElBQUksaUJBQWlCLEdBQUc7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RUFBNEUsR0FBRztBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNELGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0U7QUFDbEU7QUFDQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxzQ0FBc0M7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJEO0FBQzNELHVFQUF1RSxVQUFVO0FBQ2pGLDZEQUE2RCxxQ0FBcUM7QUFDbEc7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELGdDQUFnQztBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsdUJBQXVCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEMsb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLFNBQVMsR0FBRyxVQUFVLElBQUk7QUFDN0QsbUNBQW1DLFNBQVMsR0FBRyxVQUFVLElBQUk7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLEtBQUs7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsZ0JBQWdCLEdBQUcsRUFBRTtBQUNsRDtBQUNBO0FBQ0EscUNBQXFDLEVBQUU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0Esd0JBQXdCO0FBQ3hCLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViIsInNvdXJjZXMiOlsid2VicGFjazovL0BqdXB5dGVybGFiL2FwcGxpY2F0aW9uLXRvcC8uL25vZGVfbW9kdWxlcy9tYXRoamF4LWZ1bGwvanMvY29yZS9UcmVlL0ZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL21hdGhqYXgtZnVsbC9qcy9pbnB1dC90ZXgvTm9kZUZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL21hdGhqYXgtZnVsbC9qcy9pbnB1dC90ZXgvUGFyc2VNZXRob2RzLmpzIiwid2VicGFjazovL0BqdXB5dGVybGFiL2FwcGxpY2F0aW9uLXRvcC8uL25vZGVfbW9kdWxlcy9tYXRoamF4LWZ1bGwvanMvaW5wdXQvdGV4L1BhcnNlT3B0aW9ucy5qcyIsIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi9ub2RlX21vZHVsZXMvbWF0aGpheC1mdWxsL2pzL2lucHV0L3RleC9TdGFja0l0ZW0uanMiLCJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL21hdGhqYXgtZnVsbC9qcy9pbnB1dC90ZXgvU3RhY2tJdGVtRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi9ub2RlX21vZHVsZXMvbWF0aGpheC1mdWxsL2pzL2lucHV0L3RleC9UZXhDb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL21hdGhqYXgtZnVsbC9qcy9pbnB1dC90ZXgvYmFzZS9CYXNlQ29uZmlndXJhdGlvbi5qcyIsIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi9ub2RlX21vZHVsZXMvbWF0aGpheC1mdWxsL2pzL2lucHV0L3RleC9iYXNlL0Jhc2VJdGVtcy5qcyIsIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi9ub2RlX21vZHVsZXMvbWF0aGpheC1mdWxsL2pzL2lucHV0L3RleC9iYXNlL0Jhc2VNYXBwaW5ncy5qcyIsIndlYnBhY2s6Ly9AanVweXRlcmxhYi9hcHBsaWNhdGlvbi10b3AvLi9ub2RlX21vZHVsZXMvbWF0aGpheC1mdWxsL2pzL2lucHV0L3RleC9iYXNlL0Jhc2VNZXRob2RzLmpzIiwid2VicGFjazovL0BqdXB5dGVybGFiL2FwcGxpY2F0aW9uLXRvcC8uL25vZGVfbW9kdWxlcy9tYXRoamF4LWZ1bGwvanMvdXRpbC9sZW5ndGhzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fdmFsdWVzID0gKHRoaXMgJiYgdGhpcy5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykge1xuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG59O1xudmFyIF9fcmVhZCA9ICh0aGlzICYmIHRoaXMuX19yZWFkKSB8fCBmdW5jdGlvbiAobywgbikge1xuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcbiAgICBpZiAoIW0pIHJldHVybiBvO1xuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xuICAgIHRyeSB7XG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cbiAgICBmaW5hbGx5IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxuICAgIH1cbiAgICByZXR1cm4gYXI7XG59O1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5BYnN0cmFjdEZhY3RvcnkgPSB2b2lkIDA7XG52YXIgQWJzdHJhY3RGYWN0b3J5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBYnN0cmFjdEZhY3Rvcnkobm9kZXMpIHtcbiAgICAgICAgdmFyIGVfMSwgX2E7XG4gICAgICAgIGlmIChub2RlcyA9PT0gdm9pZCAwKSB7IG5vZGVzID0gbnVsbDsgfVxuICAgICAgICB0aGlzLmRlZmF1bHRLaW5kID0gJ3Vua25vd24nO1xuICAgICAgICB0aGlzLm5vZGVNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMubm9kZSA9IHt9O1xuICAgICAgICBpZiAobm9kZXMgPT09IG51bGwpIHtcbiAgICAgICAgICAgIG5vZGVzID0gdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0Tm9kZXM7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXMoT2JqZWN0LmtleXMobm9kZXMpKSwgX2MgPSBfYi5uZXh0KCk7ICFfYy5kb25lOyBfYyA9IF9iLm5leHQoKSkge1xuICAgICAgICAgICAgICAgIHZhciBraW5kID0gX2MudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXROb2RlQ2xhc3Moa2luZCwgbm9kZXNba2luZF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgQWJzdHJhY3RGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoa2luZCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRoaXMubm9kZVtraW5kXSB8fCB0aGlzLm5vZGVbdGhpcy5kZWZhdWx0S2luZF0pLmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGFyZ3MpLCBmYWxzZSkpO1xuICAgIH07XG4gICAgQWJzdHJhY3RGYWN0b3J5LnByb3RvdHlwZS5zZXROb2RlQ2xhc3MgPSBmdW5jdGlvbiAoa2luZCwgbm9kZUNsYXNzKSB7XG4gICAgICAgIHRoaXMubm9kZU1hcC5zZXQoa2luZCwgbm9kZUNsYXNzKTtcbiAgICAgICAgdmFyIFRISVMgPSB0aGlzO1xuICAgICAgICB2YXIgS0lORCA9IHRoaXMubm9kZU1hcC5nZXQoa2luZCk7XG4gICAgICAgIHRoaXMubm9kZVtraW5kXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgKEtJTkQuYmluZC5hcHBseShLSU5ELCBfX3NwcmVhZEFycmF5KFt2b2lkIDAsIFRISVNdLCBfX3JlYWQoYXJncyksIGZhbHNlKSkpKCk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBYnN0cmFjdEZhY3RvcnkucHJvdG90eXBlLmdldE5vZGVDbGFzcyA9IGZ1bmN0aW9uIChraW5kKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVNYXAuZ2V0KGtpbmQpO1xuICAgIH07XG4gICAgQWJzdHJhY3RGYWN0b3J5LnByb3RvdHlwZS5kZWxldGVOb2RlQ2xhc3MgPSBmdW5jdGlvbiAoa2luZCkge1xuICAgICAgICB0aGlzLm5vZGVNYXAuZGVsZXRlKGtpbmQpO1xuICAgICAgICBkZWxldGUgdGhpcy5ub2RlW2tpbmRdO1xuICAgIH07XG4gICAgQWJzdHJhY3RGYWN0b3J5LnByb3RvdHlwZS5ub2RlSXNLaW5kID0gZnVuY3Rpb24gKG5vZGUsIGtpbmQpIHtcbiAgICAgICAgcmV0dXJuIChub2RlIGluc3RhbmNlb2YgdGhpcy5nZXROb2RlQ2xhc3Moa2luZCkpO1xuICAgIH07XG4gICAgQWJzdHJhY3RGYWN0b3J5LnByb3RvdHlwZS5nZXRLaW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5ub2RlTWFwLmtleXMoKSk7XG4gICAgfTtcbiAgICBBYnN0cmFjdEZhY3RvcnkuZGVmYXVsdE5vZGVzID0ge307XG4gICAgcmV0dXJuIEFic3RyYWN0RmFjdG9yeTtcbn0oKSk7XG5leHBvcnRzLkFic3RyYWN0RmFjdG9yeSA9IEFic3RyYWN0RmFjdG9yeTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUZhY3RvcnkuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19yZWFkID0gKHRoaXMgJiYgdGhpcy5fX3JlYWQpIHx8IGZ1bmN0aW9uIChvLCBuKSB7XG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICAgIGlmICghbSkgcmV0dXJuIG87XG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XG4gICAgdHJ5IHtcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XG4gICAgfVxuICAgIHJldHVybiBhcjtcbn07XG52YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLk5vZGVGYWN0b3J5ID0gdm9pZCAwO1xudmFyIE5vZGVVdGlsX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vTm9kZVV0aWwuanNcIikpO1xudmFyIE5vZGVGYWN0b3J5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOb2RlRmFjdG9yeSgpIHtcbiAgICAgICAgdGhpcy5tbWxGYWN0b3J5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5mYWN0b3J5ID0geyAnbm9kZSc6IE5vZGVGYWN0b3J5LmNyZWF0ZU5vZGUsXG4gICAgICAgICAgICAndG9rZW4nOiBOb2RlRmFjdG9yeS5jcmVhdGVUb2tlbixcbiAgICAgICAgICAgICd0ZXh0JzogTm9kZUZhY3RvcnkuY3JlYXRlVGV4dCxcbiAgICAgICAgICAgICdlcnJvcic6IE5vZGVGYWN0b3J5LmNyZWF0ZUVycm9yXG4gICAgICAgIH07XG4gICAgfVxuICAgIE5vZGVGYWN0b3J5LmNyZWF0ZU5vZGUgPSBmdW5jdGlvbiAoZmFjdG9yeSwga2luZCwgY2hpbGRyZW4sIGRlZiwgdGV4dCkge1xuICAgICAgICBpZiAoY2hpbGRyZW4gPT09IHZvaWQgMCkgeyBjaGlsZHJlbiA9IFtdOyB9XG4gICAgICAgIGlmIChkZWYgPT09IHZvaWQgMCkgeyBkZWYgPSB7fTsgfVxuICAgICAgICB2YXIgbm9kZSA9IGZhY3RvcnkubW1sRmFjdG9yeS5jcmVhdGUoa2luZCk7XG4gICAgICAgIG5vZGUuc2V0Q2hpbGRyZW4oY2hpbGRyZW4pO1xuICAgICAgICBpZiAodGV4dCkge1xuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0UHJvcGVydGllcyhub2RlLCBkZWYpO1xuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICAgIE5vZGVGYWN0b3J5LmNyZWF0ZVRva2VuID0gZnVuY3Rpb24gKGZhY3RvcnksIGtpbmQsIGRlZiwgdGV4dCkge1xuICAgICAgICBpZiAoZGVmID09PSB2b2lkIDApIHsgZGVmID0ge307IH1cbiAgICAgICAgaWYgKHRleHQgPT09IHZvaWQgMCkgeyB0ZXh0ID0gJyc7IH1cbiAgICAgICAgdmFyIHRleHROb2RlID0gZmFjdG9yeS5jcmVhdGUoJ3RleHQnLCB0ZXh0KTtcbiAgICAgICAgcmV0dXJuIGZhY3RvcnkuY3JlYXRlKCdub2RlJywga2luZCwgW10sIGRlZiwgdGV4dE5vZGUpO1xuICAgIH07XG4gICAgTm9kZUZhY3RvcnkuY3JlYXRlVGV4dCA9IGZ1bmN0aW9uIChmYWN0b3J5LCB0ZXh0KSB7XG4gICAgICAgIGlmICh0ZXh0ID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWN0b3J5Lm1tbEZhY3RvcnkuY3JlYXRlKCd0ZXh0Jykuc2V0VGV4dCh0ZXh0KTtcbiAgICB9O1xuICAgIE5vZGVGYWN0b3J5LmNyZWF0ZUVycm9yID0gZnVuY3Rpb24gKGZhY3RvcnksIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIHRleHQgPSBmYWN0b3J5LmNyZWF0ZSgndGV4dCcsIG1lc3NhZ2UpO1xuICAgICAgICB2YXIgbXRleHQgPSBmYWN0b3J5LmNyZWF0ZSgnbm9kZScsICdtdGV4dCcsIFtdLCB7fSwgdGV4dCk7XG4gICAgICAgIHZhciBlcnJvciA9IGZhY3RvcnkuY3JlYXRlKCdub2RlJywgJ21lcnJvcicsIFttdGV4dF0sIHsgJ2RhdGEtbWp4LWVycm9yJzogbWVzc2FnZSB9KTtcbiAgICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH07XG4gICAgTm9kZUZhY3RvcnkucHJvdG90eXBlLnNldE1tbEZhY3RvcnkgPSBmdW5jdGlvbiAobW1sRmFjdG9yeSkge1xuICAgICAgICB0aGlzLm1tbEZhY3RvcnkgPSBtbWxGYWN0b3J5O1xuICAgIH07XG4gICAgTm9kZUZhY3RvcnkucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChraW5kLCBmdW5jKSB7XG4gICAgICAgIHRoaXMuZmFjdG9yeVtraW5kXSA9IGZ1bmM7XG4gICAgfTtcbiAgICBOb2RlRmFjdG9yeS5wcm90b3R5cGUuc2V0Q3JlYXRvcnMgPSBmdW5jdGlvbiAobWFwcykge1xuICAgICAgICBmb3IgKHZhciBraW5kIGluIG1hcHMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KGtpbmQsIG1hcHNba2luZF0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOb2RlRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGtpbmQpIHtcbiAgICAgICAgdmFyIHJlc3QgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHJlc3RbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZ1bmMgPSB0aGlzLmZhY3Rvcnlba2luZF0gfHwgdGhpcy5mYWN0b3J5Wydub2RlJ107XG4gICAgICAgIHZhciBub2RlID0gZnVuYy5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3RoaXMsIHJlc3RbMF1dLCBfX3JlYWQocmVzdC5zbGljZSgxKSksIGZhbHNlKSk7XG4gICAgICAgIGlmIChraW5kID09PSAnbm9kZScpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdGlvbi5hZGROb2RlKHJlc3RbMF0sIG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgTm9kZUZhY3RvcnkucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChraW5kKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZhY3Rvcnlba2luZF07XG4gICAgfTtcbiAgICByZXR1cm4gTm9kZUZhY3Rvcnk7XG59KCkpO1xuZXhwb3J0cy5Ob2RlRmFjdG9yeSA9IE5vZGVGYWN0b3J5O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Tm9kZUZhY3RvcnkuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19yZWFkID0gKHRoaXMgJiYgdGhpcy5fX3JlYWQpIHx8IGZ1bmN0aW9uIChvLCBuKSB7XG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICAgIGlmICghbSkgcmV0dXJuIG87XG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XG4gICAgdHJ5IHtcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XG4gICAgfVxuICAgIHJldHVybiBhcjtcbn07XG52YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTm9kZVV0aWxfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9Ob2RlVXRpbC5qc1wiKSk7XG52YXIgVGV4Q29uc3RhbnRzX2pzXzEgPSByZXF1aXJlKFwiLi9UZXhDb25zdGFudHMuanNcIik7XG52YXIgUGFyc2VVdGlsX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vUGFyc2VVdGlsLmpzXCIpKTtcbnZhciBQYXJzZU1ldGhvZHM7XG4oZnVuY3Rpb24gKFBhcnNlTWV0aG9kcykge1xuICAgIGZ1bmN0aW9uIHZhcmlhYmxlKHBhcnNlciwgYykge1xuICAgICAgICB2YXIgZGVmID0gUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5nZXRGb250RGVmKHBhcnNlcik7XG4gICAgICAgIHZhciBlbnYgPSBwYXJzZXIuc3RhY2suZW52O1xuICAgICAgICBpZiAoZW52Lm11bHRpTGV0dGVySWRlbnRpZmllcnMgJiYgZW52LmZvbnQgIT09ICcnKSB7XG4gICAgICAgICAgICBjID0gcGFyc2VyLnN0cmluZy5zdWJzdHIocGFyc2VyLmkgLSAxKS5tYXRjaChlbnYubXVsdGlMZXR0ZXJJZGVudGlmaWVycylbMF07XG4gICAgICAgICAgICBwYXJzZXIuaSArPSBjLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAoZGVmLm1hdGh2YXJpYW50ID09PSBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCAmJiBlbnYubm9BdXRvT1AgJiYgYy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZGVmLmF1dG9PUCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbWknLCBkZWYsIGMpO1xuICAgICAgICBwYXJzZXIuUHVzaChub2RlKTtcbiAgICB9XG4gICAgUGFyc2VNZXRob2RzLnZhcmlhYmxlID0gdmFyaWFibGU7XG4gICAgZnVuY3Rpb24gZGlnaXQocGFyc2VyLCBjKSB7XG4gICAgICAgIHZhciBtbWw7XG4gICAgICAgIHZhciBwYXR0ZXJuID0gcGFyc2VyLmNvbmZpZ3VyYXRpb24ub3B0aW9uc1snZGlnaXRzJ107XG4gICAgICAgIHZhciBuID0gcGFyc2VyLnN0cmluZy5zbGljZShwYXJzZXIuaSAtIDEpLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICB2YXIgZGVmID0gUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5nZXRGb250RGVmKHBhcnNlcik7XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBtbWwgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtbicsIGRlZiwgblswXS5yZXBsYWNlKC9be31dL2csICcnKSk7XG4gICAgICAgICAgICBwYXJzZXIuaSArPSBuWzBdLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtbWwgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtbycsIGRlZiwgYyk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyc2VyLlB1c2gobW1sKTtcbiAgICB9XG4gICAgUGFyc2VNZXRob2RzLmRpZ2l0ID0gZGlnaXQ7XG4gICAgZnVuY3Rpb24gY29udHJvbFNlcXVlbmNlKHBhcnNlciwgX2MpIHtcbiAgICAgICAgdmFyIG5hbWUgPSBwYXJzZXIuR2V0Q1MoKTtcbiAgICAgICAgcGFyc2VyLnBhcnNlKCdtYWNybycsIFtwYXJzZXIsIG5hbWVdKTtcbiAgICB9XG4gICAgUGFyc2VNZXRob2RzLmNvbnRyb2xTZXF1ZW5jZSA9IGNvbnRyb2xTZXF1ZW5jZTtcbiAgICBmdW5jdGlvbiBtYXRoY2hhcjBtaShwYXJzZXIsIG1jaGFyKSB7XG4gICAgICAgIHZhciBkZWYgPSBtY2hhci5hdHRyaWJ1dGVzIHx8IHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuSVRBTElDIH07XG4gICAgICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbWknLCBkZWYsIG1jaGFyLmNoYXIpO1xuICAgICAgICBwYXJzZXIuUHVzaChub2RlKTtcbiAgICB9XG4gICAgUGFyc2VNZXRob2RzLm1hdGhjaGFyMG1pID0gbWF0aGNoYXIwbWk7XG4gICAgZnVuY3Rpb24gbWF0aGNoYXIwbW8ocGFyc2VyLCBtY2hhcikge1xuICAgICAgICB2YXIgZGVmID0gbWNoYXIuYXR0cmlidXRlcyB8fCB7fTtcbiAgICAgICAgZGVmWydzdHJldGNoeSddID0gZmFsc2U7XG4gICAgICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbW8nLCBkZWYsIG1jaGFyLmNoYXIpO1xuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0UHJvcGVydHkobm9kZSwgJ2ZpeFN0cmV0Y2h5JywgdHJ1ZSk7XG4gICAgICAgIHBhcnNlci5jb25maWd1cmF0aW9uLmFkZE5vZGUoJ2ZpeFN0cmV0Y2h5Jywgbm9kZSk7XG4gICAgICAgIHBhcnNlci5QdXNoKG5vZGUpO1xuICAgIH1cbiAgICBQYXJzZU1ldGhvZHMubWF0aGNoYXIwbW8gPSBtYXRoY2hhcjBtbztcbiAgICBmdW5jdGlvbiBtYXRoY2hhcjcocGFyc2VyLCBtY2hhcikge1xuICAgICAgICB2YXIgZGVmID0gbWNoYXIuYXR0cmlidXRlcyB8fCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9O1xuICAgICAgICBpZiAocGFyc2VyLnN0YWNrLmVudlsnZm9udCddKSB7XG4gICAgICAgICAgICBkZWZbJ21hdGh2YXJpYW50J10gPSBwYXJzZXIuc3RhY2suZW52Wydmb250J107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtaScsIGRlZiwgbWNoYXIuY2hhcik7XG4gICAgICAgIHBhcnNlci5QdXNoKG5vZGUpO1xuICAgIH1cbiAgICBQYXJzZU1ldGhvZHMubWF0aGNoYXI3ID0gbWF0aGNoYXI3O1xuICAgIGZ1bmN0aW9uIGRlbGltaXRlcihwYXJzZXIsIGRlbGltKSB7XG4gICAgICAgIHZhciBkZWYgPSBkZWxpbS5hdHRyaWJ1dGVzIHx8IHt9O1xuICAgICAgICBkZWYgPSBPYmplY3QuYXNzaWduKHsgZmVuY2U6IGZhbHNlLCBzdHJldGNoeTogZmFsc2UgfSwgZGVmKTtcbiAgICAgICAgdmFyIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtbycsIGRlZiwgZGVsaW0uY2hhcik7XG4gICAgICAgIHBhcnNlci5QdXNoKG5vZGUpO1xuICAgIH1cbiAgICBQYXJzZU1ldGhvZHMuZGVsaW1pdGVyID0gZGVsaW1pdGVyO1xuICAgIGZ1bmN0aW9uIGVudmlyb25tZW50KHBhcnNlciwgZW52LCBmdW5jLCBhcmdzKSB7XG4gICAgICAgIHZhciBlbmQgPSBhcmdzWzBdO1xuICAgICAgICB2YXIgbW1sID0gcGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnYmVnaW4nKS5zZXRQcm9wZXJ0aWVzKHsgbmFtZTogZW52LCBlbmQ6IGVuZCB9KTtcbiAgICAgICAgbW1sID0gZnVuYy5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3BhcnNlciwgbW1sXSwgX19yZWFkKGFyZ3Muc2xpY2UoMSkpLCBmYWxzZSkpO1xuICAgICAgICBwYXJzZXIuUHVzaChtbWwpO1xuICAgIH1cbiAgICBQYXJzZU1ldGhvZHMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDtcbn0pKFBhcnNlTWV0aG9kcyB8fCAoUGFyc2VNZXRob2RzID0ge30pKTtcbmV4cG9ydHMuZGVmYXVsdCA9IFBhcnNlTWV0aG9kcztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBhcnNlTWV0aG9kcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbnZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBTdGFja0l0ZW1GYWN0b3J5X2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vU3RhY2tJdGVtRmFjdG9yeS5qc1wiKSk7XG52YXIgTm9kZUZhY3RvcnlfanNfMSA9IHJlcXVpcmUoXCIuL05vZGVGYWN0b3J5LmpzXCIpO1xudmFyIE5vZGVVdGlsX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vTm9kZVV0aWwuanNcIikpO1xudmFyIE9wdGlvbnNfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlsL09wdGlvbnMuanNcIik7XG52YXIgUGFyc2VPcHRpb25zID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYXJzZU9wdGlvbnMoY29uZmlndXJhdGlvbiwgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSBbXTsgfVxuICAgICAgICB0aGlzLm9wdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5wYWNrYWdlRGF0YSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5wYXJzZXJzID0gW107XG4gICAgICAgIHRoaXMucm9vdCA9IG51bGw7XG4gICAgICAgIHRoaXMubm9kZUxpc3RzID0ge307XG4gICAgICAgIHRoaXMuZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IGNvbmZpZ3VyYXRpb24uaGFuZGxlcnM7XG4gICAgICAgIHRoaXMubm9kZUZhY3RvcnkgPSBuZXcgTm9kZUZhY3RvcnlfanNfMS5Ob2RlRmFjdG9yeSgpO1xuICAgICAgICB0aGlzLm5vZGVGYWN0b3J5LmNvbmZpZ3VyYXRpb24gPSB0aGlzO1xuICAgICAgICB0aGlzLm5vZGVGYWN0b3J5LnNldENyZWF0b3JzKGNvbmZpZ3VyYXRpb24ubm9kZXMpO1xuICAgICAgICB0aGlzLml0ZW1GYWN0b3J5ID0gbmV3IFN0YWNrSXRlbUZhY3RvcnlfanNfMS5kZWZhdWx0KGNvbmZpZ3VyYXRpb24uaXRlbXMpO1xuICAgICAgICB0aGlzLml0ZW1GYWN0b3J5LmNvbmZpZ3VyYXRpb24gPSB0aGlzO1xuICAgICAgICBPcHRpb25zX2pzXzEuZGVmYXVsdE9wdGlvbnMuYXBwbHkodm9pZCAwLCBfX3NwcmVhZEFycmF5KFt0aGlzLm9wdGlvbnNdLCBfX3JlYWQob3B0aW9ucyksIGZhbHNlKSk7XG4gICAgICAgICgwLCBPcHRpb25zX2pzXzEuZGVmYXVsdE9wdGlvbnMpKHRoaXMub3B0aW9ucywgY29uZmlndXJhdGlvbi5vcHRpb25zKTtcbiAgICB9XG4gICAgUGFyc2VPcHRpb25zLnByb3RvdHlwZS5wdXNoUGFyc2VyID0gZnVuY3Rpb24gKHBhcnNlcikge1xuICAgICAgICB0aGlzLnBhcnNlcnMudW5zaGlmdChwYXJzZXIpO1xuICAgIH07XG4gICAgUGFyc2VPcHRpb25zLnByb3RvdHlwZS5wb3BQYXJzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucGFyc2Vycy5zaGlmdCgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlT3B0aW9ucy5wcm90b3R5cGUsIFwicGFyc2VyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZXJzWzBdO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUGFyc2VPcHRpb25zLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5wYXJzZXJzID0gW107XG4gICAgICAgIHRoaXMucm9vdCA9IG51bGw7XG4gICAgICAgIHRoaXMubm9kZUxpc3RzID0ge307XG4gICAgICAgIHRoaXMuZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50YWdzLnJlc2V0VGFnKCk7XG4gICAgfTtcbiAgICBQYXJzZU9wdGlvbnMucHJvdG90eXBlLmFkZE5vZGUgPSBmdW5jdGlvbiAocHJvcGVydHksIG5vZGUpIHtcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm5vZGVMaXN0c1twcm9wZXJ0eV07XG4gICAgICAgIGlmICghbGlzdCkge1xuICAgICAgICAgICAgbGlzdCA9IHRoaXMubm9kZUxpc3RzW3Byb3BlcnR5XSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGxpc3QucHVzaChub2RlKTtcbiAgICAgICAgaWYgKG5vZGUua2luZCAhPT0gcHJvcGVydHkpIHtcbiAgICAgICAgICAgIHZhciBpbmxpc3RzID0gKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRQcm9wZXJ0eShub2RlLCAnaW4tbGlzdHMnKSB8fCAnJyk7XG4gICAgICAgICAgICB2YXIgbGlzdHMgPSAoaW5saXN0cyA/IGlubGlzdHMuc3BsaXQoLywvKSA6IFtdKS5jb25jYXQocHJvcGVydHkpLmpvaW4oJywnKTtcbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRQcm9wZXJ0eShub2RlLCAnaW4tbGlzdHMnLCBsaXN0cyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhcnNlT3B0aW9ucy5wcm90b3R5cGUuZ2V0TGlzdCA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICB2YXIgZV8xLCBfYTtcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm5vZGVMaXN0c1twcm9wZXJ0eV0gfHwgW107XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIGxpc3RfMSA9IF9fdmFsdWVzKGxpc3QpLCBsaXN0XzFfMSA9IGxpc3RfMS5uZXh0KCk7ICFsaXN0XzFfMS5kb25lOyBsaXN0XzFfMSA9IGxpc3RfMS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGxpc3RfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluVHJlZShub2RlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0XzFfMSAmJiAhbGlzdF8xXzEuZG9uZSAmJiAoX2EgPSBsaXN0XzEucmV0dXJuKSkgX2EuY2FsbChsaXN0XzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubm9kZUxpc3RzW3Byb3BlcnR5XSA9IHJlc3VsdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFBhcnNlT3B0aW9ucy5wcm90b3R5cGUucmVtb3ZlRnJvbUxpc3QgPSBmdW5jdGlvbiAocHJvcGVydHksIG5vZGVzKSB7XG4gICAgICAgIHZhciBlXzIsIF9hO1xuICAgICAgICB2YXIgbGlzdCA9IHRoaXMubm9kZUxpc3RzW3Byb3BlcnR5XSB8fCBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZvciAodmFyIG5vZGVzXzEgPSBfX3ZhbHVlcyhub2RlcyksIG5vZGVzXzFfMSA9IG5vZGVzXzEubmV4dCgpOyAhbm9kZXNfMV8xLmRvbmU7IG5vZGVzXzFfMSA9IG5vZGVzXzEubmV4dCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBub2Rlc18xXzEudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSBsaXN0LmluZGV4T2Yobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBsaXN0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVfMl8xKSB7IGVfMiA9IHsgZXJyb3I6IGVfMl8xIH07IH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChub2Rlc18xXzEgJiYgIW5vZGVzXzFfMS5kb25lICYmIChfYSA9IG5vZGVzXzEucmV0dXJuKSkgX2EuY2FsbChub2Rlc18xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFyc2VPcHRpb25zLnByb3RvdHlwZS5pblRyZWUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB3aGlsZSAobm9kZSAmJiBub2RlICE9PSB0aGlzLnJvb3QpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gISFub2RlO1xuICAgIH07XG4gICAgcmV0dXJuIFBhcnNlT3B0aW9ucztcbn0oKSk7XG5leHBvcnRzLmRlZmF1bHQgPSBQYXJzZU9wdGlvbnM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1QYXJzZU9wdGlvbnMuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fcmVhZCA9ICh0aGlzICYmIHRoaXMuX19yZWFkKSB8fCBmdW5jdGlvbiAobywgbikge1xuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcbiAgICBpZiAoIW0pIHJldHVybiBvO1xuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xuICAgIHRyeSB7XG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cbiAgICBmaW5hbGx5IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxuICAgIH1cbiAgICByZXR1cm4gYXI7XG59O1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xudmFyIF9fdmFsdWVzID0gKHRoaXMgJiYgdGhpcy5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykge1xuICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5CYXNlSXRlbSA9IGV4cG9ydHMuTW1sU3RhY2sgPSB2b2lkIDA7XG52YXIgVGV4RXJyb3JfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi9UZXhFcnJvci5qc1wiKSk7XG52YXIgTW1sU3RhY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1tbFN0YWNrKF9ub2Rlcykge1xuICAgICAgICB0aGlzLl9ub2RlcyA9IF9ub2RlcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1tbFN0YWNrLnByb3RvdHlwZSwgXCJub2Rlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTW1sU3RhY2sucHJvdG90eXBlLlB1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBub2Rlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IHRoaXMuX25vZGVzKS5wdXNoLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQobm9kZXMpLCBmYWxzZSkpO1xuICAgIH07XG4gICAgTW1sU3RhY2sucHJvdG90eXBlLlBvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLnBvcCgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1tbFN0YWNrLnByb3RvdHlwZSwgXCJGaXJzdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzW3RoaXMuU2l6ZSgpIC0gMV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuX25vZGVzW3RoaXMuU2l6ZSgpIC0gMV0gPSBub2RlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1tbFN0YWNrLnByb3RvdHlwZSwgXCJMYXN0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbm9kZXNbMF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuX25vZGVzWzBdID0gbm9kZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE1tbFN0YWNrLnByb3RvdHlwZS5QZWVrID0gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgaWYgKG4gPT0gbnVsbCkge1xuICAgICAgICAgICAgbiA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLnNsaWNlKHRoaXMuU2l6ZSgpIC0gbik7XG4gICAgfTtcbiAgICBNbWxTdGFjay5wcm90b3R5cGUuU2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLmxlbmd0aDtcbiAgICB9O1xuICAgIE1tbFN0YWNrLnByb3RvdHlwZS5DbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbm9kZXMgPSBbXTtcbiAgICB9O1xuICAgIE1tbFN0YWNrLnByb3RvdHlwZS50b01tbCA9IGZ1bmN0aW9uIChpbmZlcnJlZCwgZm9yY2VSb3cpIHtcbiAgICAgICAgaWYgKGluZmVycmVkID09PSB2b2lkIDApIHsgaW5mZXJyZWQgPSB0cnVlOyB9XG4gICAgICAgIGlmICh0aGlzLl9ub2Rlcy5sZW5ndGggPT09IDEgJiYgIWZvcmNlUm93KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5GaXJzdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGUoJ25vZGUnLCBpbmZlcnJlZCA/ICdpbmZlcnJlZE1yb3cnIDogJ21yb3cnLCB0aGlzLl9ub2Rlcywge30pO1xuICAgIH07XG4gICAgTW1sU3RhY2sucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uIChraW5kKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIHJlc3QgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHJlc3RbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMuZmFjdG9yeS5jb25maWd1cmF0aW9uLm5vZGVGYWN0b3J5KS5jcmVhdGUuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW2tpbmRdLCBfX3JlYWQocmVzdCksIGZhbHNlKSk7XG4gICAgfTtcbiAgICByZXR1cm4gTW1sU3RhY2s7XG59KCkpO1xuZXhwb3J0cy5NbWxTdGFjayA9IE1tbFN0YWNrO1xudmFyIEJhc2VJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQmFzZUl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQmFzZUl0ZW0oZmFjdG9yeSkge1xuICAgICAgICB2YXIgbm9kZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIG5vZGVzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG5vZGVzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5mYWN0b3J5ID0gZmFjdG9yeTtcbiAgICAgICAgX3RoaXMuZ2xvYmFsID0ge307XG4gICAgICAgIF90aGlzLl9wcm9wZXJ0aWVzID0ge307XG4gICAgICAgIGlmIChfdGhpcy5pc09wZW4pIHtcbiAgICAgICAgICAgIF90aGlzLl9lbnYgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCYXNlSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdiYXNlJztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCYXNlSXRlbS5wcm90b3R5cGUsIFwiZW52XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW52O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fZW52ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFzZUl0ZW0ucHJvdG90eXBlLCBcImNvcHlFbnZcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQmFzZUl0ZW0ucHJvdG90eXBlLmdldFByb3BlcnR5ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvcGVydGllc1trZXldO1xuICAgIH07XG4gICAgQmFzZUl0ZW0ucHJvdG90eXBlLnNldFByb3BlcnR5ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcHJvcGVydGllc1trZXldID0gdmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJhc2VJdGVtLnByb3RvdHlwZSwgXCJpc09wZW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCYXNlSXRlbS5wcm90b3R5cGUsIFwiaXNDbG9zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJhc2VJdGVtLnByb3RvdHlwZSwgXCJpc0ZpbmFsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCYXNlSXRlbS5wcm90b3R5cGUuaXNLaW5kID0gZnVuY3Rpb24gKGtpbmQpIHtcbiAgICAgICAgcmV0dXJuIGtpbmQgPT09IHRoaXMua2luZDtcbiAgICB9O1xuICAgIEJhc2VJdGVtLnByb3RvdHlwZS5jaGVja0l0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ292ZXInKSAmJiB0aGlzLmlzT3Blbikge1xuICAgICAgICAgICAgaXRlbS5zZXRQcm9wZXJ0eSgnbnVtJywgdGhpcy50b01tbChmYWxzZSkpO1xuICAgICAgICAgICAgdGhpcy5DbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnY2VsbCcpICYmIHRoaXMuaXNPcGVuKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5nZXRQcm9wZXJ0eSgnbGluZWJyZWFrJykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQmFzZUl0ZW0uZmFpbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ01pc3BsYWNlZCcsICdNaXNwbGFjZWQgJTEnLCBpdGVtLmdldE5hbWUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0uaXNDbG9zZSAmJiB0aGlzLmdldEVycm9ycyhpdGVtLmtpbmQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBfX3JlYWQodGhpcy5nZXRFcnJvcnMoaXRlbS5raW5kKSwgMiksIGlkID0gX2FbMF0sIG1lc3NhZ2UgPSBfYVsxXTtcbiAgICAgICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoaWQsIG1lc3NhZ2UsIGl0ZW0uZ2V0TmFtZSgpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWl0ZW0uaXNGaW5hbCkge1xuICAgICAgICAgICAgcmV0dXJuIEJhc2VJdGVtLnN1Y2Nlc3M7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5QdXNoKGl0ZW0uRmlyc3QpO1xuICAgICAgICByZXR1cm4gQmFzZUl0ZW0uZmFpbDtcbiAgICB9O1xuICAgIEJhc2VJdGVtLnByb3RvdHlwZS5jbGVhckVudiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVfMSwgX2E7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzKE9iamVjdC5rZXlzKHRoaXMuZW52KSksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBfYy52YWx1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5lbnZbaWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJhc2VJdGVtLnByb3RvdHlwZS5zZXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKGRlZikge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuX3Byb3BlcnRpZXMsIGRlZik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmFzZUl0ZW0ucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFByb3BlcnR5KCduYW1lJyk7XG4gICAgfTtcbiAgICBCYXNlSXRlbS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtpbmQgKyAnWycgKyB0aGlzLm5vZGVzLmpvaW4oJzsgJykgKyAnXSc7XG4gICAgfTtcbiAgICBCYXNlSXRlbS5wcm90b3R5cGUuZ2V0RXJyb3JzID0gZnVuY3Rpb24gKGtpbmQpIHtcbiAgICAgICAgdmFyIENMQVNTID0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICAgICAgcmV0dXJuIChDTEFTUy5lcnJvcnMgfHwge30pW2tpbmRdIHx8IEJhc2VJdGVtLmVycm9yc1traW5kXTtcbiAgICB9O1xuICAgIEJhc2VJdGVtLmZhaWwgPSBbbnVsbCwgZmFsc2VdO1xuICAgIEJhc2VJdGVtLnN1Y2Nlc3MgPSBbbnVsbCwgdHJ1ZV07XG4gICAgQmFzZUl0ZW0uZXJyb3JzID0ge1xuICAgICAgICBlbmQ6IFsnTWlzc2luZ0JlZ2luRXh0cmFFbmQnLCAnTWlzc2luZyBcXFxcYmVnaW57JTF9IG9yIGV4dHJhIFxcXFxlbmR7JTF9J10sXG4gICAgICAgIGNsb3NlOiBbJ0V4dHJhQ2xvc2VNaXNzaW5nT3BlbicsICdFeHRyYSBjbG9zZSBicmFjZSBvciBtaXNzaW5nIG9wZW4gYnJhY2UnXSxcbiAgICAgICAgcmlnaHQ6IFsnTWlzc2luZ0xlZnRFeHRyYVJpZ2h0JywgJ01pc3NpbmcgXFxcXGxlZnQgb3IgZXh0cmEgXFxcXHJpZ2h0J10sXG4gICAgICAgIG1pZGRsZTogWydFeHRyYU1pZGRsZScsICdFeHRyYSBcXFxcbWlkZGxlJ11cbiAgICB9O1xuICAgIHJldHVybiBCYXNlSXRlbTtcbn0oTW1sU3RhY2spKTtcbmV4cG9ydHMuQmFzZUl0ZW0gPSBCYXNlSXRlbTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0YWNrSXRlbS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX2E7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU3RhY2tJdGVtX2pzXzEgPSByZXF1aXJlKFwiLi9TdGFja0l0ZW0uanNcIik7XG52YXIgRmFjdG9yeV9qc18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvVHJlZS9GYWN0b3J5LmpzXCIpO1xudmFyIER1bW15SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKER1bW15SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBEdW1teUl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIER1bW15SXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbnZhciBTdGFja0l0ZW1GYWN0b3J5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3RhY2tJdGVtRmFjdG9yeSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdGFja0l0ZW1GYWN0b3J5KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZGVmYXVsdEtpbmQgPSAnZHVtbXknO1xuICAgICAgICBfdGhpcy5jb25maWd1cmF0aW9uID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdGFja0l0ZW1GYWN0b3J5LkRlZmF1bHRTdGFja0l0ZW1zID0gKF9hID0ge30sXG4gICAgICAgIF9hW0R1bW15SXRlbS5wcm90b3R5cGUua2luZF0gPSBEdW1teUl0ZW0sXG4gICAgICAgIF9hKTtcbiAgICByZXR1cm4gU3RhY2tJdGVtRmFjdG9yeTtcbn0oRmFjdG9yeV9qc18xLkFic3RyYWN0RmFjdG9yeSkpO1xuZXhwb3J0cy5kZWZhdWx0ID0gU3RhY2tJdGVtRmFjdG9yeTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN0YWNrSXRlbUZhY3RvcnkuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlRleENvbnN0YW50ID0gdm9pZCAwO1xudmFyIFRleENvbnN0YW50O1xuKGZ1bmN0aW9uIChUZXhDb25zdGFudCkge1xuICAgIFRleENvbnN0YW50LlZhcmlhbnQgPSB7XG4gICAgICAgIE5PUk1BTDogJ25vcm1hbCcsXG4gICAgICAgIEJPTEQ6ICdib2xkJyxcbiAgICAgICAgSVRBTElDOiAnaXRhbGljJyxcbiAgICAgICAgQk9MRElUQUxJQzogJ2JvbGQtaXRhbGljJyxcbiAgICAgICAgRE9VQkxFU1RSVUNLOiAnZG91YmxlLXN0cnVjaycsXG4gICAgICAgIEZSQUtUVVI6ICdmcmFrdHVyJyxcbiAgICAgICAgQk9MREZSQUtUVVI6ICdib2xkLWZyYWt0dXInLFxuICAgICAgICBTQ1JJUFQ6ICdzY3JpcHQnLFxuICAgICAgICBCT0xEU0NSSVBUOiAnYm9sZC1zY3JpcHQnLFxuICAgICAgICBTQU5TU0VSSUY6ICdzYW5zLXNlcmlmJyxcbiAgICAgICAgQk9MRFNBTlNTRVJJRjogJ2JvbGQtc2Fucy1zZXJpZicsXG4gICAgICAgIFNBTlNTRVJJRklUQUxJQzogJ3NhbnMtc2VyaWYtaXRhbGljJyxcbiAgICAgICAgU0FOU1NFUklGQk9MRElUQUxJQzogJ3NhbnMtc2VyaWYtYm9sZC1pdGFsaWMnLFxuICAgICAgICBNT05PU1BBQ0U6ICdtb25vc3BhY2UnLFxuICAgICAgICBJTklUSUFMOiAnaW5pdGFsJyxcbiAgICAgICAgVEFJTEVEOiAndGFpbGVkJyxcbiAgICAgICAgTE9PUEVEOiAnbG9vcGVkJyxcbiAgICAgICAgU1RSRVRDSEVEOiAnc3RyZXRjaGVkJyxcbiAgICAgICAgQ0FMTElHUkFQSElDOiAnLXRleC1jYWxsaWdyYXBoaWMnLFxuICAgICAgICBCT0xEQ0FMTElHUkFQSElDOiAnLXRleC1ib2xkLWNhbGxpZ3JhcGhpYycsXG4gICAgICAgIE9MRFNUWUxFOiAnLXRleC1vbGRzdHlsZScsXG4gICAgICAgIEJPTERPTERTVFlMRTogJy10ZXgtYm9sZC1vbGRzdHlsZScsXG4gICAgICAgIE1BVEhJVEFMSUM6ICctdGV4LW1hdGhpdCdcbiAgICB9O1xuICAgIFRleENvbnN0YW50LkZvcm0gPSB7XG4gICAgICAgIFBSRUZJWDogJ3ByZWZpeCcsXG4gICAgICAgIElORklYOiAnaW5maXgnLFxuICAgICAgICBQT1NURklYOiAncG9zdGZpeCdcbiAgICB9O1xuICAgIFRleENvbnN0YW50LkxpbmVCcmVhayA9IHtcbiAgICAgICAgQVVUTzogJ2F1dG8nLFxuICAgICAgICBORVdMSU5FOiAnbmV3bGluZScsXG4gICAgICAgIE5PQlJFQUs6ICdub2JyZWFrJyxcbiAgICAgICAgR09PREJSRUFLOiAnZ29vZGJyZWFrJyxcbiAgICAgICAgQkFEQlJFQUs6ICdiYWRicmVhaydcbiAgICB9O1xuICAgIFRleENvbnN0YW50LkxpbmVCcmVha1N0eWxlID0ge1xuICAgICAgICBCRUZPUkU6ICdiZWZvcmUnLFxuICAgICAgICBBRlRFUjogJ2FmdGVyJyxcbiAgICAgICAgRFVQTElDQVRFOiAnZHVwbGljYXRlJyxcbiAgICAgICAgSU5GSVhMSU5CUkVBS1NUWUxFOiAnaW5maXhsaW5lYnJlYWtzdHlsZSdcbiAgICB9O1xuICAgIFRleENvbnN0YW50LkluZGVudEFsaWduID0ge1xuICAgICAgICBMRUZUOiAnbGVmdCcsXG4gICAgICAgIENFTlRFUjogJ2NlbnRlcicsXG4gICAgICAgIFJJR0hUOiAncmlnaHQnLFxuICAgICAgICBBVVRPOiAnYXV0bycsXG4gICAgICAgIElEOiAnaWQnLFxuICAgICAgICBJTkRFTlRBTElHTjogJ2luZGVudGFsaWduJ1xuICAgIH07XG4gICAgVGV4Q29uc3RhbnQuSW5kZW50U2hpZnQgPSB7XG4gICAgICAgIElOREVOVFNISUZUOiAnaW5kZW50c2hpZnQnXG4gICAgfTtcbiAgICBUZXhDb25zdGFudC5MaW5lVGhpY2tuZXNzID0ge1xuICAgICAgICBUSElOOiAndGhpbicsXG4gICAgICAgIE1FRElVTTogJ21lZGl1bScsXG4gICAgICAgIFRISUNLOiAndGhpY2snXG4gICAgfTtcbiAgICBUZXhDb25zdGFudC5Ob3RhdGlvbiA9IHtcbiAgICAgICAgTE9OR0RJVjogJ2xvbmdkaXYnLFxuICAgICAgICBBQ1RVQVJJQUw6ICdhY3R1YXJpYWwnLFxuICAgICAgICBQSEFTT1JBTkdMRTogJ3BoYXNvcmFuZ2xlJyxcbiAgICAgICAgUkFESUNBTDogJ3JhZGljYWwnLFxuICAgICAgICBCT1g6ICdib3gnLFxuICAgICAgICBST1VOREVEQk9YOiAncm91bmRlZGJveCcsXG4gICAgICAgIENJUkNMRTogJ2NpcmNsZScsXG4gICAgICAgIExFRlQ6ICdsZWZ0JyxcbiAgICAgICAgUklHSFQ6ICdyaWdodCcsXG4gICAgICAgIFRPUDogJ3RvcCcsXG4gICAgICAgIEJPVFRPTTogJ2JvdHRvbScsXG4gICAgICAgIFVQRElBR09OQUxTVFJJS0U6ICd1cGRpYWdvbmFsc3RyaWtlJyxcbiAgICAgICAgRE9XTkRJQUdPTkFMU1RSSUtFOiAnZG93bmRpYWdvbmFsc3RyaWtlJyxcbiAgICAgICAgVkVSVElDQUxTVFJJS0U6ICd2ZXJ0aWNhbHN0cmlrZScsXG4gICAgICAgIEhPUklaT05UQUxTVFJJS0U6ICdob3Jpem9udGFsc3RyaWtlJyxcbiAgICAgICAgTk9SVEhFQVNUQVJST1c6ICdub3J0aGVhc3RhcnJvdycsXG4gICAgICAgIE1BRFJVV0I6ICdtYWRydXdiJyxcbiAgICAgICAgVVBESUFHT05BTEFSUk9XOiAndXBkaWFnb25hbGFycm93J1xuICAgIH07XG4gICAgVGV4Q29uc3RhbnQuQWxpZ24gPSB7XG4gICAgICAgIFRPUDogJ3RvcCcsXG4gICAgICAgIEJPVFRPTTogJ2JvdHRvbScsXG4gICAgICAgIENFTlRFUjogJ2NlbnRlcicsXG4gICAgICAgIEJBU0VMSU5FOiAnYmFzZWxpbmUnLFxuICAgICAgICBBWElTOiAnYXhpcycsXG4gICAgICAgIExFRlQ6ICdsZWZ0JyxcbiAgICAgICAgUklHSFQ6ICdyaWdodCdcbiAgICB9O1xuICAgIFRleENvbnN0YW50LkxpbmVzID0ge1xuICAgICAgICBOT05FOiAnbm9uZScsXG4gICAgICAgIFNPTElEOiAnc29saWQnLFxuICAgICAgICBEQVNIRUQ6ICdkYXNoZWQnXG4gICAgfTtcbiAgICBUZXhDb25zdGFudC5TaWRlID0ge1xuICAgICAgICBMRUZUOiAnbGVmdCcsXG4gICAgICAgIFJJR0hUOiAncmlnaHQnLFxuICAgICAgICBMRUZUT1ZFUkxBUDogJ2xlZnRvdmVybGFwJyxcbiAgICAgICAgUklHSFRPVkVSTEFQOiAncmlnaHRvdmVybGFwJ1xuICAgIH07XG4gICAgVGV4Q29uc3RhbnQuV2lkdGggPSB7XG4gICAgICAgIEFVVE86ICdhdXRvJyxcbiAgICAgICAgRklUOiAnZml0J1xuICAgIH07XG4gICAgVGV4Q29uc3RhbnQuQWN0aW9udHlwZSA9IHtcbiAgICAgICAgVE9HR0xFOiAndG9nZ2xlJyxcbiAgICAgICAgU1RBVFVTTElORTogJ3N0YXR1c2xpbmUnLFxuICAgICAgICBUT09MVElQOiAndG9vbHRpcCcsXG4gICAgICAgIElOUFVUOiAnaW5wdXQnXG4gICAgfTtcbiAgICBUZXhDb25zdGFudC5PdmVyZmxvdyA9IHtcbiAgICAgICAgTElOQlJFQUs6ICdsaW5lYnJlYWsnLFxuICAgICAgICBTQ1JPTEw6ICdzY3JvbGwnLFxuICAgICAgICBFTElERTogJ2VsaWRlJyxcbiAgICAgICAgVFJVTkNBVEU6ICd0cnVuY2F0ZScsXG4gICAgICAgIFNDQUxFOiAnc2NhbGUnXG4gICAgfTtcbiAgICBUZXhDb25zdGFudC5Vbml0ID0ge1xuICAgICAgICBFTTogJ2VtJyxcbiAgICAgICAgRVg6ICdleCcsXG4gICAgICAgIFBYOiAncHgnLFxuICAgICAgICBJTjogJ2luJyxcbiAgICAgICAgQ006ICdjbScsXG4gICAgICAgIE1NOiAnbW0nLFxuICAgICAgICBQVDogJ3B0JyxcbiAgICAgICAgUEM6ICdwYydcbiAgICB9O1xufSkoVGV4Q29uc3RhbnQgPSBleHBvcnRzLlRleENvbnN0YW50IHx8IChleHBvcnRzLlRleENvbnN0YW50ID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRleENvbnN0YW50cy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0KSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xufSkgOiBmdW5jdGlvbihvLCB2KSB7XG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xufSk7XG52YXIgX19pbXBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbnZhciBfX3ZhbHVlcyA9ICh0aGlzICYmIHRoaXMuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHtcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbnZhciBfYTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQmFzZUNvbmZpZ3VyYXRpb24gPSBleHBvcnRzLkJhc2VUYWdzID0gZXhwb3J0cy5PdGhlciA9IHZvaWQgMDtcbnZhciBDb25maWd1cmF0aW9uX2pzXzEgPSByZXF1aXJlKFwiLi4vQ29uZmlndXJhdGlvbi5qc1wiKTtcbnZhciBNYXBIYW5kbGVyX2pzXzEgPSByZXF1aXJlKFwiLi4vTWFwSGFuZGxlci5qc1wiKTtcbnZhciBUZXhFcnJvcl9qc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9UZXhFcnJvci5qc1wiKSk7XG52YXIgTm9kZVV0aWxfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vTm9kZVV0aWwuanNcIikpO1xudmFyIFN5bWJvbE1hcF9qc18xID0gcmVxdWlyZShcIi4uL1N5bWJvbE1hcC5qc1wiKTtcbnZhciBiaXRlbSA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwiLi9CYXNlSXRlbXMuanNcIikpO1xudmFyIFRhZ3NfanNfMSA9IHJlcXVpcmUoXCIuLi9UYWdzLmpzXCIpO1xucmVxdWlyZShcIi4vQmFzZU1hcHBpbmdzLmpzXCIpO1xudmFyIE9wZXJhdG9yRGljdGlvbmFyeV9qc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NvcmUvTW1sVHJlZS9PcGVyYXRvckRpY3Rpb25hcnkuanNcIik7XG5uZXcgU3ltYm9sTWFwX2pzXzEuQ2hhcmFjdGVyTWFwKCdyZW1hcCcsIG51bGwsIHtcbiAgICAnLSc6ICdcXHUyMjEyJyxcbiAgICAnKic6ICdcXHUyMjE3JyxcbiAgICAnYCc6ICdcXHUyMDE4J1xufSk7XG5mdW5jdGlvbiBPdGhlcihwYXJzZXIsIGNoYXIpIHtcbiAgICB2YXIgZm9udCA9IHBhcnNlci5zdGFjay5lbnZbJ2ZvbnQnXTtcbiAgICB2YXIgZGVmID0gZm9udCA/XG4gICAgICAgIHsgbWF0aHZhcmlhbnQ6IHBhcnNlci5zdGFjay5lbnZbJ2ZvbnQnXSB9IDoge307XG4gICAgdmFyIHJlbWFwID0gTWFwSGFuZGxlcl9qc18xLk1hcEhhbmRsZXIuZ2V0TWFwKCdyZW1hcCcpLmxvb2t1cChjaGFyKTtcbiAgICB2YXIgcmFuZ2UgPSAoMCwgT3BlcmF0b3JEaWN0aW9uYXJ5X2pzXzEuZ2V0UmFuZ2UpKGNoYXIpO1xuICAgIHZhciB0eXBlID0gKHJhbmdlID8gcmFuZ2VbM10gOiAnbW8nKTtcbiAgICB2YXIgbW8gPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsIHR5cGUsIGRlZiwgKHJlbWFwID8gcmVtYXAuY2hhciA6IGNoYXIpKTtcbiAgICByYW5nZVs0XSAmJiBtby5hdHRyaWJ1dGVzLnNldCgnbWF0aHZhcmlhbnQnLCByYW5nZVs0XSk7XG4gICAgaWYgKHR5cGUgPT09ICdtbycpIHtcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldFByb3BlcnR5KG1vLCAnZml4U3RyZXRjaHknLCB0cnVlKTtcbiAgICAgICAgcGFyc2VyLmNvbmZpZ3VyYXRpb24uYWRkTm9kZSgnZml4U3RyZXRjaHknLCBtbyk7XG4gICAgfVxuICAgIHBhcnNlci5QdXNoKG1vKTtcbn1cbmV4cG9ydHMuT3RoZXIgPSBPdGhlcjtcbmZ1bmN0aW9uIGNzVW5kZWZpbmVkKF9wYXJzZXIsIG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdVbmRlZmluZWRDb250cm9sU2VxdWVuY2UnLCAnVW5kZWZpbmVkIGNvbnRyb2wgc2VxdWVuY2UgJTEnLCAnXFxcXCcgKyBuYW1lKTtcbn1cbmZ1bmN0aW9uIGVudlVuZGVmaW5lZChfcGFyc2VyLCBlbnYpIHtcbiAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdVbmtub3duRW52JywgJ1Vua25vd24gZW52aXJvbm1lbnQgXFwnJTFcXCcnLCBlbnYpO1xufVxuZnVuY3Rpb24gZmlsdGVyTm9uc2NyaXB0KF9hKSB7XG4gICAgdmFyIGVfMSwgX2I7XG4gICAgdmFyIGRhdGEgPSBfYS5kYXRhO1xuICAgIHRyeSB7XG4gICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXMoZGF0YS5nZXRMaXN0KCdub25zY3JpcHQnKSksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHtcbiAgICAgICAgICAgIHZhciBtbWwgPSBfZC52YWx1ZTtcbiAgICAgICAgICAgIGlmIChtbWwuYXR0cmlidXRlcy5nZXQoJ3NjcmlwdGxldmVsJykgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gbW1sLnBhcmVudDtcbiAgICAgICAgICAgICAgICBwYXJlbnRfMS5jaGlsZE5vZGVzLnNwbGljZShwYXJlbnRfMS5jaGlsZEluZGV4KG1tbCksIDEpO1xuICAgICAgICAgICAgICAgIGRhdGEucmVtb3ZlRnJvbUxpc3QobW1sLmtpbmQsIFttbWxdKTtcbiAgICAgICAgICAgICAgICBpZiAobW1sLmlzS2luZCgnbXJvdycpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtc3R5bGUgPSBtbWwuY2hpbGROb2Rlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5yZW1vdmVGcm9tTGlzdCgnbXN0eWxlJywgW21zdHlsZV0pO1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnJlbW92ZUZyb21MaXN0KCdtc3BhY2UnLCBtc3R5bGUuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChtbWwuaXNLaW5kKCdtcm93JykpIHtcbiAgICAgICAgICAgICAgICBtbWwucGFyZW50LnJlcGxhY2VDaGlsZChtbWwuY2hpbGROb2Rlc1swXSwgbW1sKTtcbiAgICAgICAgICAgICAgICBkYXRhLnJlbW92ZUZyb21MaXN0KCdtcm93JywgW21tbF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9iID0gX2MucmV0dXJuKSkgX2IuY2FsbChfYyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfVxuICAgIH1cbn1cbnZhciBCYXNlVGFncyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJhc2VUYWdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJhc2VUYWdzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBCYXNlVGFncztcbn0oVGFnc19qc18xLkFic3RyYWN0VGFncykpO1xuZXhwb3J0cy5CYXNlVGFncyA9IEJhc2VUYWdzO1xuZXhwb3J0cy5CYXNlQ29uZmlndXJhdGlvbiA9IENvbmZpZ3VyYXRpb25fanNfMS5Db25maWd1cmF0aW9uLmNyZWF0ZSgnYmFzZScsIHtcbiAgICBoYW5kbGVyOiB7XG4gICAgICAgIGNoYXJhY3RlcjogWydjb21tYW5kJywgJ3NwZWNpYWwnLCAnbGV0dGVyJywgJ2RpZ2l0J10sXG4gICAgICAgIGRlbGltaXRlcjogWydkZWxpbWl0ZXInXSxcbiAgICAgICAgbWFjcm86IFsnZGVsaW1pdGVyJywgJ21hY3JvcycsICdtYXRoY2hhcjBtaScsICdtYXRoY2hhcjBtbycsICdtYXRoY2hhcjcnXSxcbiAgICAgICAgZW52aXJvbm1lbnQ6IFsnZW52aXJvbm1lbnQnXVxuICAgIH0sXG4gICAgZmFsbGJhY2s6IHtcbiAgICAgICAgY2hhcmFjdGVyOiBPdGhlcixcbiAgICAgICAgbWFjcm86IGNzVW5kZWZpbmVkLFxuICAgICAgICBlbnZpcm9ubWVudDogZW52VW5kZWZpbmVkXG4gICAgfSxcbiAgICBpdGVtczogKF9hID0ge30sXG4gICAgICAgIF9hW2JpdGVtLlN0YXJ0SXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5TdGFydEl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLlN0b3BJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLlN0b3BJdGVtLFxuICAgICAgICBfYVtiaXRlbS5PcGVuSXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5PcGVuSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uQ2xvc2VJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLkNsb3NlSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uUHJpbWVJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLlByaW1lSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uU3Vic3VwSXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5TdWJzdXBJdGVtLFxuICAgICAgICBfYVtiaXRlbS5PdmVySXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5PdmVySXRlbSxcbiAgICAgICAgX2FbYml0ZW0uTGVmdEl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uTGVmdEl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLk1pZGRsZS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5NaWRkbGUsXG4gICAgICAgIF9hW2JpdGVtLlJpZ2h0SXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5SaWdodEl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLkJlZ2luSXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5CZWdpbkl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLkVuZEl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uRW5kSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uU3R5bGVJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLlN0eWxlSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uUG9zaXRpb25JdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLlBvc2l0aW9uSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uQ2VsbEl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uQ2VsbEl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLk1tbEl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uTW1sSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uRm5JdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLkZuSXRlbSxcbiAgICAgICAgX2FbYml0ZW0uTm90SXRlbS5wcm90b3R5cGUua2luZF0gPSBiaXRlbS5Ob3RJdGVtLFxuICAgICAgICBfYVtiaXRlbS5Ob25zY3JpcHRJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLk5vbnNjcmlwdEl0ZW0sXG4gICAgICAgIF9hW2JpdGVtLkRvdHNJdGVtLnByb3RvdHlwZS5raW5kXSA9IGJpdGVtLkRvdHNJdGVtLFxuICAgICAgICBfYVtiaXRlbS5BcnJheUl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uQXJyYXlJdGVtLFxuICAgICAgICBfYVtiaXRlbS5FcW5BcnJheUl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uRXFuQXJyYXlJdGVtLFxuICAgICAgICBfYVtiaXRlbS5FcXVhdGlvbkl0ZW0ucHJvdG90eXBlLmtpbmRdID0gYml0ZW0uRXF1YXRpb25JdGVtLFxuICAgICAgICBfYSksXG4gICAgb3B0aW9uczoge1xuICAgICAgICBtYXhNYWNyb3M6IDEwMDAsXG4gICAgICAgIGJhc2VVUkw6ICh0eXBlb2YgKGRvY3VtZW50KSA9PT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdiYXNlJykubGVuZ3RoID09PSAwKSA/XG4gICAgICAgICAgICAnJyA6IFN0cmluZyhkb2N1bWVudC5sb2NhdGlvbikucmVwbGFjZSgvIy4qJC8sICcnKVxuICAgIH0sXG4gICAgdGFnczoge1xuICAgICAgICBiYXNlOiBCYXNlVGFnc1xuICAgIH0sXG4gICAgcG9zdHByb2Nlc3NvcnM6IFtbZmlsdGVyTm9uc2NyaXB0LCAtNF1dXG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUJhc2VDb25maWd1cmF0aW9uLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX3JlYWQgPSAodGhpcyAmJiB0aGlzLl9fcmVhZCkgfHwgZnVuY3Rpb24gKG8sIG4pIHtcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XG4gICAgaWYgKCFtKSByZXR1cm4gbztcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgICB0cnkge1xuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIGFyO1xufTtcbnZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbnZhciBfX2ltcG9ydERlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0RGVmYXVsdCkgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgXCJkZWZhdWx0XCI6IG1vZCB9O1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuRXF1YXRpb25JdGVtID0gZXhwb3J0cy5FcW5BcnJheUl0ZW0gPSBleHBvcnRzLkFycmF5SXRlbSA9IGV4cG9ydHMuRG90c0l0ZW0gPSBleHBvcnRzLk5vbnNjcmlwdEl0ZW0gPSBleHBvcnRzLk5vdEl0ZW0gPSBleHBvcnRzLkZuSXRlbSA9IGV4cG9ydHMuTW1sSXRlbSA9IGV4cG9ydHMuQ2VsbEl0ZW0gPSBleHBvcnRzLlBvc2l0aW9uSXRlbSA9IGV4cG9ydHMuU3R5bGVJdGVtID0gZXhwb3J0cy5FbmRJdGVtID0gZXhwb3J0cy5CZWdpbkl0ZW0gPSBleHBvcnRzLlJpZ2h0SXRlbSA9IGV4cG9ydHMuTWlkZGxlID0gZXhwb3J0cy5MZWZ0SXRlbSA9IGV4cG9ydHMuT3Zlckl0ZW0gPSBleHBvcnRzLlN1YnN1cEl0ZW0gPSBleHBvcnRzLlByaW1lSXRlbSA9IGV4cG9ydHMuQ2xvc2VJdGVtID0gZXhwb3J0cy5PcGVuSXRlbSA9IGV4cG9ydHMuU3RvcEl0ZW0gPSBleHBvcnRzLlN0YXJ0SXRlbSA9IHZvaWQgMDtcbnZhciBNYXBIYW5kbGVyX2pzXzEgPSByZXF1aXJlKFwiLi4vTWFwSGFuZGxlci5qc1wiKTtcbnZhciBFbnRpdGllc19qc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWwvRW50aXRpZXMuanNcIik7XG52YXIgTW1sTm9kZV9qc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NvcmUvTW1sVHJlZS9NbWxOb2RlLmpzXCIpO1xudmFyIFRleEVycm9yX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL1RleEVycm9yLmpzXCIpKTtcbnZhciBQYXJzZVV0aWxfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vUGFyc2VVdGlsLmpzXCIpKTtcbnZhciBOb2RlVXRpbF9qc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9Ob2RlVXRpbC5qc1wiKSk7XG52YXIgU3RhY2tJdGVtX2pzXzEgPSByZXF1aXJlKFwiLi4vU3RhY2tJdGVtLmpzXCIpO1xudmFyIFN0YXJ0SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0YXJ0SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdGFydEl0ZW0oZmFjdG9yeSwgZ2xvYmFsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZhY3RvcnkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmdsb2JhbCA9IGdsb2JhbDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RhcnRJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3N0YXJ0JztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdGFydEl0ZW0ucHJvdG90eXBlLCBcImlzT3BlblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdGFydEl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnc3RvcCcpKSB7XG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMudG9NbWwoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5nbG9iYWwuaXNJbm5lcikge1xuICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzLmZhY3RvcnkuY29uZmlndXJhdGlvbi50YWdzLmZpbmFsaXplKG5vZGUsIHRoaXMuZW52KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbW3RoaXMuZmFjdG9yeS5jcmVhdGUoJ21tbCcsIG5vZGUpXSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuY2hlY2tJdGVtLmNhbGwodGhpcywgaXRlbSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3RhcnRJdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5TdGFydEl0ZW0gPSBTdGFydEl0ZW07XG52YXIgU3RvcEl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdG9wSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdG9wSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RvcEl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnc3RvcCc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RvcEl0ZW0ucHJvdG90eXBlLCBcImlzQ2xvc2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFN0b3BJdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5TdG9wSXRlbSA9IFN0b3BJdGVtO1xudmFyIE9wZW5JdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoT3Blbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gT3Blbkl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9wZW5JdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ29wZW4nO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9wZW5JdGVtLnByb3RvdHlwZSwgXCJpc09wZW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT3Blbkl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnY2xvc2UnKSkge1xuICAgICAgICAgICAgdmFyIG1tbCA9IHRoaXMudG9NbWwoKTtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5jcmVhdGUoJ25vZGUnLCAnVGVYQXRvbScsIFttbWxdKTtcbiAgICAgICAgICAgIHJldHVybiBbW3RoaXMuZmFjdG9yeS5jcmVhdGUoJ21tbCcsIG5vZGUpXSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuY2hlY2tJdGVtLmNhbGwodGhpcywgaXRlbSk7XG4gICAgfTtcbiAgICBPcGVuSXRlbS5lcnJvcnMgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0uZXJyb3JzKSwge1xuICAgICAgICAnc3RvcCc6IFsnRXh0cmFPcGVuTWlzc2luZ0Nsb3NlJyxcbiAgICAgICAgICAgICdFeHRyYSBvcGVuIGJyYWNlIG9yIG1pc3NpbmcgY2xvc2UgYnJhY2UnXVxuICAgIH0pO1xuICAgIHJldHVybiBPcGVuSXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuT3Blbkl0ZW0gPSBPcGVuSXRlbTtcbnZhciBDbG9zZUl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDbG9zZUl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ2xvc2VJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDbG9zZUl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnY2xvc2UnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENsb3NlSXRlbS5wcm90b3R5cGUsIFwiaXNDbG9zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gQ2xvc2VJdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5DbG9zZUl0ZW0gPSBDbG9zZUl0ZW07XG52YXIgUHJpbWVJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHJpbWVJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFByaW1lSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJpbWVJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3ByaW1lJztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFByaW1lSXRlbS5wcm90b3R5cGUuY2hlY2tJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIF9hID0gX19yZWFkKHRoaXMuUGVlaygyKSwgMiksIHRvcDAgPSBfYVswXSwgdG9wMSA9IF9hWzFdO1xuICAgICAgICBpZiAoIU5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUodG9wMCwgJ21zdWJzdXAnKSB8fCBOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKHRvcDAsICdtc3VwJykpIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5jcmVhdGUoJ25vZGUnLCAnbXN1cCcsIFt0b3AwLCB0b3AxXSk7XG4gICAgICAgICAgICByZXR1cm4gW1tub2RlLCBpdGVtXSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldENoaWxkKHRvcDAsIHRvcDAuc3VwLCB0b3AxKTtcbiAgICAgICAgcmV0dXJuIFtbdG9wMCwgaXRlbV0sIHRydWVdO1xuICAgIH07XG4gICAgcmV0dXJuIFByaW1lSXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuUHJpbWVJdGVtID0gUHJpbWVJdGVtO1xudmFyIFN1YnN1cEl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdWJzdXBJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1YnN1cEl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1YnN1cEl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnc3Vic3VwJztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1YnN1cEl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnb3BlbicpIHx8IGl0ZW0uaXNLaW5kKCdsZWZ0JykpIHtcbiAgICAgICAgICAgIHJldHVybiBTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5zdWNjZXNzO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0b3AgPSB0aGlzLkZpcnN0O1xuICAgICAgICB2YXIgcG9zaXRpb24gPSB0aGlzLmdldFByb3BlcnR5KCdwb3NpdGlvbicpO1xuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ21tbCcpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRQcm9wZXJ0eSgncHJpbWVzJykpIHtcbiAgICAgICAgICAgICAgICBpZiAocG9zaXRpb24gIT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldENoaWxkKHRvcCwgMiwgdGhpcy5nZXRQcm9wZXJ0eSgncHJpbWVzJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldFByb3BlcnR5KHRoaXMuZ2V0UHJvcGVydHkoJ3ByaW1lcycpLCAndmFyaWFudEZvcm0nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtcm93JywgW3RoaXMuZ2V0UHJvcGVydHkoJ3ByaW1lcycpLCBpdGVtLkZpcnN0XSk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uRmlyc3QgPSBub2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRDaGlsZCh0b3AsIHBvc2l0aW9uLCBpdGVtLkZpcnN0KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldFByb3BlcnR5KCdtb3Zlc3Vwc3ViJykgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRQcm9wZXJ0eSh0b3AsICdtb3Zlc3Vwc3ViJywgdGhpcy5nZXRQcm9wZXJ0eSgnbW92ZXN1cHN1YicpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmZhY3RvcnkuY3JlYXRlKCdtbWwnLCB0b3ApO1xuICAgICAgICAgICAgcmV0dXJuIFtbcmVzdWx0XSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKF9zdXBlci5wcm90b3R5cGUuY2hlY2tJdGVtLmNhbGwodGhpcywgaXRlbSlbMV0pIHtcbiAgICAgICAgICAgIHZhciBlcnJvciA9IHRoaXMuZ2V0RXJyb3JzKFsnJywgJ3N1YicsICdzdXAnXVtwb3NpdGlvbl0pO1xuICAgICAgICAgICAgdGhyb3cgbmV3IChUZXhFcnJvcl9qc18xLmRlZmF1bHQuYmluZC5hcHBseShUZXhFcnJvcl9qc18xLmRlZmF1bHQsIF9fc3ByZWFkQXJyYXkoW3ZvaWQgMCwgZXJyb3JbMF0sIGVycm9yWzFdXSwgX19yZWFkKGVycm9yLnNwbGljZSgyKSksIGZhbHNlKSkpKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTdWJzdXBJdGVtLmVycm9ycyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5lcnJvcnMpLCB7XG4gICAgICAgICdzdG9wJzogWydNaXNzaW5nU2NyaXB0JyxcbiAgICAgICAgICAgICdNaXNzaW5nIHN1cGVyc2NyaXB0IG9yIHN1YnNjcmlwdCBhcmd1bWVudCddLFxuICAgICAgICAnc3VwJzogWydNaXNzaW5nT3BlbkZvclN1cCcsXG4gICAgICAgICAgICAnTWlzc2luZyBvcGVuIGJyYWNlIGZvciBzdXBlcnNjcmlwdCddLFxuICAgICAgICAnc3ViJzogWydNaXNzaW5nT3BlbkZvclN1YicsXG4gICAgICAgICAgICAnTWlzc2luZyBvcGVuIGJyYWNlIGZvciBzdWJzY3JpcHQnXVxuICAgIH0pO1xuICAgIHJldHVybiBTdWJzdXBJdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5TdWJzdXBJdGVtID0gU3Vic3VwSXRlbTtcbnZhciBPdmVySXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE92ZXJJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE92ZXJJdGVtKGZhY3RvcnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZmFjdG9yeSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2V0UHJvcGVydHkoJ25hbWUnLCAnXFxcXG92ZXInKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT3Zlckl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnb3Zlcic7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT3Zlckl0ZW0ucHJvdG90eXBlLCBcImlzQ2xvc2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT3Zlckl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnb3ZlcicpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdBbWJpZ3VvdXNVc2VPZicsICdBbWJpZ3VvdXMgdXNlIG9mICUxJywgaXRlbS5nZXROYW1lKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmlzQ2xvc2UpIHtcbiAgICAgICAgICAgIHZhciBtbWwgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtZnJhYycsIFt0aGlzLmdldFByb3BlcnR5KCdudW0nKSwgdGhpcy50b01tbChmYWxzZSldKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldFByb3BlcnR5KCd0aGlja25lc3MnKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShtbWwsICdsaW5ldGhpY2tuZXNzJywgdGhpcy5nZXRQcm9wZXJ0eSgndGhpY2tuZXNzJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0UHJvcGVydHkoJ29wZW4nKSB8fCB0aGlzLmdldFByb3BlcnR5KCdjbG9zZScpKSB7XG4gICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldFByb3BlcnR5KG1tbCwgJ3dpdGhEZWxpbXMnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICBtbWwgPSBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmZpeGVkRmVuY2UodGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24sIHRoaXMuZ2V0UHJvcGVydHkoJ29wZW4nKSwgbW1sLCB0aGlzLmdldFByb3BlcnR5KCdjbG9zZScpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbW3RoaXMuZmFjdG9yeS5jcmVhdGUoJ21tbCcsIG1tbCksIGl0ZW1dLCB0cnVlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jaGVja0l0ZW0uY2FsbCh0aGlzLCBpdGVtKTtcbiAgICB9O1xuICAgIE92ZXJJdGVtLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICdvdmVyWycgKyB0aGlzLmdldFByb3BlcnR5KCdudW0nKSArXG4gICAgICAgICAgICAnIC8gJyArIHRoaXMubm9kZXMuam9pbignOyAnKSArICddJztcbiAgICB9O1xuICAgIHJldHVybiBPdmVySXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuT3Zlckl0ZW0gPSBPdmVySXRlbTtcbnZhciBMZWZ0SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExlZnRJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExlZnRJdGVtKGZhY3RvcnksIGRlbGltKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZhY3RvcnkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNldFByb3BlcnR5KCdkZWxpbScsIGRlbGltKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGVmdEl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnbGVmdCc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGVmdEl0ZW0ucHJvdG90eXBlLCBcImlzT3BlblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMZWZ0SXRlbS5wcm90b3R5cGUuY2hlY2tJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uaXNLaW5kKCdyaWdodCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gW1t0aGlzLmZhY3RvcnkuY3JlYXRlKCdtbWwnLCBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmZlbmNlZCh0aGlzLmZhY3RvcnkuY29uZmlndXJhdGlvbiwgdGhpcy5nZXRQcm9wZXJ0eSgnZGVsaW0nKSwgdGhpcy50b01tbCgpLCBpdGVtLmdldFByb3BlcnR5KCdkZWxpbScpLCAnJywgaXRlbS5nZXRQcm9wZXJ0eSgnY29sb3InKSkpXSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0uaXNLaW5kKCdtaWRkbGUnKSkge1xuICAgICAgICAgICAgdmFyIGRlZiA9IHsgc3RyZXRjaHk6IHRydWUgfTtcbiAgICAgICAgICAgIGlmIChpdGVtLmdldFByb3BlcnR5KCdjb2xvcicpKSB7XG4gICAgICAgICAgICAgICAgZGVmLm1hdGhjb2xvciA9IGl0ZW0uZ2V0UHJvcGVydHkoJ2NvbG9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLlB1c2godGhpcy5jcmVhdGUoJ25vZGUnLCAnVGVYQXRvbScsIFtdLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuQ0xPU0UgfSksIHRoaXMuY3JlYXRlKCd0b2tlbicsICdtbycsIGRlZiwgaXRlbS5nZXRQcm9wZXJ0eSgnZGVsaW0nKSksIHRoaXMuY3JlYXRlKCdub2RlJywgJ1RlWEF0b20nLCBbXSwgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QRU4gfSkpO1xuICAgICAgICAgICAgdGhpcy5lbnYgPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBbW3RoaXNdLCB0cnVlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jaGVja0l0ZW0uY2FsbCh0aGlzLCBpdGVtKTtcbiAgICB9O1xuICAgIExlZnRJdGVtLmVycm9ycyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5lcnJvcnMpLCB7XG4gICAgICAgICdzdG9wJzogWydFeHRyYUxlZnRNaXNzaW5nUmlnaHQnLFxuICAgICAgICAgICAgJ0V4dHJhIFxcXFxsZWZ0IG9yIG1pc3NpbmcgXFxcXHJpZ2h0J11cbiAgICB9KTtcbiAgICByZXR1cm4gTGVmdEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLkxlZnRJdGVtID0gTGVmdEl0ZW07XG52YXIgTWlkZGxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTWlkZGxlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE1pZGRsZShmYWN0b3J5LCBkZWxpbSwgY29sb3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZmFjdG9yeSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2V0UHJvcGVydHkoJ2RlbGltJywgZGVsaW0pO1xuICAgICAgICBjb2xvciAmJiBfdGhpcy5zZXRQcm9wZXJ0eSgnY29sb3InLCBjb2xvcik7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1pZGRsZS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdtaWRkbGUnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1pZGRsZS5wcm90b3R5cGUsIFwiaXNDbG9zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gTWlkZGxlO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5NaWRkbGUgPSBNaWRkbGU7XG52YXIgUmlnaHRJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUmlnaHRJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJpZ2h0SXRlbShmYWN0b3J5LCBkZWxpbSwgY29sb3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZmFjdG9yeSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2V0UHJvcGVydHkoJ2RlbGltJywgZGVsaW0pO1xuICAgICAgICBjb2xvciAmJiBfdGhpcy5zZXRQcm9wZXJ0eSgnY29sb3InLCBjb2xvcik7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJpZ2h0SXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdyaWdodCc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmlnaHRJdGVtLnByb3RvdHlwZSwgXCJpc0Nsb3NlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBSaWdodEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLlJpZ2h0SXRlbSA9IFJpZ2h0SXRlbTtcbnZhciBCZWdpbkl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhCZWdpbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQmVnaW5JdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCZWdpbkl0ZW0ucHJvdG90eXBlLCBcImtpbmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnYmVnaW4nO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJlZ2luSXRlbS5wcm90b3R5cGUsIFwiaXNPcGVuXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJlZ2luSXRlbS5wcm90b3R5cGUuY2hlY2tJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uaXNLaW5kKCdlbmQnKSkge1xuICAgICAgICAgICAgaWYgKGl0ZW0uZ2V0TmFtZSgpICE9PSB0aGlzLmdldE5hbWUoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ0VudkJhZEVuZCcsICdcXFxcYmVnaW57JTF9IGVuZGVkIHdpdGggXFxcXGVuZHslMn0nLCB0aGlzLmdldE5hbWUoKSwgaXRlbS5nZXROYW1lKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmdldFByb3BlcnR5KCdlbmQnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbW3RoaXMuZmFjdG9yeS5jcmVhdGUoJ21tbCcsIHRoaXMudG9NbWwoKSldLCB0cnVlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5mYWlsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnc3RvcCcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdFbnZNaXNzaW5nRW5kJywgJ01pc3NpbmcgXFxcXGVuZHslMX0nLCB0aGlzLmdldE5hbWUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuY2hlY2tJdGVtLmNhbGwodGhpcywgaXRlbSk7XG4gICAgfTtcbiAgICByZXR1cm4gQmVnaW5JdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5CZWdpbkl0ZW0gPSBCZWdpbkl0ZW07XG52YXIgRW5kSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEVuZEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRW5kSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRW5kSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdlbmQnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVuZEl0ZW0ucHJvdG90eXBlLCBcImlzQ2xvc2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEVuZEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLkVuZEl0ZW0gPSBFbmRJdGVtO1xudmFyIFN0eWxlSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0eWxlSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdHlsZUl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0eWxlSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdzdHlsZSc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdHlsZUl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmICghaXRlbS5pc0Nsb3NlKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jaGVja0l0ZW0uY2FsbCh0aGlzLCBpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbW1sID0gdGhpcy5jcmVhdGUoJ25vZGUnLCAnbXN0eWxlJywgdGhpcy5ub2RlcywgdGhpcy5nZXRQcm9wZXJ0eSgnc3R5bGVzJykpO1xuICAgICAgICByZXR1cm4gW1t0aGlzLmZhY3RvcnkuY3JlYXRlKCdtbWwnLCBtbWwpLCBpdGVtXSwgdHJ1ZV07XG4gICAgfTtcbiAgICByZXR1cm4gU3R5bGVJdGVtO1xufShTdGFja0l0ZW1fanNfMS5CYXNlSXRlbSkpO1xuZXhwb3J0cy5TdHlsZUl0ZW0gPSBTdHlsZUl0ZW07XG52YXIgUG9zaXRpb25JdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUG9zaXRpb25JdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBvc2l0aW9uSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUG9zaXRpb25JdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3Bvc2l0aW9uJztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFBvc2l0aW9uSXRlbS5wcm90b3R5cGUuY2hlY2tJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uaXNDbG9zZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnTWlzc2luZ0JveEZvcicsICdNaXNzaW5nIGJveCBmb3IgJTEnLCB0aGlzLmdldE5hbWUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0uaXNGaW5hbCkge1xuICAgICAgICAgICAgdmFyIG1tbCA9IGl0ZW0udG9NbWwoKTtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5nZXRQcm9wZXJ0eSgnbW92ZScpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAndmVydGljYWwnOlxuICAgICAgICAgICAgICAgICAgICBtbWwgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtcGFkZGVkJywgW21tbF0sIHsgaGVpZ2h0OiB0aGlzLmdldFByb3BlcnR5KCdkaCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwdGg6IHRoaXMuZ2V0UHJvcGVydHkoJ2RkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICB2b2Zmc2V0OiB0aGlzLmdldFByb3BlcnR5KCdkaCcpIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1t0aGlzLmZhY3RvcnkuY3JlYXRlKCdtbWwnLCBtbWwpXSwgdHJ1ZV07XG4gICAgICAgICAgICAgICAgY2FzZSAnaG9yaXpvbnRhbCc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbW3RoaXMuZmFjdG9yeS5jcmVhdGUoJ21tbCcsIHRoaXMuZ2V0UHJvcGVydHkoJ2xlZnQnKSksIGl0ZW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mYWN0b3J5LmNyZWF0ZSgnbW1sJywgdGhpcy5nZXRQcm9wZXJ0eSgncmlnaHQnKSldLCB0cnVlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jaGVja0l0ZW0uY2FsbCh0aGlzLCBpdGVtKTtcbiAgICB9O1xuICAgIHJldHVybiBQb3NpdGlvbkl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLlBvc2l0aW9uSXRlbSA9IFBvc2l0aW9uSXRlbTtcbnZhciBDZWxsSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENlbGxJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENlbGxJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDZWxsSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdjZWxsJztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDZWxsSXRlbS5wcm90b3R5cGUsIFwiaXNDbG9zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gQ2VsbEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLkNlbGxJdGVtID0gQ2VsbEl0ZW07XG52YXIgTW1sSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE1tbEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTW1sSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTW1sSXRlbS5wcm90b3R5cGUsIFwiaXNGaW5hbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTW1sSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdtbWwnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIE1tbEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLk1tbEl0ZW0gPSBNbWxJdGVtO1xudmFyIEZuSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZuSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGbkl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZuSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdmbic7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGbkl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciB0b3AgPSB0aGlzLkZpcnN0O1xuICAgICAgICBpZiAodG9wKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5pc09wZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0uc3VjY2VzcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXRlbS5pc0tpbmQoJ2ZuJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgbW1sID0gaXRlbS5GaXJzdDtcbiAgICAgICAgICAgICAgICBpZiAoIWl0ZW0uaXNLaW5kKCdtbWwnKSB8fCAhbW1sKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbW3RvcCwgaXRlbV0sIHRydWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUobW1sLCAnbXN0eWxlJykgJiYgbW1sLmNoaWxkTm9kZXMubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUobW1sLmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlc1swXSwgJ21zcGFjZScpKSB8fFxuICAgICAgICAgICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKG1tbCwgJ21zcGFjZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbW3RvcCwgaXRlbV0sIHRydWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzRW1iZWxsaXNoZWQobW1sKSkge1xuICAgICAgICAgICAgICAgICAgICBtbWwgPSBOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q29yZU1PKG1tbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBmb3JtID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldEZvcm0obW1sKTtcbiAgICAgICAgICAgICAgICBpZiAoZm9ybSAhPSBudWxsICYmIFswLCAwLCAxLCAxLCAwLCAxLCAxLCAwLCAwLCAwXVtmb3JtWzJdXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW1t0b3AsIGl0ZW1dLCB0cnVlXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMuY3JlYXRlKCd0b2tlbicsICdtbycsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5OT05FIH0sIEVudGl0aWVzX2pzXzEuZW50aXRpZXMuQXBwbHlGdW5jdGlvbik7XG4gICAgICAgICAgICByZXR1cm4gW1t0b3AsIG5vZGUsIGl0ZW1dLCB0cnVlXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jaGVja0l0ZW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICAgIHJldHVybiBGbkl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLkZuSXRlbSA9IEZuSXRlbTtcbnZhciBOb3RJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTm90SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb3RJdGVtKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucmVtYXAgPSBNYXBIYW5kbGVyX2pzXzEuTWFwSGFuZGxlci5nZXRNYXAoJ25vdF9yZW1hcCcpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ25vdCc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBOb3RJdGVtLnByb3RvdHlwZS5jaGVja0l0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgbW1sO1xuICAgICAgICB2YXIgYztcbiAgICAgICAgdmFyIHRleHROb2RlO1xuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ29wZW4nKSB8fCBpdGVtLmlzS2luZCgnbGVmdCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0uc3VjY2VzcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ21tbCcpICYmXG4gICAgICAgICAgICAoTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShpdGVtLkZpcnN0LCAnbW8nKSB8fCBOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGl0ZW0uRmlyc3QsICdtaScpIHx8XG4gICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShpdGVtLkZpcnN0LCAnbXRleHQnKSkpIHtcbiAgICAgICAgICAgIG1tbCA9IGl0ZW0uRmlyc3Q7XG4gICAgICAgICAgICBjID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldFRleHQobW1sKTtcbiAgICAgICAgICAgIGlmIChjLmxlbmd0aCA9PT0gMSAmJiAhTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldFByb3BlcnR5KG1tbCwgJ21vdmVzdXBzdWInKSAmJlxuICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZHJlbihtbWwpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJlbWFwLmNvbnRhaW5zKGMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHROb2RlID0gdGhpcy5jcmVhdGUoJ3RleHQnLCB0aGlzLnJlbWFwLmxvb2t1cChjKS5jaGFyKTtcbiAgICAgICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldENoaWxkKG1tbCwgMCwgdGV4dE5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dE5vZGUgPSB0aGlzLmNyZWF0ZSgndGV4dCcsICdcXHUwMzM4Jyk7XG4gICAgICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5hcHBlbmRDaGlsZHJlbihtbWwsIFt0ZXh0Tm9kZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gW1tpdGVtXSwgdHJ1ZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGV4dE5vZGUgPSB0aGlzLmNyZWF0ZSgndGV4dCcsICdcXHUyOUY4Jyk7XG4gICAgICAgIHZhciBtdGV4dE5vZGUgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtdGV4dCcsIFtdLCB7fSwgdGV4dE5vZGUpO1xuICAgICAgICB2YXIgcGFkZGVkTm9kZSA9IHRoaXMuY3JlYXRlKCdub2RlJywgJ21wYWRkZWQnLCBbbXRleHROb2RlXSwgeyB3aWR0aDogMCB9KTtcbiAgICAgICAgbW1sID0gdGhpcy5jcmVhdGUoJ25vZGUnLCAnVGVYQXRvbScsIFtwYWRkZWROb2RlXSwgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLlJFTCB9KTtcbiAgICAgICAgcmV0dXJuIFtbbW1sLCBpdGVtXSwgdHJ1ZV07XG4gICAgfTtcbiAgICByZXR1cm4gTm90SXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuTm90SXRlbSA9IE5vdEl0ZW07XG52YXIgTm9uc2NyaXB0SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE5vbnNjcmlwdEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTm9uc2NyaXB0SXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTm9uc2NyaXB0SXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdub25zY3JpcHQnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTm9uc2NyaXB0SXRlbS5wcm90b3R5cGUuY2hlY2tJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0uaXNLaW5kKCdtbWwnKSAmJiBpdGVtLlNpemUoKSA9PT0gMSkge1xuICAgICAgICAgICAgdmFyIG1tbCA9IGl0ZW0uRmlyc3Q7XG4gICAgICAgICAgICBpZiAobW1sLmlzS2luZCgnbXN0eWxlJykgJiYgbW1sLm5vdFBhcmVudCkge1xuICAgICAgICAgICAgICAgIG1tbCA9IE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZHJlbihOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q2hpbGRyZW4obW1sKVswXSlbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW1sLmlzS2luZCgnbXNwYWNlJykpIHtcbiAgICAgICAgICAgICAgICBpZiAobW1sICE9PSBpdGVtLkZpcnN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtcm93ID0gdGhpcy5jcmVhdGUoJ25vZGUnLCAnbXJvdycsIFtpdGVtLlBvcCgpXSk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uUHVzaChtcm93KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24uYWRkTm9kZSgnbm9uc2NyaXB0JywgaXRlbS5GaXJzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtbaXRlbV0sIHRydWVdO1xuICAgIH07XG4gICAgcmV0dXJuIE5vbnNjcmlwdEl0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLk5vbnNjcmlwdEl0ZW0gPSBOb25zY3JpcHRJdGVtO1xudmFyIERvdHNJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRG90c0l0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRG90c0l0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvdHNJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2RvdHMnO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRG90c0l0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnb3BlbicpIHx8IGl0ZW0uaXNLaW5kKCdsZWZ0JykpIHtcbiAgICAgICAgICAgIHJldHVybiBTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5zdWNjZXNzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkb3RzID0gdGhpcy5nZXRQcm9wZXJ0eSgnbGRvdHMnKTtcbiAgICAgICAgdmFyIHRvcCA9IGl0ZW0uRmlyc3Q7XG4gICAgICAgIGlmIChpdGVtLmlzS2luZCgnbW1sJykgJiYgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzRW1iZWxsaXNoZWQodG9wKSkge1xuICAgICAgICAgICAgdmFyIHRjbGFzcyA9IE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRUZXhDbGFzcyhOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q29yZU1PKHRvcCkpO1xuICAgICAgICAgICAgaWYgKHRjbGFzcyA9PT0gTW1sTm9kZV9qc18xLlRFWENMQVNTLkJJTiB8fCB0Y2xhc3MgPT09IE1tbE5vZGVfanNfMS5URVhDTEFTUy5SRUwpIHtcbiAgICAgICAgICAgICAgICBkb3RzID0gdGhpcy5nZXRQcm9wZXJ0eSgnY2RvdHMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1tkb3RzLCBpdGVtXSwgdHJ1ZV07XG4gICAgfTtcbiAgICByZXR1cm4gRG90c0l0ZW07XG59KFN0YWNrSXRlbV9qc18xLkJhc2VJdGVtKSk7XG5leHBvcnRzLkRvdHNJdGVtID0gRG90c0l0ZW07XG52YXIgQXJyYXlJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQXJyYXlJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFycmF5SXRlbSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnRhYmxlID0gW107XG4gICAgICAgIF90aGlzLnJvdyA9IFtdO1xuICAgICAgICBfdGhpcy5mcmFtZSA9IFtdO1xuICAgICAgICBfdGhpcy5oZmlsbCA9IFtdO1xuICAgICAgICBfdGhpcy5hcnJheWRlZiA9IHt9O1xuICAgICAgICBfdGhpcy5kYXNoZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2FycmF5JztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheUl0ZW0ucHJvdG90eXBlLCBcImlzT3BlblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJdGVtLnByb3RvdHlwZSwgXCJjb3B5RW52XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBcnJheUl0ZW0ucHJvdG90eXBlLmNoZWNrSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmIChpdGVtLmlzQ2xvc2UgJiYgIWl0ZW0uaXNLaW5kKCdvdmVyJykpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLmdldFByb3BlcnR5KCdpc0VudHJ5JykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLkVuZEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckVudigpO1xuICAgICAgICAgICAgICAgIHJldHVybiBTdGFja0l0ZW1fanNfMS5CYXNlSXRlbS5mYWlsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGl0ZW0uZ2V0UHJvcGVydHkoJ2lzQ1InKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRW5kRW50cnkoKTtcbiAgICAgICAgICAgICAgICB0aGlzLkVuZFJvdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJFbnYoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0uZmFpbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuRW5kVGFibGUoKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJFbnYoKTtcbiAgICAgICAgICAgIHZhciBuZXdJdGVtID0gdGhpcy5mYWN0b3J5LmNyZWF0ZSgnbW1sJywgdGhpcy5jcmVhdGVNbWwoKSk7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRQcm9wZXJ0eSgncmVxdWlyZUNsb3NlJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ2Nsb3NlJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtbbmV3SXRlbV0sIHRydWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdNaXNzaW5nQ2xvc2VCcmFjZScsICdNaXNzaW5nIGNsb3NlIGJyYWNlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW1tuZXdJdGVtLCBpdGVtXSwgdHJ1ZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuY2hlY2tJdGVtLmNhbGwodGhpcywgaXRlbSk7XG4gICAgfTtcbiAgICBBcnJheUl0ZW0ucHJvdG90eXBlLmNyZWF0ZU1tbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNjcmlwdGxldmVsID0gdGhpcy5hcnJheWRlZlsnc2NyaXB0bGV2ZWwnXTtcbiAgICAgICAgZGVsZXRlIHRoaXMuYXJyYXlkZWZbJ3NjcmlwdGxldmVsJ107XG4gICAgICAgIHZhciBtbWwgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtdGFibGUnLCB0aGlzLnRhYmxlLCB0aGlzLmFycmF5ZGVmKTtcbiAgICAgICAgaWYgKHNjcmlwdGxldmVsKSB7XG4gICAgICAgICAgICBtbWwuc2V0UHJvcGVydHkoJ3NjcmlwdGxldmVsJywgc2NyaXB0bGV2ZWwpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZyYW1lLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShtbWwsICdmcmFtZScsIHRoaXMuZGFzaGVkID8gJ2Rhc2hlZCcgOiAnc29saWQnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmZyYW1lLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYXJyYXlkZWZbJ3Jvd2xpbmVzJ10pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFycmF5ZGVmWydyb3dsaW5lcyddID1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcnJheWRlZlsncm93bGluZXMnXS5yZXBsYWNlKC9ub25lKCBub25lKSskLywgJ25vbmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUobW1sLCAnZnJhbWUnLCAnJyk7XG4gICAgICAgICAgICBtbWwgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtZW5jbG9zZScsIFttbWxdLCB7IG5vdGF0aW9uOiB0aGlzLmZyYW1lLmpvaW4oJyAnKSB9KTtcbiAgICAgICAgICAgIGlmICgodGhpcy5hcnJheWRlZlsnY29sdW1ubGluZXMnXSB8fCAnbm9uZScpICE9PSAnbm9uZScgfHxcbiAgICAgICAgICAgICAgICAodGhpcy5hcnJheWRlZlsncm93bGluZXMnXSB8fCAnbm9uZScpICE9PSAnbm9uZScpIHtcbiAgICAgICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKG1tbCwgJ2RhdGEtcGFkZGluZycsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmdldFByb3BlcnR5KCdvcGVuJykgfHwgdGhpcy5nZXRQcm9wZXJ0eSgnY2xvc2UnKSkge1xuICAgICAgICAgICAgbW1sID0gUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5mZW5jZWQodGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24sIHRoaXMuZ2V0UHJvcGVydHkoJ29wZW4nKSwgbW1sLCB0aGlzLmdldFByb3BlcnR5KCdjbG9zZScpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbW1sO1xuICAgIH07XG4gICAgQXJyYXlJdGVtLnByb3RvdHlwZS5FbmRFbnRyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG10ZCA9IHRoaXMuY3JlYXRlKCdub2RlJywgJ210ZCcsIHRoaXMubm9kZXMpO1xuICAgICAgICBpZiAodGhpcy5oZmlsbC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhmaWxsWzBdID09PSAwKSB7XG4gICAgICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShtdGQsICdjb2x1bW5hbGlnbicsICdyaWdodCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGZpbGxbdGhpcy5oZmlsbC5sZW5ndGggLSAxXSA9PT0gdGhpcy5TaXplKCkpIHtcbiAgICAgICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKG10ZCwgJ2NvbHVtbmFsaWduJywgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldEF0dHJpYnV0ZShtdGQsICdjb2x1bW5hbGlnbicpID8gJ2NlbnRlcicgOiAnbGVmdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucm93LnB1c2gobXRkKTtcbiAgICAgICAgdGhpcy5DbGVhcigpO1xuICAgICAgICB0aGlzLmhmaWxsID0gW107XG4gICAgfTtcbiAgICBBcnJheUl0ZW0ucHJvdG90eXBlLkVuZFJvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5vZGU7XG4gICAgICAgIGlmICh0aGlzLmdldFByb3BlcnR5KCdpc051bWJlcmVkJykgJiYgdGhpcy5yb3cubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICB0aGlzLnJvdy51bnNoaWZ0KHRoaXMucm93LnBvcCgpKTtcbiAgICAgICAgICAgIG5vZGUgPSB0aGlzLmNyZWF0ZSgnbm9kZScsICdtbGFiZWxlZHRyJywgdGhpcy5yb3cpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZSA9IHRoaXMuY3JlYXRlKCdub2RlJywgJ210cicsIHRoaXMucm93KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRhYmxlLnB1c2gobm9kZSk7XG4gICAgICAgIHRoaXMucm93ID0gW107XG4gICAgfTtcbiAgICBBcnJheUl0ZW0ucHJvdG90eXBlLkVuZFRhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5TaXplKCkgfHwgdGhpcy5yb3cubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLkVuZEVudHJ5KCk7XG4gICAgICAgICAgICB0aGlzLkVuZFJvdygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hlY2tMaW5lcygpO1xuICAgIH07XG4gICAgQXJyYXlJdGVtLnByb3RvdHlwZS5jaGVja0xpbmVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5hcnJheWRlZlsncm93bGluZXMnXSkge1xuICAgICAgICAgICAgdmFyIGxpbmVzID0gdGhpcy5hcnJheWRlZlsncm93bGluZXMnXS5zcGxpdCgvIC8pO1xuICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA9PT0gdGhpcy50YWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZyYW1lLnB1c2goJ2JvdHRvbScpO1xuICAgICAgICAgICAgICAgIGxpbmVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXJyYXlkZWZbJ3Jvd2xpbmVzJ10gPSBsaW5lcy5qb2luKCcgJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsaW5lcy5sZW5ndGggPCB0aGlzLnRhYmxlLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFycmF5ZGVmWydyb3dsaW5lcyddICs9ICcgbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZ2V0UHJvcGVydHkoJ3Jvd3NwYWNpbmcnKSkge1xuICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmFycmF5ZGVmWydyb3dzcGFjaW5nJ10uc3BsaXQoLyAvKTtcbiAgICAgICAgICAgIHdoaWxlIChyb3dzLmxlbmd0aCA8IHRoaXMudGFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcm93cy5wdXNoKHRoaXMuZ2V0UHJvcGVydHkoJ3Jvd3NwYWNpbmcnKSArICdlbScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hcnJheWRlZlsncm93c3BhY2luZyddID0gcm93cy5qb2luKCcgJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFycmF5SXRlbS5wcm90b3R5cGUuYWRkUm93U3BhY2luZyA9IGZ1bmN0aW9uIChzcGFjaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLmFycmF5ZGVmWydyb3dzcGFjaW5nJ10pIHtcbiAgICAgICAgICAgIHZhciByb3dzID0gdGhpcy5hcnJheWRlZlsncm93c3BhY2luZyddLnNwbGl0KC8gLyk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0UHJvcGVydHkoJ3Jvd3NwYWNpbmcnKSkge1xuICAgICAgICAgICAgICAgIHZhciBkaW1lbSA9IFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuZGltZW4yZW0ocm93c1swXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eSgncm93c3BhY2luZycsIGRpbWVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByb3dzcGFjaW5nID0gdGhpcy5nZXRQcm9wZXJ0eSgncm93c3BhY2luZycpO1xuICAgICAgICAgICAgd2hpbGUgKHJvd3MubGVuZ3RoIDwgdGhpcy50YWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByb3dzLnB1c2goUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5FbShyb3dzcGFjaW5nKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3dzW3RoaXMudGFibGUubGVuZ3RoIC0gMV0gPSBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LkVtKE1hdGgubWF4KDAsIHJvd3NwYWNpbmcgKyBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmRpbWVuMmVtKHNwYWNpbmcpKSk7XG4gICAgICAgICAgICB0aGlzLmFycmF5ZGVmWydyb3dzcGFjaW5nJ10gPSByb3dzLmpvaW4oJyAnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEFycmF5SXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuQXJyYXlJdGVtID0gQXJyYXlJdGVtO1xudmFyIEVxbkFycmF5SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEVxbkFycmF5SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBFcW5BcnJheUl0ZW0oZmFjdG9yeSkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmYWN0b3J5KSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tYXhyb3cgPSAwO1xuICAgICAgICBfdGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24udGFncy5zdGFydChhcmdzWzBdLCBhcmdzWzJdLCBhcmdzWzFdKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXFuQXJyYXlJdGVtLnByb3RvdHlwZSwgXCJraW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2VxbmFycmF5JztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEVxbkFycmF5SXRlbS5wcm90b3R5cGUuRW5kRW50cnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJvdy5sZW5ndGgpIHtcbiAgICAgICAgICAgIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuZml4SW5pdGlhbE1PKHRoaXMuZmFjdG9yeS5jb25maWd1cmF0aW9uLCB0aGlzLm5vZGVzKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuY3JlYXRlKCdub2RlJywgJ210ZCcsIHRoaXMubm9kZXMpO1xuICAgICAgICB0aGlzLnJvdy5wdXNoKG5vZGUpO1xuICAgICAgICB0aGlzLkNsZWFyKCk7XG4gICAgfTtcbiAgICBFcW5BcnJheUl0ZW0ucHJvdG90eXBlLkVuZFJvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucm93Lmxlbmd0aCA+IHRoaXMubWF4cm93KSB7XG4gICAgICAgICAgICB0aGlzLm1heHJvdyA9IHRoaXMucm93Lmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXRyID0gJ210cic7XG4gICAgICAgIHZhciB0YWcgPSB0aGlzLmZhY3RvcnkuY29uZmlndXJhdGlvbi50YWdzLmdldFRhZygpO1xuICAgICAgICBpZiAodGFnKSB7XG4gICAgICAgICAgICB0aGlzLnJvdyA9IFt0YWddLmNvbmNhdCh0aGlzLnJvdyk7XG4gICAgICAgICAgICBtdHIgPSAnbWxhYmVsZWR0cic7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24udGFncy5jbGVhclRhZygpO1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuY3JlYXRlKCdub2RlJywgbXRyLCB0aGlzLnJvdyk7XG4gICAgICAgIHRoaXMudGFibGUucHVzaChub2RlKTtcbiAgICAgICAgdGhpcy5yb3cgPSBbXTtcbiAgICB9O1xuICAgIEVxbkFycmF5SXRlbS5wcm90b3R5cGUuRW5kVGFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuRW5kVGFibGUuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24udGFncy5lbmQoKTtcbiAgICAgICAgdGhpcy5leHRlbmRBcnJheSgnY29sdW1uYWxpZ24nLCB0aGlzLm1heHJvdyk7XG4gICAgICAgIHRoaXMuZXh0ZW5kQXJyYXkoJ2NvbHVtbndpZHRoJywgdGhpcy5tYXhyb3cpO1xuICAgICAgICB0aGlzLmV4dGVuZEFycmF5KCdjb2x1bW5zcGFjaW5nJywgdGhpcy5tYXhyb3cgLSAxKTtcbiAgICB9O1xuICAgIEVxbkFycmF5SXRlbS5wcm90b3R5cGUuZXh0ZW5kQXJyYXkgPSBmdW5jdGlvbiAobmFtZSwgbWF4KSB7XG4gICAgICAgIGlmICghdGhpcy5hcnJheWRlZltuYW1lXSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHJlcGVhdCA9IHRoaXMuYXJyYXlkZWZbbmFtZV0uc3BsaXQoLyAvKTtcbiAgICAgICAgdmFyIGNvbHVtbnMgPSBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQocmVwZWF0KSwgZmFsc2UpO1xuICAgICAgICBpZiAoY29sdW1ucy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICB3aGlsZSAoY29sdW1ucy5sZW5ndGggPCBtYXgpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2guYXBwbHkoY29sdW1ucywgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKHJlcGVhdCksIGZhbHNlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmFycmF5ZGVmW25hbWVdID0gY29sdW1ucy5zbGljZSgwLCBtYXgpLmpvaW4oJyAnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEVxbkFycmF5SXRlbTtcbn0oQXJyYXlJdGVtKSk7XG5leHBvcnRzLkVxbkFycmF5SXRlbSA9IEVxbkFycmF5SXRlbTtcbnZhciBFcXVhdGlvbkl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFcXVhdGlvbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRXF1YXRpb25JdGVtKGZhY3RvcnkpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZmFjdG9yeSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZmFjdG9yeS5jb25maWd1cmF0aW9uLnRhZ3Muc3RhcnQoJ2VxdWF0aW9uJywgdHJ1ZSwgYXJnc1swXSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVxdWF0aW9uSXRlbS5wcm90b3R5cGUsIFwia2luZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdlcXVhdGlvbic7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXF1YXRpb25JdGVtLnByb3RvdHlwZSwgXCJpc09wZW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRXF1YXRpb25JdGVtLnByb3RvdHlwZS5jaGVja0l0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ2VuZCcpKSB7XG4gICAgICAgICAgICB2YXIgbW1sID0gdGhpcy50b01tbCgpO1xuICAgICAgICAgICAgdmFyIHRhZyA9IHRoaXMuZmFjdG9yeS5jb25maWd1cmF0aW9uLnRhZ3MuZ2V0VGFnKCk7XG4gICAgICAgICAgICB0aGlzLmZhY3RvcnkuY29uZmlndXJhdGlvbi50YWdzLmVuZCgpO1xuICAgICAgICAgICAgcmV0dXJuIFtbdGFnID8gdGhpcy5mYWN0b3J5LmNvbmZpZ3VyYXRpb24udGFncy5lblRhZyhtbWwsIHRhZykgOiBtbWwsIGl0ZW1dLCB0cnVlXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS5pc0tpbmQoJ3N0b3AnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnRW52TWlzc2luZ0VuZCcsICdNaXNzaW5nIFxcXFxlbmR7JTF9JywgdGhpcy5nZXROYW1lKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmNoZWNrSXRlbS5jYWxsKHRoaXMsIGl0ZW0pO1xuICAgIH07XG4gICAgcmV0dXJuIEVxdWF0aW9uSXRlbTtcbn0oU3RhY2tJdGVtX2pzXzEuQmFzZUl0ZW0pKTtcbmV4cG9ydHMuRXF1YXRpb25JdGVtID0gRXF1YXRpb25JdGVtO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QmFzZUl0ZW1zLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcbn0pIDogZnVuY3Rpb24obywgdikge1xuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcbn0pO1xudmFyIF9faW1wb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnRTdGFyKSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc20gPSBfX2ltcG9ydFN0YXIocmVxdWlyZShcIi4uL1N5bWJvbE1hcC5qc1wiKSk7XG52YXIgVGV4Q29uc3RhbnRzX2pzXzEgPSByZXF1aXJlKFwiLi4vVGV4Q29uc3RhbnRzLmpzXCIpO1xudmFyIEJhc2VNZXRob2RzX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vQmFzZU1ldGhvZHMuanNcIikpO1xudmFyIFBhcnNlTWV0aG9kc19qc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9QYXJzZU1ldGhvZHMuanNcIikpO1xudmFyIFBhcnNlVXRpbF9qc18xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCIuLi9QYXJzZVV0aWwuanNcIikpO1xudmFyIE1tbE5vZGVfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jb3JlL01tbFRyZWUvTW1sTm9kZS5qc1wiKTtcbnZhciBsZW5ndGhzX2pzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbC9sZW5ndGhzLmpzXCIpO1xubmV3IHNtLlJlZ0V4cE1hcCgnbGV0dGVyJywgUGFyc2VNZXRob2RzX2pzXzEuZGVmYXVsdC52YXJpYWJsZSwgL1thLXpdL2kpO1xubmV3IHNtLlJlZ0V4cE1hcCgnZGlnaXQnLCBQYXJzZU1ldGhvZHNfanNfMS5kZWZhdWx0LmRpZ2l0LCAvWzAtOS4sXS8pO1xubmV3IHNtLlJlZ0V4cE1hcCgnY29tbWFuZCcsIFBhcnNlTWV0aG9kc19qc18xLmRlZmF1bHQuY29udHJvbFNlcXVlbmNlLCAvXlxcXFwvKTtcbm5ldyBzbS5NYWNyb01hcCgnc3BlY2lhbCcsIHtcbiAgICAneyc6ICdPcGVuJyxcbiAgICAnfSc6ICdDbG9zZScsXG4gICAgJ34nOiAnVGlsZGUnLFxuICAgICdeJzogJ1N1cGVyc2NyaXB0JyxcbiAgICAnXyc6ICdTdWJzY3JpcHQnLFxuICAgICcgJzogJ1NwYWNlJyxcbiAgICAnXFx0JzogJ1NwYWNlJyxcbiAgICAnXFxyJzogJ1NwYWNlJyxcbiAgICAnXFxuJzogJ1NwYWNlJyxcbiAgICAnXFwnJzogJ1ByaW1lJyxcbiAgICAnJSc6ICdDb21tZW50JyxcbiAgICAnJic6ICdFbnRyeScsXG4gICAgJyMnOiAnSGFzaCcsXG4gICAgJ1xcdTAwQTAnOiAnU3BhY2UnLFxuICAgICdcXHUyMDE5JzogJ1ByaW1lJ1xufSwgQmFzZU1ldGhvZHNfanNfMS5kZWZhdWx0KTtcbm5ldyBzbS5DaGFyYWN0ZXJNYXAoJ21hdGhjaGFyMG1pJywgUGFyc2VNZXRob2RzX2pzXzEuZGVmYXVsdC5tYXRoY2hhcjBtaSwge1xuICAgIGFscGhhOiAnXFx1MDNCMScsXG4gICAgYmV0YTogJ1xcdTAzQjInLFxuICAgIGdhbW1hOiAnXFx1MDNCMycsXG4gICAgZGVsdGE6ICdcXHUwM0I0JyxcbiAgICBlcHNpbG9uOiAnXFx1MDNGNScsXG4gICAgemV0YTogJ1xcdTAzQjYnLFxuICAgIGV0YTogJ1xcdTAzQjcnLFxuICAgIHRoZXRhOiAnXFx1MDNCOCcsXG4gICAgaW90YTogJ1xcdTAzQjknLFxuICAgIGthcHBhOiAnXFx1MDNCQScsXG4gICAgbGFtYmRhOiAnXFx1MDNCQicsXG4gICAgbXU6ICdcXHUwM0JDJyxcbiAgICBudTogJ1xcdTAzQkQnLFxuICAgIHhpOiAnXFx1MDNCRScsXG4gICAgb21pY3JvbjogJ1xcdTAzQkYnLFxuICAgIHBpOiAnXFx1MDNDMCcsXG4gICAgcmhvOiAnXFx1MDNDMScsXG4gICAgc2lnbWE6ICdcXHUwM0MzJyxcbiAgICB0YXU6ICdcXHUwM0M0JyxcbiAgICB1cHNpbG9uOiAnXFx1MDNDNScsXG4gICAgcGhpOiAnXFx1MDNENScsXG4gICAgY2hpOiAnXFx1MDNDNycsXG4gICAgcHNpOiAnXFx1MDNDOCcsXG4gICAgb21lZ2E6ICdcXHUwM0M5JyxcbiAgICB2YXJlcHNpbG9uOiAnXFx1MDNCNScsXG4gICAgdmFydGhldGE6ICdcXHUwM0QxJyxcbiAgICB2YXJwaTogJ1xcdTAzRDYnLFxuICAgIHZhcnJobzogJ1xcdTAzRjEnLFxuICAgIHZhcnNpZ21hOiAnXFx1MDNDMicsXG4gICAgdmFycGhpOiAnXFx1MDNDNicsXG4gICAgUzogWydcXHUwMEE3JywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgYWxlcGg6IFsnXFx1MjEzNScsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIGhiYXI6IFsnXFx1MjEwRicsIHsgdmFyaWFudEZvcm06IHRydWUgfV0sXG4gICAgaW1hdGg6ICdcXHUwMTMxJyxcbiAgICBqbWF0aDogJ1xcdTAyMzcnLFxuICAgIGVsbDogJ1xcdTIxMTMnLFxuICAgIHdwOiBbJ1xcdTIxMTgnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBSZTogWydcXHUyMTFDJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgSW06IFsnXFx1MjExMScsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIHBhcnRpYWw6IFsnXFx1MjIwMicsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuSVRBTElDIH1dLFxuICAgIGluZnR5OiBbJ1xcdTIyMUUnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBwcmltZTogWydcXHUyMDMyJywgeyB2YXJpYW50Rm9ybTogdHJ1ZSB9XSxcbiAgICBlbXB0eXNldDogWydcXHUyMjA1JywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgbmFibGE6IFsnXFx1MjIwNycsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIHRvcDogWydcXHUyMkE0JywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgYm90OiBbJ1xcdTIyQTUnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBhbmdsZTogWydcXHUyMjIwJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgdHJpYW5nbGU6IFsnXFx1MjVCMycsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIGJhY2tzbGFzaDogWydcXHUyMjE2JywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgZm9yYWxsOiBbJ1xcdTIyMDAnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBleGlzdHM6IFsnXFx1MjIwMycsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIG5lZzogWydcXHUwMEFDJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgbG5vdDogWydcXHUwMEFDJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgZmxhdDogWydcXHUyNjZEJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgbmF0dXJhbDogWydcXHUyNjZFJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgc2hhcnA6IFsnXFx1MjY2RicsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dLFxuICAgIGNsdWJzdWl0OiBbJ1xcdTI2NjMnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBkaWFtb25kc3VpdDogWydcXHUyNjYyJywgeyBtYXRodmFyaWFudDogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUwgfV0sXG4gICAgaGVhcnRzdWl0OiBbJ1xcdTI2NjEnLCB7IG1hdGh2YXJpYW50OiBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTCB9XSxcbiAgICBzcGFkZXN1aXQ6IFsnXFx1MjY2MCcsIHsgbWF0aHZhcmlhbnQ6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMIH1dXG59KTtcbm5ldyBzbS5DaGFyYWN0ZXJNYXAoJ21hdGhjaGFyMG1vJywgUGFyc2VNZXRob2RzX2pzXzEuZGVmYXVsdC5tYXRoY2hhcjBtbywge1xuICAgIHN1cmQ6ICdcXHUyMjFBJyxcbiAgICBjb3Byb2Q6IFsnXFx1MjIxMCcsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCxcbiAgICAgICAgICAgIG1vdmVzdXBzdWI6IHRydWUgfV0sXG4gICAgYmlndmVlOiBbJ1xcdTIyQzEnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AsXG4gICAgICAgICAgICBtb3Zlc3Vwc3ViOiB0cnVlIH1dLFxuICAgIGJpZ3dlZGdlOiBbJ1xcdTIyQzAnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AsXG4gICAgICAgICAgICBtb3Zlc3Vwc3ViOiB0cnVlIH1dLFxuICAgIGJpZ3VwbHVzOiBbJ1xcdTJBMDQnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AsXG4gICAgICAgICAgICBtb3Zlc3Vwc3ViOiB0cnVlIH1dLFxuICAgIGJpZ2NhcDogWydcXHUyMkMyJywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QLFxuICAgICAgICAgICAgbW92ZXN1cHN1YjogdHJ1ZSB9XSxcbiAgICBiaWdjdXA6IFsnXFx1MjJDMycsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCxcbiAgICAgICAgICAgIG1vdmVzdXBzdWI6IHRydWUgfV0sXG4gICAgJ2ludCc6IFsnXFx1MjIyQicsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCB9XSxcbiAgICBpbnRvcDogWydcXHUyMjJCJywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QLFxuICAgICAgICAgICAgbW92ZXN1cHN1YjogdHJ1ZSwgbW92YWJsZWxpbWl0czogdHJ1ZSB9XSxcbiAgICBpaW50OiBbJ1xcdTIyMkMnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AgfV0sXG4gICAgaWlpbnQ6IFsnXFx1MjIyRCcsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCB9XSxcbiAgICBwcm9kOiBbJ1xcdTIyMEYnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AsXG4gICAgICAgICAgICBtb3Zlc3Vwc3ViOiB0cnVlIH1dLFxuICAgIHN1bTogWydcXHUyMjExJywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QLFxuICAgICAgICAgICAgbW92ZXN1cHN1YjogdHJ1ZSB9XSxcbiAgICBiaWdvdGltZXM6IFsnXFx1MkEwMicsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCxcbiAgICAgICAgICAgIG1vdmVzdXBzdWI6IHRydWUgfV0sXG4gICAgYmlnb3BsdXM6IFsnXFx1MkEwMScsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCxcbiAgICAgICAgICAgIG1vdmVzdXBzdWI6IHRydWUgfV0sXG4gICAgYmlnb2RvdDogWydcXHUyQTAwJywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QLFxuICAgICAgICAgICAgbW92ZXN1cHN1YjogdHJ1ZSB9XSxcbiAgICBvaW50OiBbJ1xcdTIyMkUnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1AgfV0sXG4gICAgYmlnc3FjdXA6IFsnXFx1MkEwNicsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCxcbiAgICAgICAgICAgIG1vdmVzdXBzdWI6IHRydWUgfV0sXG4gICAgc21hbGxpbnQ6IFsnXFx1MjIyQicsIHsgbGFyZ2VvcDogZmFsc2UgfV0sXG4gICAgdHJpYW5nbGVsZWZ0OiAnXFx1MjVDMycsXG4gICAgdHJpYW5nbGVyaWdodDogJ1xcdTI1QjknLFxuICAgIGJpZ3RyaWFuZ2xldXA6ICdcXHUyNUIzJyxcbiAgICBiaWd0cmlhbmdsZWRvd246ICdcXHUyNUJEJyxcbiAgICB3ZWRnZTogJ1xcdTIyMjcnLFxuICAgIGxhbmQ6ICdcXHUyMjI3JyxcbiAgICB2ZWU6ICdcXHUyMjI4JyxcbiAgICBsb3I6ICdcXHUyMjI4JyxcbiAgICBjYXA6ICdcXHUyMjI5JyxcbiAgICBjdXA6ICdcXHUyMjJBJyxcbiAgICBkZGFnZ2VyOiAnXFx1MjAyMScsXG4gICAgZGFnZ2VyOiAnXFx1MjAyMCcsXG4gICAgc3FjYXA6ICdcXHUyMjkzJyxcbiAgICBzcWN1cDogJ1xcdTIyOTQnLFxuICAgIHVwbHVzOiAnXFx1MjI4RScsXG4gICAgYW1hbGc6ICdcXHUyQTNGJyxcbiAgICBkaWFtb25kOiAnXFx1MjJDNCcsXG4gICAgYnVsbGV0OiAnXFx1MjIxOScsXG4gICAgd3I6ICdcXHUyMjQwJyxcbiAgICBkaXY6ICdcXHUwMEY3JyxcbiAgICBkaXZzeW1ib2w6ICdcXHUwMEY3JyxcbiAgICBvZG90OiBbJ1xcdTIyOTknLCB7IGxhcmdlb3A6IGZhbHNlIH1dLFxuICAgIG9zbGFzaDogWydcXHUyMjk4JywgeyBsYXJnZW9wOiBmYWxzZSB9XSxcbiAgICBvdGltZXM6IFsnXFx1MjI5NycsIHsgbGFyZ2VvcDogZmFsc2UgfV0sXG4gICAgb21pbnVzOiBbJ1xcdTIyOTYnLCB7IGxhcmdlb3A6IGZhbHNlIH1dLFxuICAgIG9wbHVzOiBbJ1xcdTIyOTUnLCB7IGxhcmdlb3A6IGZhbHNlIH1dLFxuICAgIG1wOiAnXFx1MjIxMycsXG4gICAgcG06ICdcXHUwMEIxJyxcbiAgICBjaXJjOiAnXFx1MjIxOCcsXG4gICAgYmlnY2lyYzogJ1xcdTI1RUYnLFxuICAgIHNldG1pbnVzOiAnXFx1MjIxNicsXG4gICAgY2RvdDogJ1xcdTIyQzUnLFxuICAgIGFzdDogJ1xcdTIyMTcnLFxuICAgIHRpbWVzOiAnXFx1MDBENycsXG4gICAgc3RhcjogJ1xcdTIyQzYnLFxuICAgIHByb3B0bzogJ1xcdTIyMUQnLFxuICAgIHNxc3Vic2V0ZXE6ICdcXHUyMjkxJyxcbiAgICBzcXN1cHNldGVxOiAnXFx1MjI5MicsXG4gICAgcGFyYWxsZWw6ICdcXHUyMjI1JyxcbiAgICBtaWQ6ICdcXHUyMjIzJyxcbiAgICBkYXNodjogJ1xcdTIyQTMnLFxuICAgIHZkYXNoOiAnXFx1MjJBMicsXG4gICAgbGVxOiAnXFx1MjI2NCcsXG4gICAgbGU6ICdcXHUyMjY0JyxcbiAgICBnZXE6ICdcXHUyMjY1JyxcbiAgICBnZTogJ1xcdTIyNjUnLFxuICAgIGx0OiAnXFx1MDAzQycsXG4gICAgZ3Q6ICdcXHUwMDNFJyxcbiAgICBzdWNjOiAnXFx1MjI3QicsXG4gICAgcHJlYzogJ1xcdTIyN0EnLFxuICAgIGFwcHJveDogJ1xcdTIyNDgnLFxuICAgIHN1Y2NlcTogJ1xcdTJBQjAnLFxuICAgIHByZWNlcTogJ1xcdTJBQUYnLFxuICAgIHN1cHNldDogJ1xcdTIyODMnLFxuICAgIHN1YnNldDogJ1xcdTIyODInLFxuICAgIHN1cHNldGVxOiAnXFx1MjI4NycsXG4gICAgc3Vic2V0ZXE6ICdcXHUyMjg2JyxcbiAgICAnaW4nOiAnXFx1MjIwOCcsXG4gICAgbmk6ICdcXHUyMjBCJyxcbiAgICBub3RpbjogJ1xcdTIyMDknLFxuICAgIG93bnM6ICdcXHUyMjBCJyxcbiAgICBnZzogJ1xcdTIyNkInLFxuICAgIGxsOiAnXFx1MjI2QScsXG4gICAgc2ltOiAnXFx1MjIzQycsXG4gICAgc2ltZXE6ICdcXHUyMjQzJyxcbiAgICBwZXJwOiAnXFx1MjJBNScsXG4gICAgZXF1aXY6ICdcXHUyMjYxJyxcbiAgICBhc3ltcDogJ1xcdTIyNEQnLFxuICAgIHNtaWxlOiAnXFx1MjMyMycsXG4gICAgZnJvd246ICdcXHUyMzIyJyxcbiAgICBuZTogJ1xcdTIyNjAnLFxuICAgIG5lcTogJ1xcdTIyNjAnLFxuICAgIGNvbmc6ICdcXHUyMjQ1JyxcbiAgICBkb3RlcTogJ1xcdTIyNTAnLFxuICAgIGJvd3RpZTogJ1xcdTIyQzgnLFxuICAgIG1vZGVsczogJ1xcdTIyQTgnLFxuICAgIG5vdENoYXI6ICdcXHUyOUY4JyxcbiAgICBMZWZ0cmlnaHRhcnJvdzogJ1xcdTIxRDQnLFxuICAgIExlZnRhcnJvdzogJ1xcdTIxRDAnLFxuICAgIFJpZ2h0YXJyb3c6ICdcXHUyMUQyJyxcbiAgICBsZWZ0cmlnaHRhcnJvdzogJ1xcdTIxOTQnLFxuICAgIGxlZnRhcnJvdzogJ1xcdTIxOTAnLFxuICAgIGdldHM6ICdcXHUyMTkwJyxcbiAgICByaWdodGFycm93OiAnXFx1MjE5MicsXG4gICAgdG86IFsnXFx1MjE5MicsIHsgYWNjZW50OiBmYWxzZSB9XSxcbiAgICBtYXBzdG86ICdcXHUyMUE2JyxcbiAgICBsZWZ0aGFycG9vbnVwOiAnXFx1MjFCQycsXG4gICAgbGVmdGhhcnBvb25kb3duOiAnXFx1MjFCRCcsXG4gICAgcmlnaHRoYXJwb29udXA6ICdcXHUyMUMwJyxcbiAgICByaWdodGhhcnBvb25kb3duOiAnXFx1MjFDMScsXG4gICAgbmVhcnJvdzogJ1xcdTIxOTcnLFxuICAgIHNlYXJyb3c6ICdcXHUyMTk4JyxcbiAgICBud2Fycm93OiAnXFx1MjE5NicsXG4gICAgc3dhcnJvdzogJ1xcdTIxOTknLFxuICAgIHJpZ2h0bGVmdGhhcnBvb25zOiAnXFx1MjFDQycsXG4gICAgaG9va3JpZ2h0YXJyb3c6ICdcXHUyMUFBJyxcbiAgICBob29rbGVmdGFycm93OiAnXFx1MjFBOScsXG4gICAgbG9uZ2xlZnRhcnJvdzogJ1xcdTI3RjUnLFxuICAgIExvbmdsZWZ0YXJyb3c6ICdcXHUyN0Y4JyxcbiAgICBsb25ncmlnaHRhcnJvdzogJ1xcdTI3RjYnLFxuICAgIExvbmdyaWdodGFycm93OiAnXFx1MjdGOScsXG4gICAgTG9uZ2xlZnRyaWdodGFycm93OiAnXFx1MjdGQScsXG4gICAgbG9uZ2xlZnRyaWdodGFycm93OiAnXFx1MjdGNycsXG4gICAgbG9uZ21hcHN0bzogJ1xcdTI3RkMnLFxuICAgIGxkb3RzOiAnXFx1MjAyNicsXG4gICAgY2RvdHM6ICdcXHUyMkVGJyxcbiAgICB2ZG90czogJ1xcdTIyRUUnLFxuICAgIGRkb3RzOiAnXFx1MjJGMScsXG4gICAgZG90c2M6ICdcXHUyMDI2JyxcbiAgICBkb3RzYjogJ1xcdTIyRUYnLFxuICAgIGRvdHNtOiAnXFx1MjJFRicsXG4gICAgZG90c2k6ICdcXHUyMkVGJyxcbiAgICBkb3RzbzogJ1xcdTIwMjYnLFxuICAgIGxkb3RwOiBbJ1xcdTAwMkUnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuUFVOQ1QgfV0sXG4gICAgY2RvdHA6IFsnXFx1MjJDNScsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5QVU5DVCB9XSxcbiAgICBjb2xvbjogWydcXHUwMDNBJywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLlBVTkNUIH1dXG59KTtcbm5ldyBzbS5DaGFyYWN0ZXJNYXAoJ21hdGhjaGFyNycsIFBhcnNlTWV0aG9kc19qc18xLmRlZmF1bHQubWF0aGNoYXI3LCB7XG4gICAgR2FtbWE6ICdcXHUwMzkzJyxcbiAgICBEZWx0YTogJ1xcdTAzOTQnLFxuICAgIFRoZXRhOiAnXFx1MDM5OCcsXG4gICAgTGFtYmRhOiAnXFx1MDM5QicsXG4gICAgWGk6ICdcXHUwMzlFJyxcbiAgICBQaTogJ1xcdTAzQTAnLFxuICAgIFNpZ21hOiAnXFx1MDNBMycsXG4gICAgVXBzaWxvbjogJ1xcdTAzQTUnLFxuICAgIFBoaTogJ1xcdTAzQTYnLFxuICAgIFBzaTogJ1xcdTAzQTgnLFxuICAgIE9tZWdhOiAnXFx1MDNBOScsXG4gICAgJ18nOiAnXFx1MDA1RicsXG4gICAgJyMnOiAnXFx1MDAyMycsXG4gICAgJyQnOiAnXFx1MDAyNCcsXG4gICAgJyUnOiAnXFx1MDAyNScsXG4gICAgJyYnOiAnXFx1MDAyNicsXG4gICAgQW5kOiAnXFx1MDAyNidcbn0pO1xubmV3IHNtLkRlbGltaXRlck1hcCgnZGVsaW1pdGVyJywgUGFyc2VNZXRob2RzX2pzXzEuZGVmYXVsdC5kZWxpbWl0ZXIsIHtcbiAgICAnKCc6ICcoJyxcbiAgICAnKSc6ICcpJyxcbiAgICAnWyc6ICdbJyxcbiAgICAnXSc6ICddJyxcbiAgICAnPCc6ICdcXHUyN0U4JyxcbiAgICAnPic6ICdcXHUyN0U5JyxcbiAgICAnXFxcXGx0JzogJ1xcdTI3RTgnLFxuICAgICdcXFxcZ3QnOiAnXFx1MjdFOScsXG4gICAgJy8nOiAnLycsXG4gICAgJ3wnOiBbJ3wnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1JEIH1dLFxuICAgICcuJzogJycsXG4gICAgJ1xcXFxcXFxcJzogJ1xcXFwnLFxuICAgICdcXFxcbG1vdXN0YWNoZSc6ICdcXHUyM0IwJyxcbiAgICAnXFxcXHJtb3VzdGFjaGUnOiAnXFx1MjNCMScsXG4gICAgJ1xcXFxsZ3JvdXAnOiAnXFx1MjdFRScsXG4gICAgJ1xcXFxyZ3JvdXAnOiAnXFx1MjdFRicsXG4gICAgJ1xcXFxhcnJvd3ZlcnQnOiAnXFx1MjNEMCcsXG4gICAgJ1xcXFxBcnJvd3ZlcnQnOiAnXFx1MjAxNicsXG4gICAgJ1xcXFxicmFjZXZlcnQnOiAnXFx1MjNBQScsXG4gICAgJ1xcXFxWZXJ0JzogWydcXHUyMDE2JywgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRCB9XSxcbiAgICAnXFxcXHwnOiBbJ1xcdTIwMTYnLCB7IHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1JEIH1dLFxuICAgICdcXFxcdmVydCc6IFsnfCcsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUkQgfV0sXG4gICAgJ1xcXFx1cGFycm93JzogJ1xcdTIxOTEnLFxuICAgICdcXFxcZG93bmFycm93JzogJ1xcdTIxOTMnLFxuICAgICdcXFxcdXBkb3duYXJyb3cnOiAnXFx1MjE5NScsXG4gICAgJ1xcXFxVcGFycm93JzogJ1xcdTIxRDEnLFxuICAgICdcXFxcRG93bmFycm93JzogJ1xcdTIxRDMnLFxuICAgICdcXFxcVXBkb3duYXJyb3cnOiAnXFx1MjFENScsXG4gICAgJ1xcXFxiYWNrc2xhc2gnOiAnXFxcXCcsXG4gICAgJ1xcXFxyYW5nbGUnOiAnXFx1MjdFOScsXG4gICAgJ1xcXFxsYW5nbGUnOiAnXFx1MjdFOCcsXG4gICAgJ1xcXFxyYnJhY2UnOiAnfScsXG4gICAgJ1xcXFxsYnJhY2UnOiAneycsXG4gICAgJ1xcXFx9JzogJ30nLFxuICAgICdcXFxceyc6ICd7JyxcbiAgICAnXFxcXHJjZWlsJzogJ1xcdTIzMDknLFxuICAgICdcXFxcbGNlaWwnOiAnXFx1MjMwOCcsXG4gICAgJ1xcXFxyZmxvb3InOiAnXFx1MjMwQicsXG4gICAgJ1xcXFxsZmxvb3InOiAnXFx1MjMwQScsXG4gICAgJ1xcXFxsYnJhY2snOiAnWycsXG4gICAgJ1xcXFxyYnJhY2snOiAnXSdcbn0pO1xubmV3IHNtLkNvbW1hbmRNYXAoJ21hY3JvcycsIHtcbiAgICBkaXNwbGF5c3R5bGU6IFsnU2V0U3R5bGUnLCAnRCcsIHRydWUsIDBdLFxuICAgIHRleHRzdHlsZTogWydTZXRTdHlsZScsICdUJywgZmFsc2UsIDBdLFxuICAgIHNjcmlwdHN0eWxlOiBbJ1NldFN0eWxlJywgJ1MnLCBmYWxzZSwgMV0sXG4gICAgc2NyaXB0c2NyaXB0c3R5bGU6IFsnU2V0U3R5bGUnLCAnU1MnLCBmYWxzZSwgMl0sXG4gICAgcm06IFsnU2V0Rm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMXSxcbiAgICBtaXQ6IFsnU2V0Rm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuSVRBTElDXSxcbiAgICBvbGRzdHlsZTogWydTZXRGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5PTERTVFlMRV0sXG4gICAgY2FsOiBbJ1NldEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkNBTExJR1JBUEhJQ10sXG4gICAgaXQ6IFsnU2V0Rm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTUFUSElUQUxJQ10sXG4gICAgYmY6IFsnU2V0Rm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRF0sXG4gICAgYmJGb250OiBbJ1NldEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkRPVUJMRVNUUlVDS10sXG4gICAgc2NyOiBbJ1NldEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LlNDUklQVF0sXG4gICAgZnJhazogWydTZXRGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5GUkFLVFVSXSxcbiAgICBzZjogWydTZXRGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZdLFxuICAgIHR0OiBbJ1NldEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk1PTk9TUEFDRV0sXG4gICAgbWF0aHJtOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUxdLFxuICAgIG1hdGh1cDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTk9STUFMXSxcbiAgICBtYXRobm9ybWFsOiBbJ01hdGhGb250JywgJyddLFxuICAgIG1hdGhiZjogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRF0sXG4gICAgbWF0aGJmdXA6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERdLFxuICAgIG1hdGhpdDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuTUFUSElUQUxJQ10sXG4gICAgbWF0aGJmaXQ6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERJVEFMSUNdLFxuICAgIG1hdGhiYjogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuRE9VQkxFU1RSVUNLXSxcbiAgICBCYmI6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkRPVUJMRVNUUlVDS10sXG4gICAgbWF0aGZyYWs6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkZSQUtUVVJdLFxuICAgIG1hdGhiZmZyYWs6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERGUkFLVFVSXSxcbiAgICBtYXRoc2NyOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQ1JJUFRdLFxuICAgIG1hdGhiZnNjcjogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRFNDUklQVF0sXG4gICAgbWF0aHNmOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZdLFxuICAgIG1hdGhzZnVwOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZdLFxuICAgIG1hdGhiZnNmOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5CT0xEU0FOU1NFUklGXSxcbiAgICBtYXRoYmZzZnVwOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5CT0xEU0FOU1NFUklGXSxcbiAgICBtYXRoc2ZpdDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuU0FOU1NFUklGSVRBTElDXSxcbiAgICBtYXRoYmZzZml0OiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZCT0xESVRBTElDXSxcbiAgICBtYXRodHQ6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk1PTk9TUEFDRV0sXG4gICAgbWF0aGNhbDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQ0FMTElHUkFQSElDXSxcbiAgICBtYXRoYmZjYWw6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERDQUxMSUdSQVBISUNdLFxuICAgIHN5bXJtOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUxdLFxuICAgIHN5bXVwOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5OT1JNQUxdLFxuICAgIHN5bW5vcm1hbDogWydNYXRoRm9udCcsICcnXSxcbiAgICBzeW1iZjogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRF0sXG4gICAgc3ltYmZ1cDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRF0sXG4gICAgc3ltaXQ6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LklUQUxJQ10sXG4gICAgc3ltYmZpdDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRElUQUxJQ10sXG4gICAgc3ltYmI6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkRPVUJMRVNUUlVDS10sXG4gICAgc3ltZnJhazogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuRlJBS1RVUl0sXG4gICAgc3ltYmZmcmFrOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5CT0xERlJBS1RVUl0sXG4gICAgc3ltc2NyOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQ1JJUFRdLFxuICAgIHN5bWJmc2NyOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5CT0xEU0NSSVBUXSxcbiAgICBzeW1zZjogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuU0FOU1NFUklGXSxcbiAgICBzeW1zZnVwOiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZdLFxuICAgIHN5bWJmc2Y6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERTQU5TU0VSSUZdLFxuICAgIHN5bWJmc2Z1cDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRFNBTlNTRVJJRl0sXG4gICAgc3ltc2ZpdDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuU0FOU1NFUklGSVRBTElDXSxcbiAgICBzeW1iZnNmaXQ6IFsnTWF0aEZvbnQnLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LlNBTlNTRVJJRkJPTERJVEFMSUNdLFxuICAgIHN5bXR0OiBbJ01hdGhGb250JywgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5NT05PU1BBQ0VdLFxuICAgIHN5bWNhbDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQ0FMTElHUkFQSElDXSxcbiAgICBzeW1iZmNhbDogWydNYXRoRm9udCcsIFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LlZhcmlhbnQuQk9MRENBTExJR1JBUEhJQ10sXG4gICAgdGV4dHJtOiBbJ0hCb3gnLCBudWxsLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTF0sXG4gICAgdGV4dHVwOiBbJ0hCb3gnLCBudWxsLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTF0sXG4gICAgdGV4dG5vcm1hbDogWydIQm94J10sXG4gICAgdGV4dGl0OiBbJ0hCb3gnLCBudWxsLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LklUQUxJQ10sXG4gICAgdGV4dGJmOiBbJ0hCb3gnLCBudWxsLCBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50LkJPTERdLFxuICAgIHRleHRzZjogWydIQm94JywgbnVsbCwgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5TQU5TU0VSSUZdLFxuICAgIHRleHR0dDogWydIQm94JywgbnVsbCwgVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuVmFyaWFudC5NT05PU1BBQ0VdLFxuICAgIHRpbnk6IFsnU2V0U2l6ZScsIDAuNV0sXG4gICAgVGlueTogWydTZXRTaXplJywgMC42XSxcbiAgICBzY3JpcHRzaXplOiBbJ1NldFNpemUnLCAwLjddLFxuICAgIHNtYWxsOiBbJ1NldFNpemUnLCAwLjg1XSxcbiAgICBub3JtYWxzaXplOiBbJ1NldFNpemUnLCAxLjBdLFxuICAgIGxhcmdlOiBbJ1NldFNpemUnLCAxLjJdLFxuICAgIExhcmdlOiBbJ1NldFNpemUnLCAxLjQ0XSxcbiAgICBMQVJHRTogWydTZXRTaXplJywgMS43M10sXG4gICAgaHVnZTogWydTZXRTaXplJywgMi4wN10sXG4gICAgSHVnZTogWydTZXRTaXplJywgMi40OV0sXG4gICAgYXJjc2luOiAnTmFtZWRGbicsXG4gICAgYXJjY29zOiAnTmFtZWRGbicsXG4gICAgYXJjdGFuOiAnTmFtZWRGbicsXG4gICAgYXJnOiAnTmFtZWRGbicsXG4gICAgY29zOiAnTmFtZWRGbicsXG4gICAgY29zaDogJ05hbWVkRm4nLFxuICAgIGNvdDogJ05hbWVkRm4nLFxuICAgIGNvdGg6ICdOYW1lZEZuJyxcbiAgICBjc2M6ICdOYW1lZEZuJyxcbiAgICBkZWc6ICdOYW1lZEZuJyxcbiAgICBkZXQ6ICdOYW1lZE9wJyxcbiAgICBkaW06ICdOYW1lZEZuJyxcbiAgICBleHA6ICdOYW1lZEZuJyxcbiAgICBnY2Q6ICdOYW1lZE9wJyxcbiAgICBob206ICdOYW1lZEZuJyxcbiAgICBpbmY6ICdOYW1lZE9wJyxcbiAgICBrZXI6ICdOYW1lZEZuJyxcbiAgICBsZzogJ05hbWVkRm4nLFxuICAgIGxpbTogJ05hbWVkT3AnLFxuICAgIGxpbWluZjogWydOYW1lZE9wJywgJ2xpbSZ0aGluc3A7aW5mJ10sXG4gICAgbGltc3VwOiBbJ05hbWVkT3AnLCAnbGltJnRoaW5zcDtzdXAnXSxcbiAgICBsbjogJ05hbWVkRm4nLFxuICAgIGxvZzogJ05hbWVkRm4nLFxuICAgIG1heDogJ05hbWVkT3AnLFxuICAgIG1pbjogJ05hbWVkT3AnLFxuICAgIFByOiAnTmFtZWRPcCcsXG4gICAgc2VjOiAnTmFtZWRGbicsXG4gICAgc2luOiAnTmFtZWRGbicsXG4gICAgc2luaDogJ05hbWVkRm4nLFxuICAgIHN1cDogJ05hbWVkT3AnLFxuICAgIHRhbjogJ05hbWVkRm4nLFxuICAgIHRhbmg6ICdOYW1lZEZuJyxcbiAgICBsaW1pdHM6IFsnTGltaXRzJywgMV0sXG4gICAgbm9saW1pdHM6IFsnTGltaXRzJywgMF0sXG4gICAgb3ZlcmxpbmU6IFsnVW5kZXJPdmVyJywgJzIwMTUnXSxcbiAgICB1bmRlcmxpbmU6IFsnVW5kZXJPdmVyJywgJzIwMTUnXSxcbiAgICBvdmVyYnJhY2U6IFsnVW5kZXJPdmVyJywgJzIzREUnLCAxXSxcbiAgICB1bmRlcmJyYWNlOiBbJ1VuZGVyT3ZlcicsICcyM0RGJywgMV0sXG4gICAgb3ZlcnBhcmVuOiBbJ1VuZGVyT3ZlcicsICcyM0RDJ10sXG4gICAgdW5kZXJwYXJlbjogWydVbmRlck92ZXInLCAnMjNERCddLFxuICAgIG92ZXJyaWdodGFycm93OiBbJ1VuZGVyT3ZlcicsICcyMTkyJ10sXG4gICAgdW5kZXJyaWdodGFycm93OiBbJ1VuZGVyT3ZlcicsICcyMTkyJ10sXG4gICAgb3ZlcmxlZnRhcnJvdzogWydVbmRlck92ZXInLCAnMjE5MCddLFxuICAgIHVuZGVybGVmdGFycm93OiBbJ1VuZGVyT3ZlcicsICcyMTkwJ10sXG4gICAgb3ZlcmxlZnRyaWdodGFycm93OiBbJ1VuZGVyT3ZlcicsICcyMTk0J10sXG4gICAgdW5kZXJsZWZ0cmlnaHRhcnJvdzogWydVbmRlck92ZXInLCAnMjE5NCddLFxuICAgIG92ZXJzZXQ6ICdPdmVyc2V0JyxcbiAgICB1bmRlcnNldDogJ1VuZGVyc2V0JyxcbiAgICBvdmVydW5kZXJzZXQ6ICdPdmVydW5kZXJzZXQnLFxuICAgIHN0YWNrcmVsOiBbJ01hY3JvJywgJ1xcXFxtYXRocmVse1xcXFxtYXRob3B7IzJ9XFxcXGxpbWl0c157IzF9fScsIDJdLFxuICAgIHN0YWNrYmluOiBbJ01hY3JvJywgJ1xcXFxtYXRoYmlue1xcXFxtYXRob3B7IzJ9XFxcXGxpbWl0c157IzF9fScsIDJdLFxuICAgIG92ZXI6ICdPdmVyJyxcbiAgICBvdmVyd2l0aGRlbGltczogJ092ZXInLFxuICAgIGF0b3A6ICdPdmVyJyxcbiAgICBhdG9wd2l0aGRlbGltczogJ092ZXInLFxuICAgIGFib3ZlOiAnT3ZlcicsXG4gICAgYWJvdmV3aXRoZGVsaW1zOiAnT3ZlcicsXG4gICAgYnJhY2U6IFsnT3ZlcicsICd7JywgJ30nXSxcbiAgICBicmFjazogWydPdmVyJywgJ1snLCAnXSddLFxuICAgIGNob29zZTogWydPdmVyJywgJygnLCAnKSddLFxuICAgIGZyYWM6ICdGcmFjJyxcbiAgICBzcXJ0OiAnU3FydCcsXG4gICAgcm9vdDogJ1Jvb3QnLFxuICAgIHVwcm9vdDogWydNb3ZlUm9vdCcsICd1cFJvb3QnXSxcbiAgICBsZWZ0cm9vdDogWydNb3ZlUm9vdCcsICdsZWZ0Um9vdCddLFxuICAgIGxlZnQ6ICdMZWZ0UmlnaHQnLFxuICAgIHJpZ2h0OiAnTGVmdFJpZ2h0JyxcbiAgICBtaWRkbGU6ICdMZWZ0UmlnaHQnLFxuICAgIGxsYXA6ICdMYXAnLFxuICAgIHJsYXA6ICdMYXAnLFxuICAgIHJhaXNlOiAnUmFpc2VMb3dlcicsXG4gICAgbG93ZXI6ICdSYWlzZUxvd2VyJyxcbiAgICBtb3ZlbGVmdDogJ01vdmVMZWZ0UmlnaHQnLFxuICAgIG1vdmVyaWdodDogJ01vdmVMZWZ0UmlnaHQnLFxuICAgICcsJzogWydTcGFjZXInLCBsZW5ndGhzX2pzXzEuTUFUSFNQQUNFLnRoaW5tYXRoc3BhY2VdLFxuICAgICc6JzogWydTcGFjZXInLCBsZW5ndGhzX2pzXzEuTUFUSFNQQUNFLm1lZGl1bW1hdGhzcGFjZV0sXG4gICAgJz4nOiBbJ1NwYWNlcicsIGxlbmd0aHNfanNfMS5NQVRIU1BBQ0UubWVkaXVtbWF0aHNwYWNlXSxcbiAgICAnOyc6IFsnU3BhY2VyJywgbGVuZ3Roc19qc18xLk1BVEhTUEFDRS50aGlja21hdGhzcGFjZV0sXG4gICAgJyEnOiBbJ1NwYWNlcicsIGxlbmd0aHNfanNfMS5NQVRIU1BBQ0UubmVnYXRpdmV0aGlubWF0aHNwYWNlXSxcbiAgICBlbnNwYWNlOiBbJ1NwYWNlcicsIC41XSxcbiAgICBxdWFkOiBbJ1NwYWNlcicsIDFdLFxuICAgIHFxdWFkOiBbJ1NwYWNlcicsIDJdLFxuICAgIHRoaW5zcGFjZTogWydTcGFjZXInLCBsZW5ndGhzX2pzXzEuTUFUSFNQQUNFLnRoaW5tYXRoc3BhY2VdLFxuICAgIG5lZ3RoaW5zcGFjZTogWydTcGFjZXInLCBsZW5ndGhzX2pzXzEuTUFUSFNQQUNFLm5lZ2F0aXZldGhpbm1hdGhzcGFjZV0sXG4gICAgaHNraXA6ICdIc2tpcCcsXG4gICAgaHNwYWNlOiAnSHNraXAnLFxuICAgIGtlcm46ICdIc2tpcCcsXG4gICAgbXNraXA6ICdIc2tpcCcsXG4gICAgbXNwYWNlOiAnSHNraXAnLFxuICAgIG1rZXJuOiAnSHNraXAnLFxuICAgIHJ1bGU6ICdydWxlJyxcbiAgICBSdWxlOiBbJ1J1bGUnXSxcbiAgICBTcGFjZTogWydSdWxlJywgJ2JsYW5rJ10sXG4gICAgbm9uc2NyaXB0OiAnTm9uc2NyaXB0JyxcbiAgICBiaWc6IFsnTWFrZUJpZycsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUkQsIDAuODVdLFxuICAgIEJpZzogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRCwgMS4xNV0sXG4gICAgYmlnZzogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRCwgMS40NV0sXG4gICAgQmlnZzogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRCwgMS43NV0sXG4gICAgYmlnbDogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QRU4sIDAuODVdLFxuICAgIEJpZ2w6IFsnTWFrZUJpZycsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUEVOLCAxLjE1XSxcbiAgICBiaWdnbDogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QRU4sIDEuNDVdLFxuICAgIEJpZ2dsOiBbJ01ha2VCaWcnLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1BFTiwgMS43NV0sXG4gICAgYmlncjogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLkNMT1NFLCAwLjg1XSxcbiAgICBCaWdyOiBbJ01ha2VCaWcnLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuQ0xPU0UsIDEuMTVdLFxuICAgIGJpZ2dyOiBbJ01ha2VCaWcnLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuQ0xPU0UsIDEuNDVdLFxuICAgIEJpZ2dyOiBbJ01ha2VCaWcnLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuQ0xPU0UsIDEuNzVdLFxuICAgIGJpZ206IFsnTWFrZUJpZycsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5SRUwsIDAuODVdLFxuICAgIEJpZ206IFsnTWFrZUJpZycsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5SRUwsIDEuMTVdLFxuICAgIGJpZ2dtOiBbJ01ha2VCaWcnLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuUkVMLCAxLjQ1XSxcbiAgICBCaWdnbTogWydNYWtlQmlnJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLlJFTCwgMS43NV0sXG4gICAgbWF0aG9yZDogWydUZVhBdG9tJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRF0sXG4gICAgbWF0aG9wOiBbJ1RlWEF0b20nLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1BdLFxuICAgIG1hdGhvcGVuOiBbJ1RlWEF0b20nLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1BFTl0sXG4gICAgbWF0aGNsb3NlOiBbJ1RlWEF0b20nLCBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuQ0xPU0VdLFxuICAgIG1hdGhiaW46IFsnVGVYQXRvbScsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5CSU5dLFxuICAgIG1hdGhyZWw6IFsnVGVYQXRvbScsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5SRUxdLFxuICAgIG1hdGhwdW5jdDogWydUZVhBdG9tJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLlBVTkNUXSxcbiAgICBtYXRoaW5uZXI6IFsnVGVYQXRvbScsIE1tbE5vZGVfanNfMS5URVhDTEFTUy5JTk5FUl0sXG4gICAgdmNlbnRlcjogWydUZVhBdG9tJywgTW1sTm9kZV9qc18xLlRFWENMQVNTLlZDRU5URVJdLFxuICAgIGJ1aWxkcmVsOiAnQnVpbGRSZWwnLFxuICAgIGhib3g6IFsnSEJveCcsIDBdLFxuICAgIHRleHQ6ICdIQm94JyxcbiAgICBtYm94OiBbJ0hCb3gnLCAwXSxcbiAgICBmYm94OiAnRkJveCcsXG4gICAgYm94ZWQ6IFsnTWFjcm8nLCAnXFxcXGZib3h7JFxcXFxkaXNwbGF5c3R5bGV7IzF9JH0nLCAxXSxcbiAgICBmcmFtZWJveDogJ0ZyYW1lQm94JyxcbiAgICBzdHJ1dDogJ1N0cnV0JyxcbiAgICBtYXRoc3RydXQ6IFsnTWFjcm8nLCAnXFxcXHZwaGFudG9teyh9J10sXG4gICAgcGhhbnRvbTogJ1BoYW50b20nLFxuICAgIHZwaGFudG9tOiBbJ1BoYW50b20nLCAxLCAwXSxcbiAgICBocGhhbnRvbTogWydQaGFudG9tJywgMCwgMV0sXG4gICAgc21hc2g6ICdTbWFzaCcsXG4gICAgYWN1dGU6IFsnQWNjZW50JywgJzAwQjQnXSxcbiAgICBncmF2ZTogWydBY2NlbnQnLCAnMDA2MCddLFxuICAgIGRkb3Q6IFsnQWNjZW50JywgJzAwQTgnXSxcbiAgICB0aWxkZTogWydBY2NlbnQnLCAnMDA3RSddLFxuICAgIGJhcjogWydBY2NlbnQnLCAnMDBBRiddLFxuICAgIGJyZXZlOiBbJ0FjY2VudCcsICcwMkQ4J10sXG4gICAgY2hlY2s6IFsnQWNjZW50JywgJzAyQzcnXSxcbiAgICBoYXQ6IFsnQWNjZW50JywgJzAwNUUnXSxcbiAgICB2ZWM6IFsnQWNjZW50JywgJzIxOTInXSxcbiAgICBkb3Q6IFsnQWNjZW50JywgJzAyRDknXSxcbiAgICB3aWRldGlsZGU6IFsnQWNjZW50JywgJzAwN0UnLCAxXSxcbiAgICB3aWRlaGF0OiBbJ0FjY2VudCcsICcwMDVFJywgMV0sXG4gICAgbWF0cml4OiAnTWF0cml4JyxcbiAgICBhcnJheTogJ01hdHJpeCcsXG4gICAgcG1hdHJpeDogWydNYXRyaXgnLCAnKCcsICcpJ10sXG4gICAgY2FzZXM6IFsnTWF0cml4JywgJ3snLCAnJywgJ2xlZnQgbGVmdCcsIG51bGwsICcuMWVtJywgbnVsbCxcbiAgICAgICAgdHJ1ZV0sXG4gICAgZXFhbGlnbjogWydNYXRyaXgnLCBudWxsLCBudWxsLCAncmlnaHQgbGVmdCcsXG4gICAgICAgICgwLCBsZW5ndGhzX2pzXzEuZW0pKGxlbmd0aHNfanNfMS5NQVRIU1BBQ0UudGhpY2ttYXRoc3BhY2UpLCAnLjVlbScsICdEJ10sXG4gICAgZGlzcGxheWxpbmVzOiBbJ01hdHJpeCcsIG51bGwsIG51bGwsICdjZW50ZXInLCBudWxsLCAnLjVlbScsICdEJ10sXG4gICAgY3I6ICdDcicsXG4gICAgJ1xcXFwnOiAnQ3JMYVRlWCcsXG4gICAgbmV3bGluZTogWydDckxhVGVYJywgdHJ1ZV0sXG4gICAgaGxpbmU6IFsnSExpbmUnLCAnc29saWQnXSxcbiAgICBoZGFzaGxpbmU6IFsnSExpbmUnLCAnZGFzaGVkJ10sXG4gICAgZXFhbGlnbm5vOiBbJ01hdHJpeCcsIG51bGwsIG51bGwsICdyaWdodCBsZWZ0JyxcbiAgICAgICAgKDAsIGxlbmd0aHNfanNfMS5lbSkobGVuZ3Roc19qc18xLk1BVEhTUEFDRS50aGlja21hdGhzcGFjZSksICcuNWVtJywgJ0QnLCBudWxsLFxuICAgICAgICAncmlnaHQnXSxcbiAgICBsZXFhbGlnbm5vOiBbJ01hdHJpeCcsIG51bGwsIG51bGwsICdyaWdodCBsZWZ0JyxcbiAgICAgICAgKDAsIGxlbmd0aHNfanNfMS5lbSkobGVuZ3Roc19qc18xLk1BVEhTUEFDRS50aGlja21hdGhzcGFjZSksICcuNWVtJywgJ0QnLCBudWxsLFxuICAgICAgICAnbGVmdCddLFxuICAgIGhmaWxsOiAnSEZpbGwnLFxuICAgIGhmaWw6ICdIRmlsbCcsXG4gICAgaGZpbGxsOiAnSEZpbGwnLFxuICAgIGJtb2Q6IFsnTWFjcm8nLCAnXFxcXG1tbFRva2Vue21vfVtsc3BhY2U9XCJ0aGlja21hdGhzcGFjZVwiJyArXG4gICAgICAgICAgICAnIHJzcGFjZT1cInRoaWNrbWF0aHNwYWNlXCJde21vZH0nXSxcbiAgICBwbW9kOiBbJ01hY3JvJywgJ1xcXFxwb2R7XFxcXG1tbFRva2Vue21pfXttb2R9XFxcXGtlcm4gNm11ICMxfScsIDFdLFxuICAgIG1vZDogWydNYWNybycsICdcXFxcbWF0aGNob2ljZXtcXFxca2VybjE4bXV9e1xcXFxrZXJuMTJtdX0nICtcbiAgICAgICAgICAgICd7XFxcXGtlcm4xMm11fXtcXFxca2VybjEybXV9XFxcXG1tbFRva2Vue21pfXttb2R9XFxcXCxcXFxcLCMxJyxcbiAgICAgICAgMV0sXG4gICAgcG9kOiBbJ01hY3JvJywgJ1xcXFxtYXRoY2hvaWNle1xcXFxrZXJuMThtdX17XFxcXGtlcm44bXV9JyArXG4gICAgICAgICAgICAne1xcXFxrZXJuOG11fXtcXFxca2VybjhtdX0oIzEpJywgMV0sXG4gICAgaWZmOiBbJ01hY3JvJywgJ1xcXFw7XFxcXExvbmdsZWZ0cmlnaHRhcnJvd1xcXFw7J10sXG4gICAgc2tldzogWydNYWNybycsICd7eyMyeyMzXFxcXG1rZXJuIzFtdX1cXFxcbWtlcm4tIzFtdX17fX0nLCAzXSxcbiAgICBwbWI6IFsnTWFjcm8nLCAnXFxcXHJsYXB7IzF9XFxcXGtlcm4xcHh7IzF9JywgMV0sXG4gICAgVGVYOiBbJ01hY3JvJywgJ1RcXFxca2Vybi0uMTRlbVxcXFxsb3dlci41ZXh7RX1cXFxca2Vybi0uMTE1ZW0gWCddLFxuICAgIExhVGVYOiBbJ01hY3JvJywgJ0xcXFxca2Vybi0uMzI1ZW1cXFxccmFpc2UuMjFlbScgK1xuICAgICAgICAgICAgJ3tcXFxcc2NyaXB0c3R5bGV7QX19XFxcXGtlcm4tLjE3ZW1cXFxcVGVYJ10sXG4gICAgJyAnOiBbJ01hY3JvJywgJ1xcXFx0ZXh0eyB9J10sXG4gICAgbm90OiAnTm90JyxcbiAgICBkb3RzOiAnRG90cycsXG4gICAgc3BhY2U6ICdUaWxkZScsXG4gICAgJ1xcdTAwQTAnOiAnVGlsZGUnLFxuICAgIGJlZ2luOiAnQmVnaW5FbmQnLFxuICAgIGVuZDogJ0JlZ2luRW5kJyxcbiAgICBsYWJlbDogJ0hhbmRsZUxhYmVsJyxcbiAgICByZWY6ICdIYW5kbGVSZWYnLFxuICAgIG5vbnVtYmVyOiAnSGFuZGxlTm9UYWcnLFxuICAgIG1hdGhjaG9pY2U6ICdNYXRoQ2hvaWNlJyxcbiAgICBtbWxUb2tlbjogJ01tbFRva2VuJ1xufSwgQmFzZU1ldGhvZHNfanNfMS5kZWZhdWx0KTtcbm5ldyBzbS5FbnZpcm9ubWVudE1hcCgnZW52aXJvbm1lbnQnLCBQYXJzZU1ldGhvZHNfanNfMS5kZWZhdWx0LmVudmlyb25tZW50LCB7XG4gICAgYXJyYXk6IFsnQWxpZ25lZEFycmF5J10sXG4gICAgZXF1YXRpb246IFsnRXF1YXRpb24nLCBudWxsLCB0cnVlXSxcbiAgICBlcW5hcnJheTogWydFcW5BcnJheScsIG51bGwsIHRydWUsIHRydWUsICdyY2wnLFxuICAgICAgICBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmNvbHMoMCwgbGVuZ3Roc19qc18xLk1BVEhTUEFDRS50aGlja21hdGhzcGFjZSksICcuNWVtJ11cbn0sIEJhc2VNZXRob2RzX2pzXzEuZGVmYXVsdCk7XG5uZXcgc20uQ2hhcmFjdGVyTWFwKCdub3RfcmVtYXAnLCBudWxsLCB7XG4gICAgJ1xcdTIxOTAnOiAnXFx1MjE5QScsXG4gICAgJ1xcdTIxOTInOiAnXFx1MjE5QicsXG4gICAgJ1xcdTIxOTQnOiAnXFx1MjFBRScsXG4gICAgJ1xcdTIxRDAnOiAnXFx1MjFDRCcsXG4gICAgJ1xcdTIxRDInOiAnXFx1MjFDRicsXG4gICAgJ1xcdTIxRDQnOiAnXFx1MjFDRScsXG4gICAgJ1xcdTIyMDgnOiAnXFx1MjIwOScsXG4gICAgJ1xcdTIyMEInOiAnXFx1MjIwQycsXG4gICAgJ1xcdTIyMjMnOiAnXFx1MjIyNCcsXG4gICAgJ1xcdTIyMjUnOiAnXFx1MjIyNicsXG4gICAgJ1xcdTIyM0MnOiAnXFx1MjI0MScsXG4gICAgJ1xcdTAwN0UnOiAnXFx1MjI0MScsXG4gICAgJ1xcdTIyNDMnOiAnXFx1MjI0NCcsXG4gICAgJ1xcdTIyNDUnOiAnXFx1MjI0NycsXG4gICAgJ1xcdTIyNDgnOiAnXFx1MjI0OScsXG4gICAgJ1xcdTIyNEQnOiAnXFx1MjI2RCcsXG4gICAgJ1xcdTAwM0QnOiAnXFx1MjI2MCcsXG4gICAgJ1xcdTIyNjEnOiAnXFx1MjI2MicsXG4gICAgJ1xcdTAwM0MnOiAnXFx1MjI2RScsXG4gICAgJ1xcdTAwM0UnOiAnXFx1MjI2RicsXG4gICAgJ1xcdTIyNjQnOiAnXFx1MjI3MCcsXG4gICAgJ1xcdTIyNjUnOiAnXFx1MjI3MScsXG4gICAgJ1xcdTIyNzInOiAnXFx1MjI3NCcsXG4gICAgJ1xcdTIyNzMnOiAnXFx1MjI3NScsXG4gICAgJ1xcdTIyNzYnOiAnXFx1MjI3OCcsXG4gICAgJ1xcdTIyNzcnOiAnXFx1MjI3OScsXG4gICAgJ1xcdTIyN0EnOiAnXFx1MjI4MCcsXG4gICAgJ1xcdTIyN0InOiAnXFx1MjI4MScsXG4gICAgJ1xcdTIyODInOiAnXFx1MjI4NCcsXG4gICAgJ1xcdTIyODMnOiAnXFx1MjI4NScsXG4gICAgJ1xcdTIyODYnOiAnXFx1MjI4OCcsXG4gICAgJ1xcdTIyODcnOiAnXFx1MjI4OScsXG4gICAgJ1xcdTIyQTInOiAnXFx1MjJBQycsXG4gICAgJ1xcdTIyQTgnOiAnXFx1MjJBRCcsXG4gICAgJ1xcdTIyQTknOiAnXFx1MjJBRScsXG4gICAgJ1xcdTIyQUInOiAnXFx1MjJBRicsXG4gICAgJ1xcdTIyN0MnOiAnXFx1MjJFMCcsXG4gICAgJ1xcdTIyN0QnOiAnXFx1MjJFMScsXG4gICAgJ1xcdTIyOTEnOiAnXFx1MjJFMicsXG4gICAgJ1xcdTIyOTInOiAnXFx1MjJFMycsXG4gICAgJ1xcdTIyQjInOiAnXFx1MjJFQScsXG4gICAgJ1xcdTIyQjMnOiAnXFx1MjJFQicsXG4gICAgJ1xcdTIyQjQnOiAnXFx1MjJFQycsXG4gICAgJ1xcdTIyQjUnOiAnXFx1MjJFRCcsXG4gICAgJ1xcdTIyMDMnOiAnXFx1MjIwNCdcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QmFzZU1hcHBpbmdzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fYXNzaWduID0gKHRoaXMgJiYgdGhpcy5fX2Fzc2lnbikgfHwgZnVuY3Rpb24gKCkge1xuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7XG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSlcbiAgICAgICAgICAgICAgICB0W3BdID0gc1twXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9O1xuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihtLCBrKTtcbiAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX3NldE1vZHVsZURlZmF1bHQpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59KTtcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xudmFyIF9fcmVhZCA9ICh0aGlzICYmIHRoaXMuX19yZWFkKSB8fCBmdW5jdGlvbiAobywgbikge1xuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcbiAgICBpZiAoIW0pIHJldHVybiBvO1xuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xuICAgIHRyeSB7XG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cbiAgICBmaW5hbGx5IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxuICAgIH1cbiAgICByZXR1cm4gYXI7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNpdGVtID0gX19pbXBvcnRTdGFyKHJlcXVpcmUoXCIuL0Jhc2VJdGVtcy5qc1wiKSk7XG52YXIgTm9kZVV0aWxfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vTm9kZVV0aWwuanNcIikpO1xudmFyIFRleEVycm9yX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL1RleEVycm9yLmpzXCIpKTtcbnZhciBUZXhQYXJzZXJfanNfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiLi4vVGV4UGFyc2VyLmpzXCIpKTtcbnZhciBUZXhDb25zdGFudHNfanNfMSA9IHJlcXVpcmUoXCIuLi9UZXhDb25zdGFudHMuanNcIik7XG52YXIgUGFyc2VVdGlsX2pzXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4uL1BhcnNlVXRpbC5qc1wiKSk7XG52YXIgTW1sTm9kZV9qc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NvcmUvTW1sVHJlZS9NbWxOb2RlLmpzXCIpO1xudmFyIFRhZ3NfanNfMSA9IHJlcXVpcmUoXCIuLi9UYWdzLmpzXCIpO1xudmFyIGxlbmd0aHNfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlsL2xlbmd0aHMuanNcIik7XG52YXIgRW50aXRpZXNfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlsL0VudGl0aWVzLmpzXCIpO1xudmFyIE9wdGlvbnNfanNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlsL09wdGlvbnMuanNcIik7XG52YXIgQmFzZU1ldGhvZHMgPSB7fTtcbnZhciBQX0hFSUdIVCA9IDEuMiAvIC44NTtcbnZhciBNbWxUb2tlbkFsbG93ID0ge1xuICAgIGZvbnRmYW1pbHk6IDEsIGZvbnRzaXplOiAxLCBmb250d2VpZ2h0OiAxLCBmb250c3R5bGU6IDEsXG4gICAgY29sb3I6IDEsIGJhY2tncm91bmQ6IDEsXG4gICAgaWQ6IDEsICdjbGFzcyc6IDEsIGhyZWY6IDEsIHN0eWxlOiAxXG59O1xuQmFzZU1ldGhvZHMuT3BlbiA9IGZ1bmN0aW9uIChwYXJzZXIsIF9jKSB7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnb3BlbicpKTtcbn07XG5CYXNlTWV0aG9kcy5DbG9zZSA9IGZ1bmN0aW9uIChwYXJzZXIsIF9jKSB7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnY2xvc2UnKSk7XG59O1xuQmFzZU1ldGhvZHMuVGlsZGUgPSBmdW5jdGlvbiAocGFyc2VyLCBfYykge1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5jcmVhdGUoJ3Rva2VuJywgJ210ZXh0Jywge30sIEVudGl0aWVzX2pzXzEuZW50aXRpZXMubmJzcCkpO1xufTtcbkJhc2VNZXRob2RzLlNwYWNlID0gZnVuY3Rpb24gKF9wYXJzZXIsIF9jKSB7IH07XG5CYXNlTWV0aG9kcy5TdXBlcnNjcmlwdCA9IGZ1bmN0aW9uIChwYXJzZXIsIF9jKSB7XG4gICAgdmFyIF9hO1xuICAgIGlmIChwYXJzZXIuR2V0TmV4dCgpLm1hdGNoKC9cXGQvKSkge1xuICAgICAgICBwYXJzZXIuc3RyaW5nID0gcGFyc2VyLnN0cmluZy5zdWJzdHIoMCwgcGFyc2VyLmkgKyAxKSArXG4gICAgICAgICAgICAnICcgKyBwYXJzZXIuc3RyaW5nLnN1YnN0cihwYXJzZXIuaSArIDEpO1xuICAgIH1cbiAgICB2YXIgcHJpbWVzO1xuICAgIHZhciBiYXNlO1xuICAgIHZhciB0b3AgPSBwYXJzZXIuc3RhY2suVG9wKCk7XG4gICAgaWYgKHRvcC5pc0tpbmQoJ3ByaW1lJykpIHtcbiAgICAgICAgX2EgPSBfX3JlYWQodG9wLlBlZWsoMiksIDIpLCBiYXNlID0gX2FbMF0sIHByaW1lcyA9IF9hWzFdO1xuICAgICAgICBwYXJzZXIuc3RhY2suUG9wKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBiYXNlID0gcGFyc2VyLnN0YWNrLlByZXYoKTtcbiAgICAgICAgaWYgKCFiYXNlKSB7XG4gICAgICAgICAgICBiYXNlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbWknLCB7fSwgJycpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBtb3Zlc3Vwc3ViID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldFByb3BlcnR5KGJhc2UsICdtb3Zlc3Vwc3ViJyk7XG4gICAgdmFyIHBvc2l0aW9uID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1YnN1cCcpID8gYmFzZS5zdXAgOlxuICAgICAgICBiYXNlLm92ZXI7XG4gICAgaWYgKChOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtc3Vic3VwJykgJiYgIU5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUoYmFzZSwgJ21zdXAnKSAmJlxuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q2hpbGRBdChiYXNlLCBiYXNlLnN1cCkpIHx8XG4gICAgICAgIChOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtdW5kZXJvdmVyJykgJiYgIU5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUoYmFzZSwgJ21vdmVyJykgJiZcbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZEF0KGJhc2UsIGJhc2Uub3ZlcikgJiZcbiAgICAgICAgICAgICFOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0UHJvcGVydHkoYmFzZSwgJ3N1YnN1cE9LJykpKSB7XG4gICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ0RvdWJsZUV4cG9uZW50JywgJ0RvdWJsZSBleHBvbmVudDogdXNlIGJyYWNlcyB0byBjbGFyaWZ5Jyk7XG4gICAgfVxuICAgIGlmICghTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1YnN1cCcpIHx8IE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUoYmFzZSwgJ21zdXAnKSkge1xuICAgICAgICBpZiAobW92ZXN1cHN1Yikge1xuICAgICAgICAgICAgaWYgKCFOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtdW5kZXJvdmVyJykgfHwgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbW92ZXInKSB8fFxuICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZEF0KGJhc2UsIGJhc2Uub3ZlcikpIHtcbiAgICAgICAgICAgICAgICBiYXNlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtdW5kZXJvdmVyJywgW2Jhc2VdLCB7IG1vdmVzdXBzdWI6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGJhc2Uub3ZlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJhc2UgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21zdWJzdXAnLCBbYmFzZV0pO1xuICAgICAgICAgICAgcG9zaXRpb24gPSBiYXNlLnN1cDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwYXJzZXIuUHVzaChwYXJzZXIuaXRlbUZhY3RvcnkuY3JlYXRlKCdzdWJzdXAnLCBiYXNlKS5zZXRQcm9wZXJ0aWVzKHtcbiAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLCBwcmltZXM6IHByaW1lcywgbW92ZXN1cHN1YjogbW92ZXN1cHN1YlxuICAgIH0pKTtcbn07XG5CYXNlTWV0aG9kcy5TdWJzY3JpcHQgPSBmdW5jdGlvbiAocGFyc2VyLCBfYykge1xuICAgIHZhciBfYTtcbiAgICBpZiAocGFyc2VyLkdldE5leHQoKS5tYXRjaCgvXFxkLykpIHtcbiAgICAgICAgcGFyc2VyLnN0cmluZyA9XG4gICAgICAgICAgICBwYXJzZXIuc3RyaW5nLnN1YnN0cigwLCBwYXJzZXIuaSArIDEpICsgJyAnICtcbiAgICAgICAgICAgICAgICBwYXJzZXIuc3RyaW5nLnN1YnN0cihwYXJzZXIuaSArIDEpO1xuICAgIH1cbiAgICB2YXIgcHJpbWVzLCBiYXNlO1xuICAgIHZhciB0b3AgPSBwYXJzZXIuc3RhY2suVG9wKCk7XG4gICAgaWYgKHRvcC5pc0tpbmQoJ3ByaW1lJykpIHtcbiAgICAgICAgX2EgPSBfX3JlYWQodG9wLlBlZWsoMiksIDIpLCBiYXNlID0gX2FbMF0sIHByaW1lcyA9IF9hWzFdO1xuICAgICAgICBwYXJzZXIuc3RhY2suUG9wKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBiYXNlID0gcGFyc2VyLnN0YWNrLlByZXYoKTtcbiAgICAgICAgaWYgKCFiYXNlKSB7XG4gICAgICAgICAgICBiYXNlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbWknLCB7fSwgJycpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBtb3Zlc3Vwc3ViID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldFByb3BlcnR5KGJhc2UsICdtb3Zlc3Vwc3ViJyk7XG4gICAgdmFyIHBvc2l0aW9uID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1YnN1cCcpID9cbiAgICAgICAgYmFzZS5zdWIgOiBiYXNlLnVuZGVyO1xuICAgIGlmICgoTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1YnN1cCcpICYmICFOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtc3VwJykgJiZcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldENoaWxkQXQoYmFzZSwgYmFzZS5zdWIpKSB8fFxuICAgICAgICAoTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXVuZGVyb3ZlcicpICYmICFOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtb3ZlcicpICYmXG4gICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q2hpbGRBdChiYXNlLCBiYXNlLnVuZGVyKSAmJlxuICAgICAgICAgICAgIU5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRQcm9wZXJ0eShiYXNlLCAnc3Vic3VwT0snKSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnRG91YmxlU3Vic2NyaXB0cycsICdEb3VibGUgc3Vic2NyaXB0czogdXNlIGJyYWNlcyB0byBjbGFyaWZ5Jyk7XG4gICAgfVxuICAgIGlmICghTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1YnN1cCcpIHx8IE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUoYmFzZSwgJ21zdXAnKSkge1xuICAgICAgICBpZiAobW92ZXN1cHN1Yikge1xuICAgICAgICAgICAgaWYgKCFOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKGJhc2UsICdtdW5kZXJvdmVyJykgfHwgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbW92ZXInKSB8fFxuICAgICAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZEF0KGJhc2UsIGJhc2UudW5kZXIpKSB7XG4gICAgICAgICAgICAgICAgYmFzZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXVuZGVyb3ZlcicsIFtiYXNlXSwgeyBtb3Zlc3Vwc3ViOiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcG9zaXRpb24gPSBiYXNlLnVuZGVyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmFzZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXN1YnN1cCcsIFtiYXNlXSk7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IGJhc2Uuc3ViO1xuICAgICAgICB9XG4gICAgfVxuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ3N1YnN1cCcsIGJhc2UpLnNldFByb3BlcnRpZXMoe1xuICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sIHByaW1lczogcHJpbWVzLCBtb3Zlc3Vwc3ViOiBtb3Zlc3Vwc3ViXG4gICAgfSkpO1xufTtcbkJhc2VNZXRob2RzLlByaW1lID0gZnVuY3Rpb24gKHBhcnNlciwgYykge1xuICAgIHZhciBiYXNlID0gcGFyc2VyLnN0YWNrLlByZXYoKTtcbiAgICBpZiAoIWJhc2UpIHtcbiAgICAgICAgYmFzZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbWknKTtcbiAgICB9XG4gICAgaWYgKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUoYmFzZSwgJ21zdWJzdXAnKSAmJiAhTm9kZVV0aWxfanNfMS5kZWZhdWx0LmlzVHlwZShiYXNlLCAnbXN1cCcpICYmXG4gICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDaGlsZEF0KGJhc2UsIGJhc2Uuc3VwKSkge1xuICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdEb3VibGVFeHBvbmVudFByaW1lJywgJ1ByaW1lIGNhdXNlcyBkb3VibGUgZXhwb25lbnQ6IHVzZSBicmFjZXMgdG8gY2xhcmlmeScpO1xuICAgIH1cbiAgICB2YXIgc3VwID0gJyc7XG4gICAgcGFyc2VyLmktLTtcbiAgICBkbyB7XG4gICAgICAgIHN1cCArPSBFbnRpdGllc19qc18xLmVudGl0aWVzLnByaW1lO1xuICAgICAgICBwYXJzZXIuaSsrLCBjID0gcGFyc2VyLkdldE5leHQoKTtcbiAgICB9IHdoaWxlIChjID09PSAnXFwnJyB8fCBjID09PSBFbnRpdGllc19qc18xLmVudGl0aWVzLnJzcXVvKTtcbiAgICBzdXAgPSBbJycsICdcXHUyMDMyJywgJ1xcdTIwMzMnLCAnXFx1MjAzNCcsICdcXHUyMDU3J11bc3VwLmxlbmd0aF0gfHwgc3VwO1xuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbW8nLCB7IHZhcmlhbnRGb3JtOiB0cnVlIH0sIHN1cCk7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgncHJpbWUnLCBiYXNlLCBub2RlKSk7XG59O1xuQmFzZU1ldGhvZHMuQ29tbWVudCA9IGZ1bmN0aW9uIChwYXJzZXIsIF9jKSB7XG4gICAgd2hpbGUgKHBhcnNlci5pIDwgcGFyc2VyLnN0cmluZy5sZW5ndGggJiYgcGFyc2VyLnN0cmluZy5jaGFyQXQocGFyc2VyLmkpICE9PSAnXFxuJykge1xuICAgICAgICBwYXJzZXIuaSsrO1xuICAgIH1cbn07XG5CYXNlTWV0aG9kcy5IYXNoID0gZnVuY3Rpb24gKF9wYXJzZXIsIF9jKSB7XG4gICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnQ2FudFVzZUhhc2gxJywgJ1lvdSBjYW5cXCd0IHVzZSBcXCdtYWNybyBwYXJhbWV0ZXIgY2hhcmFjdGVyICNcXCcgaW4gbWF0aCBtb2RlJyk7XG59O1xuQmFzZU1ldGhvZHMuTWF0aEZvbnQgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCB2YXJpYW50KSB7XG4gICAgdmFyIHRleHQgPSBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSk7XG4gICAgdmFyIG1tbCA9IG5ldyBUZXhQYXJzZXJfanNfMS5kZWZhdWx0KHRleHQsIF9fYXNzaWduKF9fYXNzaWduKHt9LCBwYXJzZXIuc3RhY2suZW52KSwgeyBmb250OiB2YXJpYW50LCBtdWx0aUxldHRlcklkZW50aWZpZXJzOiAvXlthLXpBLVpdKy8sIG5vQXV0b09QOiB0cnVlIH0pLCBwYXJzZXIuY29uZmlndXJhdGlvbikubW1sKCk7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW21tbF0pKTtcbn07XG5CYXNlTWV0aG9kcy5TZXRGb250ID0gZnVuY3Rpb24gKHBhcnNlciwgX25hbWUsIGZvbnQpIHtcbiAgICBwYXJzZXIuc3RhY2suZW52Wydmb250J10gPSBmb250O1xufTtcbkJhc2VNZXRob2RzLlNldFN0eWxlID0gZnVuY3Rpb24gKHBhcnNlciwgX25hbWUsIHRleFN0eWxlLCBzdHlsZSwgbGV2ZWwpIHtcbiAgICBwYXJzZXIuc3RhY2suZW52WydzdHlsZSddID0gdGV4U3R5bGU7XG4gICAgcGFyc2VyLnN0YWNrLmVudlsnbGV2ZWwnXSA9IGxldmVsO1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ3N0eWxlJykuc2V0UHJvcGVydHkoJ3N0eWxlcycsIHsgZGlzcGxheXN0eWxlOiBzdHlsZSwgc2NyaXB0bGV2ZWw6IGxldmVsIH0pKTtcbn07XG5CYXNlTWV0aG9kcy5TZXRTaXplID0gZnVuY3Rpb24gKHBhcnNlciwgX25hbWUsIHNpemUpIHtcbiAgICBwYXJzZXIuc3RhY2suZW52WydzaXplJ10gPSBzaXplO1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ3N0eWxlJykuc2V0UHJvcGVydHkoJ3N0eWxlcycsIHsgbWF0aHNpemU6ICgwLCBsZW5ndGhzX2pzXzEuZW0pKHNpemUpIH0pKTtcbn07XG5CYXNlTWV0aG9kcy5TcGFjZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBfbmFtZSwgc3BhY2UpIHtcbiAgICB2YXIgbm9kZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXNwYWNlJywgW10sIHsgd2lkdGg6ICgwLCBsZW5ndGhzX2pzXzEuZW0pKHNwYWNlKSB9KTtcbiAgICB2YXIgc3R5bGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21zdHlsZScsIFtub2RlXSwgeyBzY3JpcHRsZXZlbDogMCB9KTtcbiAgICBwYXJzZXIuUHVzaChzdHlsZSk7XG59O1xuQmFzZU1ldGhvZHMuTGVmdFJpZ2h0ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBmaXJzdCA9IG5hbWUuc3Vic3RyKDEpO1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoZmlyc3QsIHBhcnNlci5HZXREZWxpbWl0ZXIobmFtZSksIHBhcnNlci5zdGFjay5lbnYuY29sb3IpKTtcbn07XG5CYXNlTWV0aG9kcy5OYW1lZEZuID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgaWQpIHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICAgIGlkID0gbmFtZS5zdWJzdHIoMSk7XG4gICAgfVxuICAgIHZhciBtbWwgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtaScsIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5PUCB9LCBpZCk7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnZm4nLCBtbWwpKTtcbn07XG5CYXNlTWV0aG9kcy5OYW1lZE9wID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgaWQpIHtcbiAgICBpZiAoIWlkKSB7XG4gICAgICAgIGlkID0gbmFtZS5zdWJzdHIoMSk7XG4gICAgfVxuICAgIGlkID0gaWQucmVwbGFjZSgvJnRoaW5zcDsvLCAnXFx1MjAwNicpO1xuICAgIHZhciBtbWwgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtbycsIHtcbiAgICAgICAgbW92YWJsZWxpbWl0czogdHJ1ZSxcbiAgICAgICAgbW92ZXN1cHN1YjogdHJ1ZSxcbiAgICAgICAgZm9ybTogVGV4Q29uc3RhbnRzX2pzXzEuVGV4Q29uc3RhbnQuRm9ybS5QUkVGSVgsXG4gICAgICAgIHRleENsYXNzOiBNbWxOb2RlX2pzXzEuVEVYQ0xBU1MuT1BcbiAgICB9LCBpZCk7XG4gICAgcGFyc2VyLlB1c2gobW1sKTtcbn07XG5CYXNlTWV0aG9kcy5MaW1pdHMgPSBmdW5jdGlvbiAocGFyc2VyLCBfbmFtZSwgbGltaXRzKSB7XG4gICAgdmFyIG9wID0gcGFyc2VyLnN0YWNrLlByZXYodHJ1ZSk7XG4gICAgaWYgKCFvcCB8fCAoTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldFRleENsYXNzKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRDb3JlTU8ob3ApKSAhPT0gTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QICYmXG4gICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRQcm9wZXJ0eShvcCwgJ21vdmVzdXBzdWInKSA9PSBudWxsKSkge1xuICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdNaXNwbGFjZWRMaW1pdHMnLCAnJTEgaXMgYWxsb3dlZCBvbmx5IG9uIG9wZXJhdG9ycycsIHBhcnNlci5jdXJyZW50Q1MpO1xuICAgIH1cbiAgICB2YXIgdG9wID0gcGFyc2VyLnN0YWNrLlRvcCgpO1xuICAgIHZhciBub2RlO1xuICAgIGlmIChOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKG9wLCAnbXVuZGVyb3ZlcicpICYmICFsaW1pdHMpIHtcbiAgICAgICAgbm9kZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXN1YnN1cCcpO1xuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuY29weUNoaWxkcmVuKG9wLCBub2RlKTtcbiAgICAgICAgb3AgPSB0b3AuTGFzdCA9IG5vZGU7XG4gICAgfVxuICAgIGVsc2UgaWYgKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc1R5cGUob3AsICdtc3Vic3VwJykgJiYgbGltaXRzKSB7XG4gICAgICAgIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ211bmRlcm92ZXInKTtcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LmNvcHlDaGlsZHJlbihvcCwgbm9kZSk7XG4gICAgICAgIG9wID0gdG9wLkxhc3QgPSBub2RlO1xuICAgIH1cbiAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0UHJvcGVydHkob3AsICdtb3Zlc3Vwc3ViJywgbGltaXRzID8gdHJ1ZSA6IGZhbHNlKTtcbiAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0UHJvcGVydGllcyhOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0Q29yZU1PKG9wKSwgeyAnbW92YWJsZWxpbWl0cyc6IGZhbHNlIH0pO1xuICAgIGlmIChOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0QXR0cmlidXRlKG9wLCAnbW92YWJsZWxpbWl0cycpIHx8XG4gICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5nZXRQcm9wZXJ0eShvcCwgJ21vdmFibGVsaW1pdHMnKSkge1xuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0UHJvcGVydGllcyhvcCwgeyAnbW92YWJsZWxpbWl0cyc6IGZhbHNlIH0pO1xuICAgIH1cbn07XG5CYXNlTWV0aG9kcy5PdmVyID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgb3BlbiwgY2xvc2UpIHtcbiAgICB2YXIgbW1sID0gcGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnb3ZlcicpLnNldFByb3BlcnR5KCduYW1lJywgcGFyc2VyLmN1cnJlbnRDUyk7XG4gICAgaWYgKG9wZW4gfHwgY2xvc2UpIHtcbiAgICAgICAgbW1sLnNldFByb3BlcnR5KCdvcGVuJywgb3Blbik7XG4gICAgICAgIG1tbC5zZXRQcm9wZXJ0eSgnY2xvc2UnLCBjbG9zZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUubWF0Y2goL3dpdGhkZWxpbXMkLykpIHtcbiAgICAgICAgbW1sLnNldFByb3BlcnR5KCdvcGVuJywgcGFyc2VyLkdldERlbGltaXRlcihuYW1lKSk7XG4gICAgICAgIG1tbC5zZXRQcm9wZXJ0eSgnY2xvc2UnLCBwYXJzZXIuR2V0RGVsaW1pdGVyKG5hbWUpKTtcbiAgICB9XG4gICAgaWYgKG5hbWUubWF0Y2goL15cXFxcYWJvdmUvKSkge1xuICAgICAgICBtbWwuc2V0UHJvcGVydHkoJ3RoaWNrbmVzcycsIHBhcnNlci5HZXREaW1lbihuYW1lKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUubWF0Y2goL15cXFxcYXRvcC8pIHx8IG9wZW4gfHwgY2xvc2UpIHtcbiAgICAgICAgbW1sLnNldFByb3BlcnR5KCd0aGlja25lc3MnLCAwKTtcbiAgICB9XG4gICAgcGFyc2VyLlB1c2gobW1sKTtcbn07XG5CYXNlTWV0aG9kcy5GcmFjID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBudW0gPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgdmFyIGRlbiA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICB2YXIgbm9kZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbWZyYWMnLCBbbnVtLCBkZW5dKTtcbiAgICBwYXJzZXIuUHVzaChub2RlKTtcbn07XG5CYXNlTWV0aG9kcy5TcXJ0ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBuID0gcGFyc2VyLkdldEJyYWNrZXRzKG5hbWUpO1xuICAgIHZhciBhcmcgPSBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSk7XG4gICAgaWYgKGFyZyA9PT0gJ1xcXFxmcmFjJykge1xuICAgICAgICBhcmcgKz0gJ3snICsgcGFyc2VyLkdldEFyZ3VtZW50KGFyZykgKyAnfXsnICsgcGFyc2VyLkdldEFyZ3VtZW50KGFyZykgKyAnfSc7XG4gICAgfVxuICAgIHZhciBtbWwgPSBuZXcgVGV4UGFyc2VyX2pzXzEuZGVmYXVsdChhcmcsIHBhcnNlci5zdGFjay5lbnYsIHBhcnNlci5jb25maWd1cmF0aW9uKS5tbWwoKTtcbiAgICBpZiAoIW4pIHtcbiAgICAgICAgbW1sID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtc3FydCcsIFttbWxdKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG1tbCA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXJvb3QnLCBbbW1sLCBwYXJzZVJvb3QocGFyc2VyLCBuKV0pO1xuICAgIH1cbiAgICBwYXJzZXIuUHVzaChtbWwpO1xufTtcbmZ1bmN0aW9uIHBhcnNlUm9vdChwYXJzZXIsIG4pIHtcbiAgICB2YXIgZW52ID0gcGFyc2VyLnN0YWNrLmVudjtcbiAgICB2YXIgaW5Sb290ID0gZW52WydpblJvb3QnXTtcbiAgICBlbnZbJ2luUm9vdCddID0gdHJ1ZTtcbiAgICB2YXIgbmV3UGFyc2VyID0gbmV3IFRleFBhcnNlcl9qc18xLmRlZmF1bHQobiwgZW52LCBwYXJzZXIuY29uZmlndXJhdGlvbik7XG4gICAgdmFyIG5vZGUgPSBuZXdQYXJzZXIubW1sKCk7XG4gICAgdmFyIGdsb2JhbCA9IG5ld1BhcnNlci5zdGFjay5nbG9iYWw7XG4gICAgaWYgKGdsb2JhbFsnbGVmdFJvb3QnXSB8fCBnbG9iYWxbJ3VwUm9vdCddKSB7XG4gICAgICAgIHZhciBkZWYgPSB7fTtcbiAgICAgICAgaWYgKGdsb2JhbFsnbGVmdFJvb3QnXSkge1xuICAgICAgICAgICAgZGVmWyd3aWR0aCddID0gZ2xvYmFsWydsZWZ0Um9vdCddO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnbG9iYWxbJ3VwUm9vdCddKSB7XG4gICAgICAgICAgICBkZWZbJ3ZvZmZzZXQnXSA9IGdsb2JhbFsndXBSb290J107XG4gICAgICAgICAgICBkZWZbJ2hlaWdodCddID0gZ2xvYmFsWyd1cFJvb3QnXTtcbiAgICAgICAgfVxuICAgICAgICBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtcGFkZGVkJywgW25vZGVdLCBkZWYpO1xuICAgIH1cbiAgICBlbnZbJ2luUm9vdCddID0gaW5Sb290O1xuICAgIHJldHVybiBub2RlO1xufVxuQmFzZU1ldGhvZHMuUm9vdCA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICB2YXIgbiA9IHBhcnNlci5HZXRVcFRvKG5hbWUsICdcXFxcb2YnKTtcbiAgICB2YXIgYXJnID0gcGFyc2VyLlBhcnNlQXJnKG5hbWUpO1xuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtcm9vdCcsIFthcmcsIHBhcnNlUm9vdChwYXJzZXIsIG4pXSk7XG4gICAgcGFyc2VyLlB1c2gobm9kZSk7XG59O1xuQmFzZU1ldGhvZHMuTW92ZVJvb3QgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCBpZCkge1xuICAgIGlmICghcGFyc2VyLnN0YWNrLmVudlsnaW5Sb290J10pIHtcbiAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnTWlzcGxhY2VkTW92ZVJvb3QnLCAnJTEgY2FuIGFwcGVhciBvbmx5IHdpdGhpbiBhIHJvb3QnLCBwYXJzZXIuY3VycmVudENTKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlci5zdGFjay5nbG9iYWxbaWRdKSB7XG4gICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ011bHRpcGxlTW92ZVJvb3QnLCAnTXVsdGlwbGUgdXNlIG9mICUxJywgcGFyc2VyLmN1cnJlbnRDUyk7XG4gICAgfVxuICAgIHZhciBuID0gcGFyc2VyLkdldEFyZ3VtZW50KG5hbWUpO1xuICAgIGlmICghbi5tYXRjaCgvLT9bMC05XSsvKSkge1xuICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdJbnRlZ2VyQXJnJywgJ1RoZSBhcmd1bWVudCB0byAlMSBtdXN0IGJlIGFuIGludGVnZXInLCBwYXJzZXIuY3VycmVudENTKTtcbiAgICB9XG4gICAgbiA9IChwYXJzZUludChuLCAxMCkgLyAxNSkgKyAnZW0nO1xuICAgIGlmIChuLnN1YnN0cigwLCAxKSAhPT0gJy0nKSB7XG4gICAgICAgIG4gPSAnKycgKyBuO1xuICAgIH1cbiAgICBwYXJzZXIuc3RhY2suZ2xvYmFsW2lkXSA9IG47XG59O1xuQmFzZU1ldGhvZHMuQWNjZW50ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgYWNjZW50LCBzdHJldGNoeSkge1xuICAgIHZhciBjID0gcGFyc2VyLlBhcnNlQXJnKG5hbWUpO1xuICAgIHZhciBkZWYgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5nZXRGb250RGVmKHBhcnNlcikpLCB7IGFjY2VudDogdHJ1ZSwgbWF0aGFjY2VudDogdHJ1ZSB9KTtcbiAgICB2YXIgZW50aXR5ID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmNyZWF0ZUVudGl0eShhY2NlbnQpO1xuICAgIHZhciBtb05vZGUgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtbycsIGRlZiwgZW50aXR5KTtcbiAgICB2YXIgbW1sID0gbW9Ob2RlO1xuICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUobW1sLCAnc3RyZXRjaHknLCBzdHJldGNoeSA/IHRydWUgOiBmYWxzZSk7XG4gICAgdmFyIG1vID0gKE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5pc0VtYmVsbGlzaGVkKGMpID8gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmdldENvcmVNTyhjKSA6IGMpO1xuICAgIGlmIChOb2RlVXRpbF9qc18xLmRlZmF1bHQuaXNUeXBlKG1vLCAnbW8nKSB8fCBOb2RlVXRpbF9qc18xLmRlZmF1bHQuZ2V0UHJvcGVydHkobW8sICdtb3ZhYmxlbGltaXRzJykpIHtcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldFByb3BlcnRpZXMobW8sIHsgJ21vdmFibGVsaW1pdHMnOiBmYWxzZSB9KTtcbiAgICB9XG4gICAgdmFyIG11b05vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ211bmRlcm92ZXInKTtcbiAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0Q2hpbGQobXVvTm9kZSwgMCwgYyk7XG4gICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldENoaWxkKG11b05vZGUsIDEsIG51bGwpO1xuICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRDaGlsZChtdW9Ob2RlLCAyLCBtbWwpO1xuICAgIHZhciB0ZXhBdG9tID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW211b05vZGVdKTtcbiAgICBwYXJzZXIuUHVzaCh0ZXhBdG9tKTtcbn07XG5CYXNlTWV0aG9kcy5VbmRlck92ZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCBjLCBzdGFjaykge1xuICAgIHZhciBlbnRpdHkgPSBOb2RlVXRpbF9qc18xLmRlZmF1bHQuY3JlYXRlRW50aXR5KGMpO1xuICAgIHZhciBtbyA9IHBhcnNlci5jcmVhdGUoJ3Rva2VuJywgJ21vJywgeyBzdHJldGNoeTogdHJ1ZSwgYWNjZW50OiB0cnVlIH0sIGVudGl0eSk7XG4gICAgdmFyIHBvcyA9IChuYW1lLmNoYXJBdCgxKSA9PT0gJ28nID8gJ292ZXInIDogJ3VuZGVyJyk7XG4gICAgdmFyIGJhc2UgPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgcGFyc2VyLlB1c2goUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC51bmRlck92ZXIocGFyc2VyLCBiYXNlLCBtbywgcG9zLCBzdGFjaykpO1xufTtcbkJhc2VNZXRob2RzLk92ZXJzZXQgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lKSB7XG4gICAgdmFyIHRvcCA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICB2YXIgYmFzZSA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmNoZWNrTW92YWJsZUxpbWl0cyhiYXNlKTtcbiAgICBpZiAodG9wLmlzS2luZCgnbW8nKSkge1xuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKHRvcCwgJ2FjY2VudCcsIGZhbHNlKTtcbiAgICB9XG4gICAgdmFyIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21vdmVyJywgW2Jhc2UsIHRvcF0pO1xuICAgIHBhcnNlci5QdXNoKG5vZGUpO1xufTtcbkJhc2VNZXRob2RzLlVuZGVyc2V0ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBib3QgPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgdmFyIGJhc2UgPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5jaGVja01vdmFibGVMaW1pdHMoYmFzZSk7XG4gICAgaWYgKGJvdC5pc0tpbmQoJ21vJykpIHtcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShib3QsICdhY2NlbnQnLCBmYWxzZSk7XG4gICAgfVxuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtdW5kZXInLCBbYmFzZSwgYm90XSwgeyBhY2NlbnR1bmRlcjogZmFsc2UgfSk7XG4gICAgcGFyc2VyLlB1c2gobm9kZSk7XG59O1xuQmFzZU1ldGhvZHMuT3ZlcnVuZGVyc2V0ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciB0b3AgPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgdmFyIGJvdCA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICB2YXIgYmFzZSA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmNoZWNrTW92YWJsZUxpbWl0cyhiYXNlKTtcbiAgICBpZiAodG9wLmlzS2luZCgnbW8nKSkge1xuICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKHRvcCwgJ2FjY2VudCcsIGZhbHNlKTtcbiAgICB9XG4gICAgaWYgKGJvdC5pc0tpbmQoJ21vJykpIHtcbiAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShib3QsICdhY2NlbnQnLCBmYWxzZSk7XG4gICAgfVxuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtdW5kZXJvdmVyJywgW2Jhc2UsIGJvdCwgdG9wXSwgeyBhY2NlbnQ6IGZhbHNlLCBhY2NlbnR1bmRlcjogZmFsc2UgfSk7XG4gICAgcGFyc2VyLlB1c2gobm9kZSk7XG59O1xuQmFzZU1ldGhvZHMuVGVYQXRvbSA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUsIG1jbGFzcykge1xuICAgIHZhciBkZWYgPSB7IHRleENsYXNzOiBtY2xhc3MgfTtcbiAgICB2YXIgbW1sO1xuICAgIHZhciBub2RlO1xuICAgIHZhciBwYXJzZWQ7XG4gICAgaWYgKG1jbGFzcyA9PT0gTW1sTm9kZV9qc18xLlRFWENMQVNTLk9QKSB7XG4gICAgICAgIGRlZlsnbW92ZXN1cHN1YiddID0gZGVmWydtb3ZhYmxlbGltaXRzJ10gPSB0cnVlO1xuICAgICAgICB2YXIgYXJnID0gcGFyc2VyLkdldEFyZ3VtZW50KG5hbWUpO1xuICAgICAgICB2YXIgbWF0Y2ggPSBhcmcubWF0Y2goL15cXHMqXFxcXHJtXFxzKyhbYS16QS1aMC05IF0rKSQvKTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICBkZWZbJ21hdGh2YXJpYW50J10gPSBUZXhDb25zdGFudHNfanNfMS5UZXhDb25zdGFudC5WYXJpYW50Lk5PUk1BTDtcbiAgICAgICAgICAgIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCd0b2tlbicsICdtaScsIGRlZiwgbWF0Y2hbMV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFyc2VkID0gbmV3IFRleFBhcnNlcl9qc18xLmRlZmF1bHQoYXJnLCBwYXJzZXIuc3RhY2suZW52LCBwYXJzZXIuY29uZmlndXJhdGlvbikubW1sKCk7XG4gICAgICAgICAgICBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW3BhcnNlZF0sIGRlZik7XG4gICAgICAgIH1cbiAgICAgICAgbW1sID0gcGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnZm4nLCBub2RlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHBhcnNlZCA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICAgICAgbW1sID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW3BhcnNlZF0sIGRlZik7XG4gICAgfVxuICAgIHBhcnNlci5QdXNoKG1tbCk7XG59O1xuQmFzZU1ldGhvZHMuTW1sVG9rZW4gPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lKSB7XG4gICAgdmFyIGtpbmQgPSBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSk7XG4gICAgdmFyIGF0dHIgPSBwYXJzZXIuR2V0QnJhY2tldHMobmFtZSwgJycpLnJlcGxhY2UoL15cXHMrLywgJycpO1xuICAgIHZhciB0ZXh0ID0gcGFyc2VyLkdldEFyZ3VtZW50KG5hbWUpO1xuICAgIHZhciBkZWYgPSB7fTtcbiAgICB2YXIga2VlcCA9IFtdO1xuICAgIHZhciBub2RlO1xuICAgIHRyeSB7XG4gICAgICAgIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywga2luZCk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIG5vZGUgPSBudWxsO1xuICAgIH1cbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuaXNUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdOb3RNYXRoTUxUb2tlbicsICclMSBpcyBub3QgYSB0b2tlbiBlbGVtZW50Jywga2luZCk7XG4gICAgfVxuICAgIHdoaWxlIChhdHRyICE9PSAnJykge1xuICAgICAgICB2YXIgbWF0Y2ggPSBhdHRyLm1hdGNoKC9eKFthLXpdKylcXHMqPVxccyooJ1teJ10qJ3xcIlteXCJdKlwifFteICxdKilcXHMqLD9cXHMqL2kpO1xuICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdJbnZhbGlkTWF0aE1MQXR0cicsICdJbnZhbGlkIE1hdGhNTCBhdHRyaWJ1dGU6ICUxJywgYXR0cik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFub2RlLmF0dHJpYnV0ZXMuaGFzRGVmYXVsdChtYXRjaFsxXSkgJiYgIU1tbFRva2VuQWxsb3dbbWF0Y2hbMV1dKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdVbmtub3duQXR0ckZvckVsZW1lbnQnLCAnJTEgaXMgbm90IGEgcmVjb2duaXplZCBhdHRyaWJ1dGUgZm9yICUyJywgbWF0Y2hbMV0sIGtpbmQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuTW1sRmlsdGVyQXR0cmlidXRlKHBhcnNlciwgbWF0Y2hbMV0sIG1hdGNoWzJdLnJlcGxhY2UoL14oWydcIl0pKC4qKVxcMSQvLCAnJDInKSk7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZScpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmW21hdGNoWzFdXSA9IHZhbHVlO1xuICAgICAgICAgICAga2VlcC5wdXNoKG1hdGNoWzFdKTtcbiAgICAgICAgfVxuICAgICAgICBhdHRyID0gYXR0ci5zdWJzdHIobWF0Y2hbMF0ubGVuZ3RoKTtcbiAgICB9XG4gICAgaWYgKGtlZXAubGVuZ3RoKSB7XG4gICAgICAgIGRlZlsnbWp4LWtlZXAtYXR0cnMnXSA9IGtlZXAuam9pbignICcpO1xuICAgIH1cbiAgICB2YXIgdGV4dE5vZGUgPSBwYXJzZXIuY3JlYXRlKCd0ZXh0JywgdGV4dCk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZCh0ZXh0Tm9kZSk7XG4gICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldFByb3BlcnRpZXMobm9kZSwgZGVmKTtcbiAgICBwYXJzZXIuUHVzaChub2RlKTtcbn07XG5CYXNlTWV0aG9kcy5TdHJ1dCA9IGZ1bmN0aW9uIChwYXJzZXIsIF9uYW1lKSB7XG4gICAgdmFyIHJvdyA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXJvdycpO1xuICAgIHZhciBwYWRkZWQgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21wYWRkZWQnLCBbcm93XSwgeyBoZWlnaHQ6ICc4LjZwdCcsIGRlcHRoOiAnM3B0Jywgd2lkdGg6IDAgfSk7XG4gICAgcGFyc2VyLlB1c2gocGFkZGVkKTtcbn07XG5CYXNlTWV0aG9kcy5QaGFudG9tID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgdiwgaCkge1xuICAgIHZhciBib3ggPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21waGFudG9tJywgW3BhcnNlci5QYXJzZUFyZyhuYW1lKV0pO1xuICAgIGlmICh2IHx8IGgpIHtcbiAgICAgICAgYm94ID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtcGFkZGVkJywgW2JveF0pO1xuICAgICAgICBpZiAoaCkge1xuICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShib3gsICdoZWlnaHQnLCAwKTtcbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUoYm94LCAnZGVwdGgnLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodikge1xuICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShib3gsICd3aWR0aCcsIDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBhdG9tID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW2JveF0pO1xuICAgIHBhcnNlci5QdXNoKGF0b20pO1xufTtcbkJhc2VNZXRob2RzLlNtYXNoID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBidCA9IFBhcnNlVXRpbF9qc18xLmRlZmF1bHQudHJpbVNwYWNlcyhwYXJzZXIuR2V0QnJhY2tldHMobmFtZSwgJycpKTtcbiAgICB2YXIgc21hc2ggPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21wYWRkZWQnLCBbcGFyc2VyLlBhcnNlQXJnKG5hbWUpXSk7XG4gICAgc3dpdGNoIChidCkge1xuICAgICAgICBjYXNlICdiJzpcbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUoc21hc2gsICdkZXB0aCcsIDApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3QnOlxuICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShzbWFzaCwgJ2hlaWdodCcsIDApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKHNtYXNoLCAnaGVpZ2h0JywgMCk7XG4gICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKHNtYXNoLCAnZGVwdGgnLCAwKTtcbiAgICB9XG4gICAgdmFyIGF0b20gPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ1RlWEF0b20nLCBbc21hc2hdKTtcbiAgICBwYXJzZXIuUHVzaChhdG9tKTtcbn07XG5CYXNlTWV0aG9kcy5MYXAgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lKSB7XG4gICAgdmFyIG1tbCA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXBhZGRlZCcsIFtwYXJzZXIuUGFyc2VBcmcobmFtZSldLCB7IHdpZHRoOiAwIH0pO1xuICAgIGlmIChuYW1lID09PSAnXFxcXGxsYXAnKSB7XG4gICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUobW1sLCAnbHNwYWNlJywgJy0xd2lkdGgnKTtcbiAgICB9XG4gICAgdmFyIGF0b20gPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ1RlWEF0b20nLCBbbW1sXSk7XG4gICAgcGFyc2VyLlB1c2goYXRvbSk7XG59O1xuQmFzZU1ldGhvZHMuUmFpc2VMb3dlciA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICB2YXIgaCA9IHBhcnNlci5HZXREaW1lbihuYW1lKTtcbiAgICB2YXIgaXRlbSA9IHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ3Bvc2l0aW9uJykuc2V0UHJvcGVydGllcyh7IG5hbWU6IHBhcnNlci5jdXJyZW50Q1MsIG1vdmU6ICd2ZXJ0aWNhbCcgfSk7XG4gICAgaWYgKGguY2hhckF0KDApID09PSAnLScpIHtcbiAgICAgICAgaCA9IGguc2xpY2UoMSk7XG4gICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cigxKSA9PT0gJ3JhaXNlJyA/ICdcXFxcbG93ZXInIDogJ1xcXFxyYWlzZSc7XG4gICAgfVxuICAgIGlmIChuYW1lID09PSAnXFxcXGxvd2VyJykge1xuICAgICAgICBpdGVtLnNldFByb3BlcnR5KCdkaCcsICctJyArIGgpO1xuICAgICAgICBpdGVtLnNldFByb3BlcnR5KCdkZCcsICcrJyArIGgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaXRlbS5zZXRQcm9wZXJ0eSgnZGgnLCAnKycgKyBoKTtcbiAgICAgICAgaXRlbS5zZXRQcm9wZXJ0eSgnZGQnLCAnLScgKyBoKTtcbiAgICB9XG4gICAgcGFyc2VyLlB1c2goaXRlbSk7XG59O1xuQmFzZU1ldGhvZHMuTW92ZUxlZnRSaWdodCA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICB2YXIgaCA9IHBhcnNlci5HZXREaW1lbihuYW1lKTtcbiAgICB2YXIgbmggPSAoaC5jaGFyQXQoMCkgPT09ICctJyA/IGguc2xpY2UoMSkgOiAnLScgKyBoKTtcbiAgICBpZiAobmFtZSA9PT0gJ1xcXFxtb3ZlbGVmdCcpIHtcbiAgICAgICAgdmFyIHRtcCA9IGg7XG4gICAgICAgIGggPSBuaDtcbiAgICAgICAgbmggPSB0bXA7XG4gICAgfVxuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ3Bvc2l0aW9uJykuc2V0UHJvcGVydGllcyh7XG4gICAgICAgIG5hbWU6IHBhcnNlci5jdXJyZW50Q1MsIG1vdmU6ICdob3Jpem9udGFsJyxcbiAgICAgICAgbGVmdDogcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtc3BhY2UnLCBbXSwgeyB3aWR0aDogaCB9KSxcbiAgICAgICAgcmlnaHQ6IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXNwYWNlJywgW10sIHsgd2lkdGg6IG5oIH0pXG4gICAgfSkpO1xufTtcbkJhc2VNZXRob2RzLkhza2lwID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtc3BhY2UnLCBbXSwgeyB3aWR0aDogcGFyc2VyLkdldERpbWVuKG5hbWUpIH0pO1xuICAgIHBhcnNlci5QdXNoKG5vZGUpO1xufTtcbkJhc2VNZXRob2RzLk5vbnNjcmlwdCA9IGZ1bmN0aW9uIChwYXJzZXIsIF9uYW1lKSB7XG4gICAgcGFyc2VyLlB1c2gocGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnbm9uc2NyaXB0JykpO1xufTtcbkJhc2VNZXRob2RzLlJ1bGUgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCBzdHlsZSkge1xuICAgIHZhciB3ID0gcGFyc2VyLkdldERpbWVuKG5hbWUpLCBoID0gcGFyc2VyLkdldERpbWVuKG5hbWUpLCBkID0gcGFyc2VyLkdldERpbWVuKG5hbWUpO1xuICAgIHZhciBkZWYgPSB7IHdpZHRoOiB3LCBoZWlnaHQ6IGgsIGRlcHRoOiBkIH07XG4gICAgaWYgKHN0eWxlICE9PSAnYmxhbmsnKSB7XG4gICAgICAgIGRlZlsnbWF0aGJhY2tncm91bmQnXSA9IChwYXJzZXIuc3RhY2suZW52Wydjb2xvciddIHx8ICdibGFjaycpO1xuICAgIH1cbiAgICB2YXIgbm9kZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXNwYWNlJywgW10sIGRlZik7XG4gICAgcGFyc2VyLlB1c2gobm9kZSk7XG59O1xuQmFzZU1ldGhvZHMucnVsZSA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICB2YXIgdiA9IHBhcnNlci5HZXRCcmFja2V0cyhuYW1lKSwgdyA9IHBhcnNlci5HZXREaW1lbihuYW1lKSwgaCA9IHBhcnNlci5HZXREaW1lbihuYW1lKTtcbiAgICB2YXIgbW1sID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtc3BhY2UnLCBbXSwge1xuICAgICAgICB3aWR0aDogdywgaGVpZ2h0OiBoLFxuICAgICAgICBtYXRoYmFja2dyb3VuZDogKHBhcnNlci5zdGFjay5lbnZbJ2NvbG9yJ10gfHwgJ2JsYWNrJylcbiAgICB9KTtcbiAgICBpZiAodikge1xuICAgICAgICBtbWwgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21wYWRkZWQnLCBbbW1sXSwgeyB2b2Zmc2V0OiB2IH0pO1xuICAgICAgICBpZiAodi5tYXRjaCgvXlxcLS8pKSB7XG4gICAgICAgICAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXR0cmlidXRlKG1tbCwgJ2hlaWdodCcsIHYpO1xuICAgICAgICAgICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldEF0dHJpYnV0ZShtbWwsICdkZXB0aCcsICcrJyArIHYuc3Vic3RyKDEpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIE5vZGVVdGlsX2pzXzEuZGVmYXVsdC5zZXRBdHRyaWJ1dGUobW1sLCAnaGVpZ2h0JywgJysnICsgdik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcGFyc2VyLlB1c2gobW1sKTtcbn07XG5CYXNlTWV0aG9kcy5NYWtlQmlnID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgbWNsYXNzLCBzaXplKSB7XG4gICAgc2l6ZSAqPSBQX0hFSUdIVDtcbiAgICB2YXIgc2l6ZVN0ciA9IFN0cmluZyhzaXplKS5yZXBsYWNlKC8oXFwuXFxkXFxkXFxkKS4rLywgJyQxJykgKyAnZW0nO1xuICAgIHZhciBkZWxpbSA9IHBhcnNlci5HZXREZWxpbWl0ZXIobmFtZSwgdHJ1ZSk7XG4gICAgdmFyIG1vID0gcGFyc2VyLmNyZWF0ZSgndG9rZW4nLCAnbW8nLCB7XG4gICAgICAgIG1pbnNpemU6IHNpemVTdHIsIG1heHNpemU6IHNpemVTdHIsXG4gICAgICAgIGZlbmNlOiB0cnVlLCBzdHJldGNoeTogdHJ1ZSwgc3ltbWV0cmljOiB0cnVlXG4gICAgfSwgZGVsaW0pO1xuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW21vXSwgeyB0ZXhDbGFzczogbWNsYXNzIH0pO1xuICAgIHBhcnNlci5QdXNoKG5vZGUpO1xufTtcbkJhc2VNZXRob2RzLkJ1aWxkUmVsID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciB0b3AgPSBwYXJzZXIuUGFyc2VVcFRvKG5hbWUsICdcXFxcb3ZlcicpO1xuICAgIHZhciBib3QgPSBwYXJzZXIuUGFyc2VBcmcobmFtZSk7XG4gICAgdmFyIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ211bmRlcm92ZXInKTtcbiAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0Q2hpbGQobm9kZSwgMCwgYm90KTtcbiAgICBOb2RlVXRpbF9qc18xLmRlZmF1bHQuc2V0Q2hpbGQobm9kZSwgMSwgbnVsbCk7XG4gICAgTm9kZVV0aWxfanNfMS5kZWZhdWx0LnNldENoaWxkKG5vZGUsIDIsIHRvcCk7XG4gICAgdmFyIGF0b20gPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ1RlWEF0b20nLCBbbm9kZV0sIHsgdGV4Q2xhc3M6IE1tbE5vZGVfanNfMS5URVhDTEFTUy5SRUwgfSk7XG4gICAgcGFyc2VyLlB1c2goYXRvbSk7XG59O1xuQmFzZU1ldGhvZHMuSEJveCA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUsIHN0eWxlLCBmb250KSB7XG4gICAgcGFyc2VyLlB1c2hBbGwoUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5pbnRlcm5hbE1hdGgocGFyc2VyLCBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSksIHN0eWxlLCBmb250KSk7XG59O1xuQmFzZU1ldGhvZHMuRkJveCA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICB2YXIgaW50ZXJuYWwgPSBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmludGVybmFsTWF0aChwYXJzZXIsIHBhcnNlci5HZXRBcmd1bWVudChuYW1lKSk7XG4gICAgdmFyIG5vZGUgPSBwYXJzZXIuY3JlYXRlKCdub2RlJywgJ21lbmNsb3NlJywgaW50ZXJuYWwsIHsgbm90YXRpb246ICdib3gnIH0pO1xuICAgIHBhcnNlci5QdXNoKG5vZGUpO1xufTtcbkJhc2VNZXRob2RzLkZyYW1lQm94ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciB3aWR0aCA9IHBhcnNlci5HZXRCcmFja2V0cyhuYW1lKTtcbiAgICB2YXIgcG9zID0gcGFyc2VyLkdldEJyYWNrZXRzKG5hbWUpIHx8ICdjJztcbiAgICB2YXIgbW1sID0gUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5pbnRlcm5hbE1hdGgocGFyc2VyLCBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSkpO1xuICAgIGlmICh3aWR0aCkge1xuICAgICAgICBtbWwgPSBbcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtcGFkZGVkJywgbW1sLCB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgICAgICAgICAgICdkYXRhLWFsaWduJzogKDAsIE9wdGlvbnNfanNfMS5sb29rdXApKHBvcywgeyBsOiAnbGVmdCcsIHI6ICdyaWdodCcgfSwgJ2NlbnRlcicpXG4gICAgICAgICAgICB9KV07XG4gICAgfVxuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdUZVhBdG9tJywgW3BhcnNlci5jcmVhdGUoJ25vZGUnLCAnbWVuY2xvc2UnLCBtbWwsIHsgbm90YXRpb246ICdib3gnIH0pXSwgeyB0ZXhDbGFzczogTW1sTm9kZV9qc18xLlRFWENMQVNTLk9SRCB9KTtcbiAgICBwYXJzZXIuUHVzaChub2RlKTtcbn07XG5CYXNlTWV0aG9kcy5Ob3QgPSBmdW5jdGlvbiAocGFyc2VyLCBfbmFtZSkge1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ25vdCcpKTtcbn07XG5CYXNlTWV0aG9kcy5Eb3RzID0gZnVuY3Rpb24gKHBhcnNlciwgX25hbWUpIHtcbiAgICB2YXIgbGRvdHNFbnRpdHkgPSBOb2RlVXRpbF9qc18xLmRlZmF1bHQuY3JlYXRlRW50aXR5KCcyMDI2Jyk7XG4gICAgdmFyIGNkb3RzRW50aXR5ID0gTm9kZVV0aWxfanNfMS5kZWZhdWx0LmNyZWF0ZUVudGl0eSgnMjJFRicpO1xuICAgIHZhciBsZG90cyA9IHBhcnNlci5jcmVhdGUoJ3Rva2VuJywgJ21vJywgeyBzdHJldGNoeTogZmFsc2UgfSwgbGRvdHNFbnRpdHkpO1xuICAgIHZhciBjZG90cyA9IHBhcnNlci5jcmVhdGUoJ3Rva2VuJywgJ21vJywgeyBzdHJldGNoeTogZmFsc2UgfSwgY2RvdHNFbnRpdHkpO1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ2RvdHMnKS5zZXRQcm9wZXJ0aWVzKHtcbiAgICAgICAgbGRvdHM6IGxkb3RzLFxuICAgICAgICBjZG90czogY2RvdHNcbiAgICB9KSk7XG59O1xuQmFzZU1ldGhvZHMuTWF0cml4ID0gZnVuY3Rpb24gKHBhcnNlciwgX25hbWUsIG9wZW4sIGNsb3NlLCBhbGlnbiwgc3BhY2luZywgdnNwYWNpbmcsIHN0eWxlLCBjYXNlcywgbnVtYmVyZWQpIHtcbiAgICB2YXIgYyA9IHBhcnNlci5HZXROZXh0KCk7XG4gICAgaWYgKGMgPT09ICcnKSB7XG4gICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ01pc3NpbmdBcmdGb3InLCAnTWlzc2luZyBhcmd1bWVudCBmb3IgJTEnLCBwYXJzZXIuY3VycmVudENTKTtcbiAgICB9XG4gICAgaWYgKGMgPT09ICd7Jykge1xuICAgICAgICBwYXJzZXIuaSsrO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGFyc2VyLnN0cmluZyA9IGMgKyAnfScgKyBwYXJzZXIuc3RyaW5nLnNsaWNlKHBhcnNlci5pICsgMSk7XG4gICAgICAgIHBhcnNlci5pID0gMDtcbiAgICB9XG4gICAgdmFyIGFycmF5ID0gcGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnYXJyYXknKS5zZXRQcm9wZXJ0eSgncmVxdWlyZUNsb3NlJywgdHJ1ZSk7XG4gICAgYXJyYXkuYXJyYXlkZWYgPSB7XG4gICAgICAgIHJvd3NwYWNpbmc6ICh2c3BhY2luZyB8fCAnNHB0JyksXG4gICAgICAgIGNvbHVtbnNwYWNpbmc6IChzcGFjaW5nIHx8ICcxZW0nKVxuICAgIH07XG4gICAgaWYgKGNhc2VzKSB7XG4gICAgICAgIGFycmF5LnNldFByb3BlcnR5KCdpc0Nhc2VzJywgdHJ1ZSk7XG4gICAgfVxuICAgIGlmIChudW1iZXJlZCkge1xuICAgICAgICBhcnJheS5zZXRQcm9wZXJ0eSgnaXNOdW1iZXJlZCcsIHRydWUpO1xuICAgICAgICBhcnJheS5hcnJheWRlZi5zaWRlID0gbnVtYmVyZWQ7XG4gICAgfVxuICAgIGlmIChvcGVuIHx8IGNsb3NlKSB7XG4gICAgICAgIGFycmF5LnNldFByb3BlcnR5KCdvcGVuJywgb3Blbik7XG4gICAgICAgIGFycmF5LnNldFByb3BlcnR5KCdjbG9zZScsIGNsb3NlKTtcbiAgICB9XG4gICAgaWYgKHN0eWxlID09PSAnRCcpIHtcbiAgICAgICAgYXJyYXkuYXJyYXlkZWYuZGlzcGxheXN0eWxlID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGFsaWduICE9IG51bGwpIHtcbiAgICAgICAgYXJyYXkuYXJyYXlkZWYuY29sdW1uYWxpZ24gPSBhbGlnbjtcbiAgICB9XG4gICAgcGFyc2VyLlB1c2goYXJyYXkpO1xufTtcbkJhc2VNZXRob2RzLkVudHJ5ID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ2NlbGwnKS5zZXRQcm9wZXJ0aWVzKHsgaXNFbnRyeTogdHJ1ZSwgbmFtZTogbmFtZSB9KSk7XG4gICAgdmFyIHRvcCA9IHBhcnNlci5zdGFjay5Ub3AoKTtcbiAgICB2YXIgZW52ID0gdG9wLmdldFByb3BlcnR5KCdjYXNlc0VudicpO1xuICAgIHZhciBjYXNlcyA9IHRvcC5nZXRQcm9wZXJ0eSgnaXNDYXNlcycpO1xuICAgIGlmICghY2FzZXMgJiYgIWVudilcbiAgICAgICAgcmV0dXJuO1xuICAgIHZhciBzdHIgPSBwYXJzZXIuc3RyaW5nO1xuICAgIHZhciBicmFjZXMgPSAwLCBjbG9zZSA9IC0xLCBpID0gcGFyc2VyLmksIG0gPSBzdHIubGVuZ3RoO1xuICAgIHZhciBlbmQgPSAoZW52ID8gbmV3IFJlZ0V4cChcIl5cXFxcXFxcXGVuZFxcXFxzKlxcXFx7XCIuY29uY2F0KGVudi5yZXBsYWNlKC9cXCovLCAnXFxcXConKSwgXCJcXFxcfVwiKSkgOiBudWxsKTtcbiAgICB3aGlsZSAoaSA8IG0pIHtcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckF0KGkpO1xuICAgICAgICBpZiAoYyA9PT0gJ3snKSB7XG4gICAgICAgICAgICBicmFjZXMrKztcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjID09PSAnfScpIHtcbiAgICAgICAgICAgIGlmIChicmFjZXMgPT09IDApIHtcbiAgICAgICAgICAgICAgICBtID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyYWNlcy0tO1xuICAgICAgICAgICAgICAgIGlmIChicmFjZXMgPT09IDAgJiYgY2xvc2UgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb3NlID0gaSAtIHBhcnNlci5pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA9PT0gJyYnICYmIGJyYWNlcyA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnRXh0cmFBbGlnblRhYicsICdFeHRyYSBhbGlnbm1lbnQgdGFiIGluIFxcXFxjYXNlcyB0ZXh0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgICB2YXIgcmVzdCA9IHN0ci5zdWJzdHIoaSk7XG4gICAgICAgICAgICBpZiAocmVzdC5tYXRjaCgvXigoXFxcXGNyKVteYS16QS1aXXxcXFxcXFxcXCkvKSB8fCAoZW5kICYmIHJlc3QubWF0Y2goZW5kKSkpIHtcbiAgICAgICAgICAgICAgICBtID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgdGV4dCA9IHN0ci5zdWJzdHIocGFyc2VyLmksIGkgLSBwYXJzZXIuaSk7XG4gICAgaWYgKCF0ZXh0Lm1hdGNoKC9eXFxzKlxcXFx0ZXh0W15hLXpBLVpdLykgfHwgY2xvc2UgIT09IHRleHQucmVwbGFjZSgvXFxzKyQvLCAnJykubGVuZ3RoIC0gMSkge1xuICAgICAgICB2YXIgaW50ZXJuYWwgPSBQYXJzZVV0aWxfanNfMS5kZWZhdWx0LmludGVybmFsTWF0aChwYXJzZXIsIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQudHJpbVNwYWNlcyh0ZXh0KSwgMCk7XG4gICAgICAgIHBhcnNlci5QdXNoQWxsKGludGVybmFsKTtcbiAgICAgICAgcGFyc2VyLmkgPSBpO1xuICAgIH1cbn07XG5CYXNlTWV0aG9kcy5DciA9IGZ1bmN0aW9uIChwYXJzZXIsIG5hbWUpIHtcbiAgICBwYXJzZXIuUHVzaChwYXJzZXIuaXRlbUZhY3RvcnkuY3JlYXRlKCdjZWxsJykuc2V0UHJvcGVydGllcyh7IGlzQ1I6IHRydWUsIG5hbWU6IG5hbWUgfSkpO1xufTtcbkJhc2VNZXRob2RzLkNyTGFUZVggPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCBub2JyYWNrZXRzKSB7XG4gICAgaWYgKG5vYnJhY2tldHMgPT09IHZvaWQgMCkgeyBub2JyYWNrZXRzID0gZmFsc2U7IH1cbiAgICB2YXIgbjtcbiAgICBpZiAoIW5vYnJhY2tldHMpIHtcbiAgICAgICAgaWYgKHBhcnNlci5zdHJpbmcuY2hhckF0KHBhcnNlci5pKSA9PT0gJyonKSB7XG4gICAgICAgICAgICBwYXJzZXIuaSsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJzZXIuc3RyaW5nLmNoYXJBdChwYXJzZXIuaSkgPT09ICdbJykge1xuICAgICAgICAgICAgdmFyIGRpbSA9IHBhcnNlci5HZXRCcmFja2V0cyhuYW1lLCAnJyk7XG4gICAgICAgICAgICB2YXIgX2EgPSBfX3JlYWQoUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5tYXRjaERpbWVuKGRpbSksIDIpLCB2YWx1ZSA9IF9hWzBdLCB1bml0ID0gX2FbMV07XG4gICAgICAgICAgICBpZiAoZGltICYmICF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ0JyYWNrZXRNdXN0QmVEaW1lbnNpb24nLCAnQnJhY2tldCBhcmd1bWVudCB0byAlMSBtdXN0IGJlIGEgZGltZW5zaW9uJywgcGFyc2VyLmN1cnJlbnRDUyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuID0gdmFsdWUgKyB1bml0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHBhcnNlci5QdXNoKHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ2NlbGwnKS5zZXRQcm9wZXJ0aWVzKHsgaXNDUjogdHJ1ZSwgbmFtZTogbmFtZSwgbGluZWJyZWFrOiB0cnVlIH0pKTtcbiAgICB2YXIgdG9wID0gcGFyc2VyLnN0YWNrLlRvcCgpO1xuICAgIHZhciBub2RlO1xuICAgIGlmICh0b3AgaW5zdGFuY2VvZiBzaXRlbS5BcnJheUl0ZW0pIHtcbiAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgIHRvcC5hZGRSb3dTcGFjaW5nKG4pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgbm9kZSA9IHBhcnNlci5jcmVhdGUoJ25vZGUnLCAnbXNwYWNlJywgW10sIHsgZGVwdGg6IG4gfSk7XG4gICAgICAgICAgICBwYXJzZXIuUHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtc3BhY2UnLCBbXSwgeyBsaW5lYnJlYWs6IFRleENvbnN0YW50c19qc18xLlRleENvbnN0YW50LkxpbmVCcmVhay5ORVdMSU5FIH0pO1xuICAgICAgICBwYXJzZXIuUHVzaChub2RlKTtcbiAgICB9XG59O1xuQmFzZU1ldGhvZHMuSExpbmUgPSBmdW5jdGlvbiAocGFyc2VyLCBfbmFtZSwgc3R5bGUpIHtcbiAgICBpZiAoc3R5bGUgPT0gbnVsbCkge1xuICAgICAgICBzdHlsZSA9ICdzb2xpZCc7XG4gICAgfVxuICAgIHZhciB0b3AgPSBwYXJzZXIuc3RhY2suVG9wKCk7XG4gICAgaWYgKCEodG9wIGluc3RhbmNlb2Ygc2l0ZW0uQXJyYXlJdGVtKSB8fCB0b3AuU2l6ZSgpKSB7XG4gICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ01pc3BsYWNlZCcsICdNaXNwbGFjZWQgJTEnLCBwYXJzZXIuY3VycmVudENTKTtcbiAgICB9XG4gICAgaWYgKCF0b3AudGFibGUubGVuZ3RoKSB7XG4gICAgICAgIHRvcC5mcmFtZS5wdXNoKCd0b3AnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBsaW5lcyA9ICh0b3AuYXJyYXlkZWZbJ3Jvd2xpbmVzJ10gPyB0b3AuYXJyYXlkZWZbJ3Jvd2xpbmVzJ10uc3BsaXQoLyAvKSA6IFtdKTtcbiAgICAgICAgd2hpbGUgKGxpbmVzLmxlbmd0aCA8IHRvcC50YWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxpbmVzLnB1c2goJ25vbmUnKTtcbiAgICAgICAgfVxuICAgICAgICBsaW5lc1t0b3AudGFibGUubGVuZ3RoIC0gMV0gPSBzdHlsZTtcbiAgICAgICAgdG9wLmFycmF5ZGVmWydyb3dsaW5lcyddID0gbGluZXMuam9pbignICcpO1xuICAgIH1cbn07XG5CYXNlTWV0aG9kcy5IRmlsbCA9IGZ1bmN0aW9uIChwYXJzZXIsIF9uYW1lKSB7XG4gICAgdmFyIHRvcCA9IHBhcnNlci5zdGFjay5Ub3AoKTtcbiAgICBpZiAodG9wIGluc3RhbmNlb2Ygc2l0ZW0uQXJyYXlJdGVtKSB7XG4gICAgICAgIHRvcC5oZmlsbC5wdXNoKHRvcC5TaXplKCkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IFRleEVycm9yX2pzXzEuZGVmYXVsdCgnVW5zdXBwb3J0ZWRIRmlsbCcsICdVbnN1cHBvcnRlZCB1c2Ugb2YgJTEnLCBwYXJzZXIuY3VycmVudENTKTtcbiAgICB9XG59O1xuQmFzZU1ldGhvZHMuQmVnaW5FbmQgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lKSB7XG4gICAgdmFyIGVudiA9IHBhcnNlci5HZXRBcmd1bWVudChuYW1lKTtcbiAgICBpZiAoZW52Lm1hdGNoKC9cXFxcL2kpKSB7XG4gICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ0ludmFsaWRFbnYnLCAnSW52YWxpZCBlbnZpcm9ubWVudCBuYW1lIFxcJyUxXFwnJywgZW52KTtcbiAgICB9XG4gICAgdmFyIG1hY3JvID0gcGFyc2VyLmNvbmZpZ3VyYXRpb24uaGFuZGxlcnMuZ2V0KCdlbnZpcm9ubWVudCcpLmxvb2t1cChlbnYpO1xuICAgIGlmIChtYWNybyAmJiBuYW1lID09PSAnXFxcXGVuZCcpIHtcbiAgICAgICAgaWYgKCFtYWNyby5hcmdzWzBdKSB7XG4gICAgICAgICAgICB2YXIgbW1sID0gcGFyc2VyLml0ZW1GYWN0b3J5LmNyZWF0ZSgnZW5kJykuc2V0UHJvcGVydHkoJ25hbWUnLCBlbnYpO1xuICAgICAgICAgICAgcGFyc2VyLlB1c2gobW1sKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBwYXJzZXIuc3RhY2suZW52WydjbG9zaW5nJ10gPSBlbnY7XG4gICAgfVxuICAgIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuY2hlY2tNYXhNYWNyb3MocGFyc2VyLCBmYWxzZSk7XG4gICAgcGFyc2VyLnBhcnNlKCdlbnZpcm9ubWVudCcsIFtwYXJzZXIsIGVudl0pO1xufTtcbkJhc2VNZXRob2RzLkFycmF5ID0gZnVuY3Rpb24gKHBhcnNlciwgYmVnaW4sIG9wZW4sIGNsb3NlLCBhbGlnbiwgc3BhY2luZywgdnNwYWNpbmcsIHN0eWxlLCByYWdnZWRIZWlnaHQpIHtcbiAgICBpZiAoIWFsaWduKSB7XG4gICAgICAgIGFsaWduID0gcGFyc2VyLkdldEFyZ3VtZW50KCdcXFxcYmVnaW57JyArIGJlZ2luLmdldE5hbWUoKSArICd9Jyk7XG4gICAgfVxuICAgIHZhciBsaW5lcyA9ICgnYycgKyBhbGlnbikucmVwbGFjZSgvW15jbHJ8Ol0vZywgJycpLnJlcGxhY2UoL1tefDpdKFt8Ol0pKy9nLCAnJDEnKTtcbiAgICBhbGlnbiA9IGFsaWduLnJlcGxhY2UoL1teY2xyXS9nLCAnJykuc3BsaXQoJycpLmpvaW4oJyAnKTtcbiAgICBhbGlnbiA9IGFsaWduLnJlcGxhY2UoL2wvZywgJ2xlZnQnKS5yZXBsYWNlKC9yL2csICdyaWdodCcpLnJlcGxhY2UoL2MvZywgJ2NlbnRlcicpO1xuICAgIHZhciBhcnJheSA9IHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ2FycmF5Jyk7XG4gICAgYXJyYXkuYXJyYXlkZWYgPSB7XG4gICAgICAgIGNvbHVtbmFsaWduOiBhbGlnbixcbiAgICAgICAgY29sdW1uc3BhY2luZzogKHNwYWNpbmcgfHwgJzFlbScpLFxuICAgICAgICByb3dzcGFjaW5nOiAodnNwYWNpbmcgfHwgJzRwdCcpXG4gICAgfTtcbiAgICBpZiAobGluZXMubWF0Y2goL1t8Ol0vKSkge1xuICAgICAgICBpZiAobGluZXMuY2hhckF0KDApLm1hdGNoKC9bfDpdLykpIHtcbiAgICAgICAgICAgIGFycmF5LmZyYW1lLnB1c2goJ2xlZnQnKTtcbiAgICAgICAgICAgIGFycmF5LmRhc2hlZCA9IGxpbmVzLmNoYXJBdCgwKSA9PT0gJzonO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaW5lcy5jaGFyQXQobGluZXMubGVuZ3RoIC0gMSkubWF0Y2goL1t8Ol0vKSkge1xuICAgICAgICAgICAgYXJyYXkuZnJhbWUucHVzaCgncmlnaHQnKTtcbiAgICAgICAgfVxuICAgICAgICBsaW5lcyA9IGxpbmVzLnN1YnN0cigxLCBsaW5lcy5sZW5ndGggLSAyKTtcbiAgICAgICAgYXJyYXkuYXJyYXlkZWYuY29sdW1ubGluZXMgPVxuICAgICAgICAgICAgbGluZXMuc3BsaXQoJycpLmpvaW4oJyAnKS5yZXBsYWNlKC9bXnw6IF0vZywgJ25vbmUnKS5yZXBsYWNlKC9cXHwvZywgJ3NvbGlkJykucmVwbGFjZSgvOi9nLCAnZGFzaGVkJyk7XG4gICAgfVxuICAgIGlmIChvcGVuKSB7XG4gICAgICAgIGFycmF5LnNldFByb3BlcnR5KCdvcGVuJywgcGFyc2VyLmNvbnZlcnREZWxpbWl0ZXIob3BlbikpO1xuICAgIH1cbiAgICBpZiAoY2xvc2UpIHtcbiAgICAgICAgYXJyYXkuc2V0UHJvcGVydHkoJ2Nsb3NlJywgcGFyc2VyLmNvbnZlcnREZWxpbWl0ZXIoY2xvc2UpKTtcbiAgICB9XG4gICAgaWYgKChzdHlsZSB8fCAnJykuY2hhckF0KDEpID09PSAnXFwnJykge1xuICAgICAgICBhcnJheS5hcnJheWRlZlsnZGF0YS1jcmFtcGVkJ10gPSB0cnVlO1xuICAgICAgICBzdHlsZSA9IHN0eWxlLmNoYXJBdCgwKTtcbiAgICB9XG4gICAgaWYgKHN0eWxlID09PSAnRCcpIHtcbiAgICAgICAgYXJyYXkuYXJyYXlkZWZbJ2Rpc3BsYXlzdHlsZSddID0gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoc3R5bGUpIHtcbiAgICAgICAgYXJyYXkuYXJyYXlkZWZbJ2Rpc3BsYXlzdHlsZSddID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChzdHlsZSA9PT0gJ1MnKSB7XG4gICAgICAgIGFycmF5LmFycmF5ZGVmWydzY3JpcHRsZXZlbCddID0gMTtcbiAgICB9XG4gICAgaWYgKHJhZ2dlZEhlaWdodCkge1xuICAgICAgICBhcnJheS5hcnJheWRlZlsndXNlSGVpZ2h0J10gPSBmYWxzZTtcbiAgICB9XG4gICAgcGFyc2VyLlB1c2goYmVnaW4pO1xuICAgIHJldHVybiBhcnJheTtcbn07XG5CYXNlTWV0aG9kcy5BbGlnbmVkQXJyYXkgPSBmdW5jdGlvbiAocGFyc2VyLCBiZWdpbikge1xuICAgIHZhciBhbGlnbiA9IHBhcnNlci5HZXRCcmFja2V0cygnXFxcXGJlZ2lueycgKyBiZWdpbi5nZXROYW1lKCkgKyAnfScpO1xuICAgIHZhciBpdGVtID0gQmFzZU1ldGhvZHMuQXJyYXkocGFyc2VyLCBiZWdpbik7XG4gICAgcmV0dXJuIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuc2V0QXJyYXlBbGlnbihpdGVtLCBhbGlnbik7XG59O1xuQmFzZU1ldGhvZHMuRXF1YXRpb24gPSBmdW5jdGlvbiAocGFyc2VyLCBiZWdpbiwgbnVtYmVyZWQpIHtcbiAgICBwYXJzZXIuUHVzaChiZWdpbik7XG4gICAgUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5jaGVja0VxbkVudihwYXJzZXIpO1xuICAgIHJldHVybiBwYXJzZXIuaXRlbUZhY3RvcnkuY3JlYXRlKCdlcXVhdGlvbicsIG51bWJlcmVkKS5cbiAgICAgICAgc2V0UHJvcGVydHkoJ25hbWUnLCBiZWdpbi5nZXROYW1lKCkpO1xufTtcbkJhc2VNZXRob2RzLkVxbkFycmF5ID0gZnVuY3Rpb24gKHBhcnNlciwgYmVnaW4sIG51bWJlcmVkLCB0YWdnYWJsZSwgYWxpZ24sIHNwYWNpbmcpIHtcbiAgICBwYXJzZXIuUHVzaChiZWdpbik7XG4gICAgaWYgKHRhZ2dhYmxlKSB7XG4gICAgICAgIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuY2hlY2tFcW5FbnYocGFyc2VyKTtcbiAgICB9XG4gICAgYWxpZ24gPSBhbGlnbi5yZXBsYWNlKC9bXmNscl0vZywgJycpLnNwbGl0KCcnKS5qb2luKCcgJyk7XG4gICAgYWxpZ24gPSBhbGlnbi5yZXBsYWNlKC9sL2csICdsZWZ0JykucmVwbGFjZSgvci9nLCAncmlnaHQnKS5yZXBsYWNlKC9jL2csICdjZW50ZXInKTtcbiAgICB2YXIgbmV3SXRlbSA9IHBhcnNlci5pdGVtRmFjdG9yeS5jcmVhdGUoJ2VxbmFycmF5JywgYmVnaW4uZ2V0TmFtZSgpLCBudW1iZXJlZCwgdGFnZ2FibGUsIHBhcnNlci5zdGFjay5nbG9iYWwpO1xuICAgIG5ld0l0ZW0uYXJyYXlkZWYgPSB7XG4gICAgICAgIGRpc3BsYXlzdHlsZTogdHJ1ZSxcbiAgICAgICAgY29sdW1uYWxpZ246IGFsaWduLFxuICAgICAgICBjb2x1bW5zcGFjaW5nOiAoc3BhY2luZyB8fCAnMWVtJyksXG4gICAgICAgIHJvd3NwYWNpbmc6ICczcHQnLFxuICAgICAgICBzaWRlOiBwYXJzZXIub3B0aW9uc1sndGFnU2lkZSddLFxuICAgICAgICBtaW5sYWJlbHNwYWNpbmc6IHBhcnNlci5vcHRpb25zWyd0YWdJbmRlbnQnXVxuICAgIH07XG4gICAgcmV0dXJuIG5ld0l0ZW07XG59O1xuQmFzZU1ldGhvZHMuSGFuZGxlTm9UYWcgPSBmdW5jdGlvbiAocGFyc2VyLCBfbmFtZSkge1xuICAgIHBhcnNlci50YWdzLm5vdGFnKCk7XG59O1xuQmFzZU1ldGhvZHMuSGFuZGxlTGFiZWwgPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lKSB7XG4gICAgdmFyIGxhYmVsID0gcGFyc2VyLkdldEFyZ3VtZW50KG5hbWUpO1xuICAgIGlmIChsYWJlbCA9PT0gJycpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXBhcnNlci50YWdzLnJlZlVwZGF0ZSkge1xuICAgICAgICBpZiAocGFyc2VyLnRhZ3MubGFiZWwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUZXhFcnJvcl9qc18xLmRlZmF1bHQoJ011bHRpcGxlQ29tbWFuZCcsICdNdWx0aXBsZSAlMScsIHBhcnNlci5jdXJyZW50Q1MpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnNlci50YWdzLmxhYmVsID0gbGFiZWw7XG4gICAgICAgIGlmICgocGFyc2VyLnRhZ3MuYWxsTGFiZWxzW2xhYmVsXSB8fCBwYXJzZXIudGFncy5sYWJlbHNbbGFiZWxdKSAmJiAhcGFyc2VyLm9wdGlvbnNbJ2lnbm9yZUR1cGxpY2F0ZUxhYmVscyddKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVGV4RXJyb3JfanNfMS5kZWZhdWx0KCdNdWx0aXBsZUxhYmVsJywgJ0xhYmVsIFxcJyUxXFwnIG11bHRpcGx5IGRlZmluZWQnLCBsYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyc2VyLnRhZ3MubGFiZWxzW2xhYmVsXSA9IG5ldyBUYWdzX2pzXzEuTGFiZWwoKTtcbiAgICB9XG59O1xuQmFzZU1ldGhvZHMuSGFuZGxlUmVmID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSwgZXFyZWYpIHtcbiAgICB2YXIgbGFiZWwgPSBwYXJzZXIuR2V0QXJndW1lbnQobmFtZSk7XG4gICAgdmFyIHJlZiA9IHBhcnNlci50YWdzLmFsbExhYmVsc1tsYWJlbF0gfHwgcGFyc2VyLnRhZ3MubGFiZWxzW2xhYmVsXTtcbiAgICBpZiAoIXJlZikge1xuICAgICAgICBpZiAoIXBhcnNlci50YWdzLnJlZlVwZGF0ZSkge1xuICAgICAgICAgICAgcGFyc2VyLnRhZ3MucmVkbyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmVmID0gbmV3IFRhZ3NfanNfMS5MYWJlbCgpO1xuICAgIH1cbiAgICB2YXIgdGFnID0gcmVmLnRhZztcbiAgICBpZiAoZXFyZWYpIHtcbiAgICAgICAgdGFnID0gcGFyc2VyLnRhZ3MuZm9ybWF0VGFnKHRhZyk7XG4gICAgfVxuICAgIHZhciBub2RlID0gcGFyc2VyLmNyZWF0ZSgnbm9kZScsICdtcm93JywgUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5pbnRlcm5hbE1hdGgocGFyc2VyLCB0YWcpLCB7XG4gICAgICAgIGhyZWY6IHBhcnNlci50YWdzLmZvcm1hdFVybChyZWYuaWQsIHBhcnNlci5vcHRpb25zLmJhc2VVUkwpLCAnY2xhc3MnOiAnTWF0aEpheF9yZWYnXG4gICAgfSk7XG4gICAgcGFyc2VyLlB1c2gobm9kZSk7XG59O1xuQmFzZU1ldGhvZHMuTWFjcm8gPSBmdW5jdGlvbiAocGFyc2VyLCBuYW1lLCBtYWNybywgYXJnY291bnQsIGRlZikge1xuICAgIGlmIChhcmdjb3VudCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBpZiAoZGVmICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25hbCA9IHBhcnNlci5HZXRCcmFja2V0cyhuYW1lKTtcbiAgICAgICAgICAgIGFyZ3MucHVzaChvcHRpb25hbCA9PSBudWxsID8gZGVmIDogb3B0aW9uYWwpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSBhcmdzLmxlbmd0aDsgaSA8IGFyZ2NvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3MucHVzaChwYXJzZXIuR2V0QXJndW1lbnQobmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIG1hY3JvID0gUGFyc2VVdGlsX2pzXzEuZGVmYXVsdC5zdWJzdGl0dXRlQXJncyhwYXJzZXIsIGFyZ3MsIG1hY3JvKTtcbiAgICB9XG4gICAgcGFyc2VyLnN0cmluZyA9IFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuYWRkQXJncyhwYXJzZXIsIG1hY3JvLCBwYXJzZXIuc3RyaW5nLnNsaWNlKHBhcnNlci5pKSk7XG4gICAgcGFyc2VyLmkgPSAwO1xuICAgIFBhcnNlVXRpbF9qc18xLmRlZmF1bHQuY2hlY2tNYXhNYWNyb3MocGFyc2VyKTtcbn07XG5CYXNlTWV0aG9kcy5NYXRoQ2hvaWNlID0gZnVuY3Rpb24gKHBhcnNlciwgbmFtZSkge1xuICAgIHZhciBEID0gcGFyc2VyLlBhcnNlQXJnKG5hbWUpO1xuICAgIHZhciBUID0gcGFyc2VyLlBhcnNlQXJnKG5hbWUpO1xuICAgIHZhciBTID0gcGFyc2VyLlBhcnNlQXJnKG5hbWUpO1xuICAgIHZhciBTUyA9IHBhcnNlci5QYXJzZUFyZyhuYW1lKTtcbiAgICBwYXJzZXIuUHVzaChwYXJzZXIuY3JlYXRlKCdub2RlJywgJ01hdGhDaG9pY2UnLCBbRCwgVCwgUywgU1NdKSk7XG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gQmFzZU1ldGhvZHM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1CYXNlTWV0aG9kcy5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMucHggPSBleHBvcnRzLmVtUm91bmRlZCA9IGV4cG9ydHMuZW0gPSBleHBvcnRzLnBlcmNlbnQgPSBleHBvcnRzLmxlbmd0aDJlbSA9IGV4cG9ydHMuTUFUSFNQQUNFID0gZXhwb3J0cy5SRUxVTklUUyA9IGV4cG9ydHMuVU5JVFMgPSBleHBvcnRzLkJJR0RJTUVOID0gdm9pZCAwO1xuZXhwb3J0cy5CSUdESU1FTiA9IDEwMDAwMDA7XG5leHBvcnRzLlVOSVRTID0ge1xuICAgIHB4OiAxLFxuICAgICdpbic6IDk2LFxuICAgIGNtOiA5NiAvIDIuNTQsXG4gICAgbW06IDk2IC8gMjUuNFxufTtcbmV4cG9ydHMuUkVMVU5JVFMgPSB7XG4gICAgZW06IDEsXG4gICAgZXg6IC40MzEsXG4gICAgcHQ6IDEgLyAxMCxcbiAgICBwYzogMTIgLyAxMCxcbiAgICBtdTogMSAvIDE4XG59O1xuZXhwb3J0cy5NQVRIU1BBQ0UgPSB7XG4gICAgdmVyeXZlcnl0aGlubWF0aHNwYWNlOiAxIC8gMTgsXG4gICAgdmVyeXRoaW5tYXRoc3BhY2U6IDIgLyAxOCxcbiAgICB0aGlubWF0aHNwYWNlOiAzIC8gMTgsXG4gICAgbWVkaXVtbWF0aHNwYWNlOiA0IC8gMTgsXG4gICAgdGhpY2ttYXRoc3BhY2U6IDUgLyAxOCxcbiAgICB2ZXJ5dGhpY2ttYXRoc3BhY2U6IDYgLyAxOCxcbiAgICB2ZXJ5dmVyeXRoaWNrbWF0aHNwYWNlOiA3IC8gMTgsXG4gICAgbmVnYXRpdmV2ZXJ5dmVyeXRoaW5tYXRoc3BhY2U6IC0xIC8gMTgsXG4gICAgbmVnYXRpdmV2ZXJ5dGhpbm1hdGhzcGFjZTogLTIgLyAxOCxcbiAgICBuZWdhdGl2ZXRoaW5tYXRoc3BhY2U6IC0zIC8gMTgsXG4gICAgbmVnYXRpdmVtZWRpdW1tYXRoc3BhY2U6IC00IC8gMTgsXG4gICAgbmVnYXRpdmV0aGlja21hdGhzcGFjZTogLTUgLyAxOCxcbiAgICBuZWdhdGl2ZXZlcnl0aGlja21hdGhzcGFjZTogLTYgLyAxOCxcbiAgICBuZWdhdGl2ZXZlcnl2ZXJ5dGhpY2ttYXRoc3BhY2U6IC03IC8gMTgsXG4gICAgdGhpbjogLjA0LFxuICAgIG1lZGl1bTogLjA2LFxuICAgIHRoaWNrOiAuMSxcbiAgICBub3JtYWw6IDEsXG4gICAgYmlnOiAyLFxuICAgIHNtYWxsOiAxIC8gTWF0aC5zcXJ0KDIpLFxuICAgIGluZmluaXR5OiBleHBvcnRzLkJJR0RJTUVOXG59O1xuZnVuY3Rpb24gbGVuZ3RoMmVtKGxlbmd0aCwgc2l6ZSwgc2NhbGUsIGVtKSB7XG4gICAgaWYgKHNpemUgPT09IHZvaWQgMCkgeyBzaXplID0gMDsgfVxuICAgIGlmIChzY2FsZSA9PT0gdm9pZCAwKSB7IHNjYWxlID0gMTsgfVxuICAgIGlmIChlbSA9PT0gdm9pZCAwKSB7IGVtID0gMTY7IH1cbiAgICBpZiAodHlwZW9mIGxlbmd0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgbGVuZ3RoID0gU3RyaW5nKGxlbmd0aCk7XG4gICAgfVxuICAgIGlmIChsZW5ndGggPT09ICcnIHx8IGxlbmd0aCA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBzaXplO1xuICAgIH1cbiAgICBpZiAoZXhwb3J0cy5NQVRIU1BBQ0VbbGVuZ3RoXSkge1xuICAgICAgICByZXR1cm4gZXhwb3J0cy5NQVRIU1BBQ0VbbGVuZ3RoXTtcbiAgICB9XG4gICAgdmFyIG1hdGNoID0gbGVuZ3RoLm1hdGNoKC9eXFxzKihbLStdPyg/OlxcLlxcZCt8XFxkKyg/OlxcLlxcZCopPykpPyhwdHxlbXxleHxtdXxweHxwY3xpbnxtbXxjbXwlKT8vKTtcbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHJldHVybiBzaXplO1xuICAgIH1cbiAgICB2YXIgbSA9IHBhcnNlRmxvYXQobWF0Y2hbMV0gfHwgJzEnKSwgdW5pdCA9IG1hdGNoWzJdO1xuICAgIGlmIChleHBvcnRzLlVOSVRTLmhhc093blByb3BlcnR5KHVuaXQpKSB7XG4gICAgICAgIHJldHVybiBtICogZXhwb3J0cy5VTklUU1t1bml0XSAvIGVtIC8gc2NhbGU7XG4gICAgfVxuICAgIGlmIChleHBvcnRzLlJFTFVOSVRTLmhhc093blByb3BlcnR5KHVuaXQpKSB7XG4gICAgICAgIHJldHVybiBtICogZXhwb3J0cy5SRUxVTklUU1t1bml0XTtcbiAgICB9XG4gICAgaWYgKHVuaXQgPT09ICclJykge1xuICAgICAgICByZXR1cm4gbSAvIDEwMCAqIHNpemU7XG4gICAgfVxuICAgIHJldHVybiBtICogc2l6ZTtcbn1cbmV4cG9ydHMubGVuZ3RoMmVtID0gbGVuZ3RoMmVtO1xuZnVuY3Rpb24gcGVyY2VudChtKSB7XG4gICAgcmV0dXJuICgxMDAgKiBtKS50b0ZpeGVkKDEpLnJlcGxhY2UoL1xcLj8wKyQvLCAnJykgKyAnJSc7XG59XG5leHBvcnRzLnBlcmNlbnQgPSBwZXJjZW50O1xuZnVuY3Rpb24gZW0obSkge1xuICAgIGlmIChNYXRoLmFicyhtKSA8IC4wMDEpXG4gICAgICAgIHJldHVybiAnMCc7XG4gICAgcmV0dXJuIChtLnRvRml4ZWQoMykucmVwbGFjZSgvXFwuPzArJC8sICcnKSkgKyAnZW0nO1xufVxuZXhwb3J0cy5lbSA9IGVtO1xuZnVuY3Rpb24gZW1Sb3VuZGVkKG0sIGVtKSB7XG4gICAgaWYgKGVtID09PSB2b2lkIDApIHsgZW0gPSAxNjsgfVxuICAgIG0gPSAoTWF0aC5yb3VuZChtICogZW0pICsgLjA1KSAvIGVtO1xuICAgIGlmIChNYXRoLmFicyhtKSA8IC4wMDEpXG4gICAgICAgIHJldHVybiAnMGVtJztcbiAgICByZXR1cm4gbS50b0ZpeGVkKDMpLnJlcGxhY2UoL1xcLj8wKyQvLCAnJykgKyAnZW0nO1xufVxuZXhwb3J0cy5lbVJvdW5kZWQgPSBlbVJvdW5kZWQ7XG5mdW5jdGlvbiBweChtLCBNLCBlbSkge1xuICAgIGlmIChNID09PSB2b2lkIDApIHsgTSA9IC1leHBvcnRzLkJJR0RJTUVOOyB9XG4gICAgaWYgKGVtID09PSB2b2lkIDApIHsgZW0gPSAxNjsgfVxuICAgIG0gKj0gZW07XG4gICAgaWYgKE0gJiYgbSA8IE0pXG4gICAgICAgIG0gPSBNO1xuICAgIGlmIChNYXRoLmFicyhtKSA8IC4xKVxuICAgICAgICByZXR1cm4gJzAnO1xuICAgIHJldHVybiBtLnRvRml4ZWQoMSkucmVwbGFjZSgvXFwuMCQvLCAnJykgKyAncHgnO1xufVxuZXhwb3J0cy5weCA9IHB4O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGVuZ3Rocy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=