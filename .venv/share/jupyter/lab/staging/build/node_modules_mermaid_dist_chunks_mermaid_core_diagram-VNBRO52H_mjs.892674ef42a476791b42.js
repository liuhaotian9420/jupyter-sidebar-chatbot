"use strict";
(self["webpackChunk_jupyterlab_application_top"] = self["webpackChunk_jupyterlab_application_top"] || []).push([["node_modules_mermaid_dist_chunks_mermaid_core_diagram-VNBRO52H_mjs"],{

/***/ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-4BMEZGHF.mjs":
/*!**************************************************************************!*\
  !*** ./node_modules/mermaid/dist/chunks/mermaid.core/chunk-4BMEZGHF.mjs ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   populateCommonDb: () => (/* binding */ populateCommonDb)
/* harmony export */ });
/* harmony import */ var _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-YTJNT7DU.mjs */ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-YTJNT7DU.mjs");


// src/diagrams/common/populateCommonDb.ts
function populateCommonDb(ast, db) {
  if (ast.accDescr) {
    db.setAccDescription?.(ast.accDescr);
  }
  if (ast.accTitle) {
    db.setAccTitle?.(ast.accTitle);
  }
  if (ast.title) {
    db.setDiagramTitle?.(ast.title);
  }
}
(0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_0__.__name)(populateCommonDb, "populateCommonDb");




/***/ }),

/***/ "./node_modules/mermaid/dist/chunks/mermaid.core/diagram-VNBRO52H.mjs":
/*!****************************************************************************!*\
  !*** ./node_modules/mermaid/dist/chunks/mermaid.core/diagram-VNBRO52H.mjs ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   diagram: () => (/* binding */ diagram)
/* harmony export */ });
/* harmony import */ var _chunk_4BMEZGHF_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chunk-4BMEZGHF.mjs */ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-4BMEZGHF.mjs");
/* harmony import */ var _chunk_O4NI6UNU_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chunk-O4NI6UNU.mjs */ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-O4NI6UNU.mjs");
/* harmony import */ var _chunk_7B677QYD_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chunk-7B677QYD.mjs */ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-7B677QYD.mjs");
/* harmony import */ var _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chunk-YTJNT7DU.mjs */ "./node_modules/mermaid/dist/chunks/mermaid.core/chunk-YTJNT7DU.mjs");
/* harmony import */ var _mermaid_js_parser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @mermaid-js/parser */ "./node_modules/@mermaid-js/parser/dist/mermaid-parser.core.mjs");





// src/diagrams/packet/db.ts
var defaultPacketData = {
  packet: []
};
var data = structuredClone(defaultPacketData);
var DEFAULT_PACKET_CONFIG = _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.defaultConfig_default.packet;
var getConfig2 = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)(() => {
  const config = (0,_chunk_O4NI6UNU_mjs__WEBPACK_IMPORTED_MODULE_1__.cleanAndMerge)({
    ...DEFAULT_PACKET_CONFIG,
    ...(0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.getConfig)().packet
  });
  if (config.showBits) {
    config.paddingY += 10;
  }
  return config;
}, "getConfig");
var getPacket = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)(() => data.packet, "getPacket");
var pushWord = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)((word) => {
  if (word.length > 0) {
    data.packet.push(word);
  }
}, "pushWord");
var clear2 = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)(() => {
  (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.clear)();
  data = structuredClone(defaultPacketData);
}, "clear");
var db = {
  pushWord,
  getPacket,
  getConfig: getConfig2,
  clear: clear2,
  setAccTitle: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.setAccTitle,
  getAccTitle: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.getAccTitle,
  setDiagramTitle: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.setDiagramTitle,
  getDiagramTitle: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.getDiagramTitle,
  getAccDescription: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.getAccDescription,
  setAccDescription: _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.setAccDescription
};

// src/diagrams/packet/parser.ts

var maxPacketSize = 1e4;
var populate = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)((ast) => {
  (0,_chunk_4BMEZGHF_mjs__WEBPACK_IMPORTED_MODULE_0__.populateCommonDb)(ast, db);
  let lastByte = -1;
  let word = [];
  let row = 1;
  const { bitsPerRow } = db.getConfig();
  for (let { start, end, label } of ast.blocks) {
    if (end && end < start) {
      throw new Error(`Packet block ${start} - ${end} is invalid. End must be greater than start.`);
    }
    if (start !== lastByte + 1) {
      throw new Error(
        `Packet block ${start} - ${end ?? start} is not contiguous. It should start from ${lastByte + 1}.`
      );
    }
    lastByte = end ?? start;
    _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.log.debug(`Packet block ${start} - ${lastByte} with label ${label}`);
    while (word.length <= bitsPerRow + 1 && db.getPacket().length < maxPacketSize) {
      const [block, nextBlock] = getNextFittingBlock({ start, end, label }, row, bitsPerRow);
      word.push(block);
      if (block.end + 1 === row * bitsPerRow) {
        db.pushWord(word);
        word = [];
        row++;
      }
      if (!nextBlock) {
        break;
      }
      ({ start, end, label } = nextBlock);
    }
  }
  db.pushWord(word);
}, "populate");
var getNextFittingBlock = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)((block, row, bitsPerRow) => {
  if (block.end === void 0) {
    block.end = block.start;
  }
  if (block.start > block.end) {
    throw new Error(`Block start ${block.start} is greater than block end ${block.end}.`);
  }
  if (block.end + 1 <= row * bitsPerRow) {
    return [block, void 0];
  }
  return [
    {
      start: block.start,
      end: row * bitsPerRow - 1,
      label: block.label
    },
    {
      start: row * bitsPerRow,
      end: block.end,
      label: block.label
    }
  ];
}, "getNextFittingBlock");
var parser = {
  parse: /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)(async (input) => {
    const ast = await (0,_mermaid_js_parser__WEBPACK_IMPORTED_MODULE_4__.parse)("packet", input);
    _chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.log.debug(ast);
    populate(ast);
  }, "parse")
};

// src/diagrams/packet/renderer.ts
var draw = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)((_text, id, _version, diagram2) => {
  const db2 = diagram2.db;
  const config = db2.getConfig();
  const { rowHeight, paddingY, bitWidth, bitsPerRow } = config;
  const words = db2.getPacket();
  const title = db2.getDiagramTitle();
  const totalRowHeight = rowHeight + paddingY;
  const svgHeight = totalRowHeight * (words.length + 1) - (title ? 0 : rowHeight);
  const svgWidth = bitWidth * bitsPerRow + 2;
  const svg = (0,_chunk_7B677QYD_mjs__WEBPACK_IMPORTED_MODULE_2__.selectSvgElement)(id);
  svg.attr("viewbox", `0 0 ${svgWidth} ${svgHeight}`);
  (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.configureSvgSize)(svg, svgHeight, svgWidth, config.useMaxWidth);
  for (const [word, packet] of words.entries()) {
    drawWord(svg, packet, word, config);
  }
  svg.append("text").text(title).attr("x", svgWidth / 2).attr("y", svgHeight - totalRowHeight / 2).attr("dominant-baseline", "middle").attr("text-anchor", "middle").attr("class", "packetTitle");
}, "draw");
var drawWord = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)((svg, word, rowNumber, { rowHeight, paddingX, paddingY, bitWidth, bitsPerRow, showBits }) => {
  const group = svg.append("g");
  const wordY = rowNumber * (rowHeight + paddingY) + paddingY;
  for (const block of word) {
    const blockX = block.start % bitsPerRow * bitWidth + 1;
    const width = (block.end - block.start + 1) * bitWidth - paddingX;
    group.append("rect").attr("x", blockX).attr("y", wordY).attr("width", width).attr("height", rowHeight).attr("class", "packetBlock");
    group.append("text").attr("x", blockX + width / 2).attr("y", wordY + rowHeight / 2).attr("class", "packetLabel").attr("dominant-baseline", "middle").attr("text-anchor", "middle").text(block.label);
    if (!showBits) {
      continue;
    }
    const isSingleBlock = block.end === block.start;
    const bitNumberY = wordY - 2;
    group.append("text").attr("x", blockX + (isSingleBlock ? width / 2 : 0)).attr("y", bitNumberY).attr("class", "packetByte start").attr("dominant-baseline", "auto").attr("text-anchor", isSingleBlock ? "middle" : "start").text(block.start);
    if (!isSingleBlock) {
      group.append("text").attr("x", blockX + width).attr("y", bitNumberY).attr("class", "packetByte end").attr("dominant-baseline", "auto").attr("text-anchor", "end").text(block.end);
    }
  }
}, "drawWord");
var renderer = { draw };

// src/diagrams/packet/styles.ts
var defaultPacketStyleOptions = {
  byteFontSize: "10px",
  startByteColor: "black",
  endByteColor: "black",
  labelColor: "black",
  labelFontSize: "12px",
  titleColor: "black",
  titleFontSize: "14px",
  blockStrokeColor: "black",
  blockStrokeWidth: "1",
  blockFillColor: "#efefef"
};
var styles = /* @__PURE__ */ (0,_chunk_YTJNT7DU_mjs__WEBPACK_IMPORTED_MODULE_3__.__name)(({ packet } = {}) => {
  const options = (0,_chunk_O4NI6UNU_mjs__WEBPACK_IMPORTED_MODULE_1__.cleanAndMerge)(defaultPacketStyleOptions, packet);
  return `
	.packetByte {
		font-size: ${options.byteFontSize};
	}
	.packetByte.start {
		fill: ${options.startByteColor};
	}
	.packetByte.end {
		fill: ${options.endByteColor};
	}
	.packetLabel {
		fill: ${options.labelColor};
		font-size: ${options.labelFontSize};
	}
	.packetTitle {
		fill: ${options.titleColor};
		font-size: ${options.titleFontSize};
	}
	.packetBlock {
		stroke: ${options.blockStrokeColor};
		stroke-width: ${options.blockStrokeWidth};
		fill: ${options.blockFillColor};
	}
	`;
}, "styles");

// src/diagrams/packet/diagram.ts
var diagram = {
  parser,
  db,
  renderer,
  styles
};



/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX21lcm1haWRfZGlzdF9jaHVua3NfbWVybWFpZF9jb3JlX2RpYWdyYW0tVk5CUk81MkhfbWpzLjg5MjY3NGVmNDJhNDc2NzkxYjQyLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBRThCOztBQUU5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBTTs7QUFJSjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNsQjRCO0FBR0E7QUFHQTtBQWNBOztBQUU5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNFQUFxQjtBQUNqRCxpQ0FBaUMsMkRBQU07QUFDdkMsaUJBQWlCLGtFQUFhO0FBQzlCO0FBQ0EsT0FBTyw4REFBUztBQUNoQixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0NBQWdDLDJEQUFNO0FBQ3RDLCtCQUErQiwyREFBTTtBQUNyQztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsNkJBQTZCLDJEQUFNO0FBQ25DLEVBQUUsMERBQUs7QUFDUDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLGFBQWE7QUFDYixpQkFBaUI7QUFDakIsaUJBQWlCO0FBQ2pCLG1CQUFtQjtBQUNuQixtQkFBbUI7QUFDbkI7O0FBRUE7QUFDMkM7QUFDM0M7QUFDQSwrQkFBK0IsMkRBQU07QUFDckMsRUFBRSxxRUFBZ0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsVUFBVSxhQUFhO0FBQ3ZCLGFBQWEsb0JBQW9CO0FBQ2pDO0FBQ0Esc0NBQXNDLE9BQU8sSUFBSSxLQUFLO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixPQUFPLElBQUksY0FBYywwQ0FBMEMsYUFBYTtBQUN4RztBQUNBO0FBQ0E7QUFDQSxJQUFJLG9EQUFHLHVCQUF1QixPQUFPLElBQUksVUFBVSxhQUFhLE1BQU07QUFDdEU7QUFDQSx1REFBdUQsbUJBQW1CO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsb0JBQW9CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwwQ0FBMEMsMkRBQU07QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsYUFBYSw0QkFBNEIsVUFBVTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EseUJBQXlCLDJEQUFNO0FBQy9CLHNCQUFzQix5REFBSztBQUMzQixJQUFJLG9EQUFHO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQSwyQkFBMkIsMkRBQU07QUFDakM7QUFDQTtBQUNBLFVBQVUsNENBQTRDO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHFFQUFnQjtBQUM5Qiw2QkFBNkIsVUFBVSxFQUFFLFVBQVU7QUFDbkQsRUFBRSxxRUFBZ0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsK0JBQStCLDJEQUFNLDBCQUEwQiwrREFBK0Q7QUFDOUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDJEQUFNLElBQUksU0FBUyxJQUFJO0FBQ3BELGtCQUFrQixrRUFBYTtBQUMvQjtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsVUFBVTtBQUNWLGVBQWU7QUFDZjtBQUNBO0FBQ0EsVUFBVTtBQUNWLGVBQWU7QUFDZjtBQUNBO0FBQ0EsWUFBWTtBQUNaLGtCQUFrQjtBQUNsQixVQUFVO0FBQ1Y7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRSIsInNvdXJjZXMiOlsid2VicGFjazovL0BqdXB5dGVybGFiL2FwcGxpY2F0aW9uLXRvcC8uL25vZGVfbW9kdWxlcy9tZXJtYWlkL2Rpc3QvY2h1bmtzL21lcm1haWQuY29yZS9jaHVuay00Qk1FWkdIRi5tanMiLCJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL21lcm1haWQvZGlzdC9jaHVua3MvbWVybWFpZC5jb3JlL2RpYWdyYW0tVk5CUk81MkgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIF9fbmFtZVxufSBmcm9tIFwiLi9jaHVuay1ZVEpOVDdEVS5tanNcIjtcblxuLy8gc3JjL2RpYWdyYW1zL2NvbW1vbi9wb3B1bGF0ZUNvbW1vbkRiLnRzXG5mdW5jdGlvbiBwb3B1bGF0ZUNvbW1vbkRiKGFzdCwgZGIpIHtcbiAgaWYgKGFzdC5hY2NEZXNjcikge1xuICAgIGRiLnNldEFjY0Rlc2NyaXB0aW9uPy4oYXN0LmFjY0Rlc2NyKTtcbiAgfVxuICBpZiAoYXN0LmFjY1RpdGxlKSB7XG4gICAgZGIuc2V0QWNjVGl0bGU/Lihhc3QuYWNjVGl0bGUpO1xuICB9XG4gIGlmIChhc3QudGl0bGUpIHtcbiAgICBkYi5zZXREaWFncmFtVGl0bGU/Lihhc3QudGl0bGUpO1xuICB9XG59XG5fX25hbWUocG9wdWxhdGVDb21tb25EYiwgXCJwb3B1bGF0ZUNvbW1vbkRiXCIpO1xuXG5leHBvcnQge1xuICBwb3B1bGF0ZUNvbW1vbkRiXG59O1xuIiwiaW1wb3J0IHtcbiAgcG9wdWxhdGVDb21tb25EYlxufSBmcm9tIFwiLi9jaHVuay00Qk1FWkdIRi5tanNcIjtcbmltcG9ydCB7XG4gIGNsZWFuQW5kTWVyZ2Vcbn0gZnJvbSBcIi4vY2h1bmstTzROSTZVTlUubWpzXCI7XG5pbXBvcnQge1xuICBzZWxlY3RTdmdFbGVtZW50XG59IGZyb20gXCIuL2NodW5rLTdCNjc3UVlELm1qc1wiO1xuaW1wb3J0IHtcbiAgX19uYW1lLFxuICBjbGVhcixcbiAgY29uZmlndXJlU3ZnU2l6ZSxcbiAgZGVmYXVsdENvbmZpZ19kZWZhdWx0LFxuICBnZXRBY2NEZXNjcmlwdGlvbixcbiAgZ2V0QWNjVGl0bGUsXG4gIGdldENvbmZpZyxcbiAgZ2V0RGlhZ3JhbVRpdGxlLFxuICBsb2csXG4gIHNldEFjY0Rlc2NyaXB0aW9uLFxuICBzZXRBY2NUaXRsZSxcbiAgc2V0RGlhZ3JhbVRpdGxlXG59IGZyb20gXCIuL2NodW5rLVlUSk5UN0RVLm1qc1wiO1xuXG4vLyBzcmMvZGlhZ3JhbXMvcGFja2V0L2RiLnRzXG52YXIgZGVmYXVsdFBhY2tldERhdGEgPSB7XG4gIHBhY2tldDogW11cbn07XG52YXIgZGF0YSA9IHN0cnVjdHVyZWRDbG9uZShkZWZhdWx0UGFja2V0RGF0YSk7XG52YXIgREVGQVVMVF9QQUNLRVRfQ09ORklHID0gZGVmYXVsdENvbmZpZ19kZWZhdWx0LnBhY2tldDtcbnZhciBnZXRDb25maWcyID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgoKSA9PiB7XG4gIGNvbnN0IGNvbmZpZyA9IGNsZWFuQW5kTWVyZ2Uoe1xuICAgIC4uLkRFRkFVTFRfUEFDS0VUX0NPTkZJRyxcbiAgICAuLi5nZXRDb25maWcoKS5wYWNrZXRcbiAgfSk7XG4gIGlmIChjb25maWcuc2hvd0JpdHMpIHtcbiAgICBjb25maWcucGFkZGluZ1kgKz0gMTA7XG4gIH1cbiAgcmV0dXJuIGNvbmZpZztcbn0sIFwiZ2V0Q29uZmlnXCIpO1xudmFyIGdldFBhY2tldCA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKCkgPT4gZGF0YS5wYWNrZXQsIFwiZ2V0UGFja2V0XCIpO1xudmFyIHB1c2hXb3JkID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgod29yZCkgPT4ge1xuICBpZiAod29yZC5sZW5ndGggPiAwKSB7XG4gICAgZGF0YS5wYWNrZXQucHVzaCh3b3JkKTtcbiAgfVxufSwgXCJwdXNoV29yZFwiKTtcbnZhciBjbGVhcjIgPSAvKiBAX19QVVJFX18gKi8gX19uYW1lKCgpID0+IHtcbiAgY2xlYXIoKTtcbiAgZGF0YSA9IHN0cnVjdHVyZWRDbG9uZShkZWZhdWx0UGFja2V0RGF0YSk7XG59LCBcImNsZWFyXCIpO1xudmFyIGRiID0ge1xuICBwdXNoV29yZCxcbiAgZ2V0UGFja2V0LFxuICBnZXRDb25maWc6IGdldENvbmZpZzIsXG4gIGNsZWFyOiBjbGVhcjIsXG4gIHNldEFjY1RpdGxlLFxuICBnZXRBY2NUaXRsZSxcbiAgc2V0RGlhZ3JhbVRpdGxlLFxuICBnZXREaWFncmFtVGl0bGUsXG4gIGdldEFjY0Rlc2NyaXB0aW9uLFxuICBzZXRBY2NEZXNjcmlwdGlvblxufTtcblxuLy8gc3JjL2RpYWdyYW1zL3BhY2tldC9wYXJzZXIudHNcbmltcG9ydCB7IHBhcnNlIH0gZnJvbSBcIkBtZXJtYWlkLWpzL3BhcnNlclwiO1xudmFyIG1heFBhY2tldFNpemUgPSAxZTQ7XG52YXIgcG9wdWxhdGUgPSAvKiBAX19QVVJFX18gKi8gX19uYW1lKChhc3QpID0+IHtcbiAgcG9wdWxhdGVDb21tb25EYihhc3QsIGRiKTtcbiAgbGV0IGxhc3RCeXRlID0gLTE7XG4gIGxldCB3b3JkID0gW107XG4gIGxldCByb3cgPSAxO1xuICBjb25zdCB7IGJpdHNQZXJSb3cgfSA9IGRiLmdldENvbmZpZygpO1xuICBmb3IgKGxldCB7IHN0YXJ0LCBlbmQsIGxhYmVsIH0gb2YgYXN0LmJsb2Nrcykge1xuICAgIGlmIChlbmQgJiYgZW5kIDwgc3RhcnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUGFja2V0IGJsb2NrICR7c3RhcnR9IC0gJHtlbmR9IGlzIGludmFsaWQuIEVuZCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBzdGFydC5gKTtcbiAgICB9XG4gICAgaWYgKHN0YXJ0ICE9PSBsYXN0Qnl0ZSArIDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFBhY2tldCBibG9jayAke3N0YXJ0fSAtICR7ZW5kID8/IHN0YXJ0fSBpcyBub3QgY29udGlndW91cy4gSXQgc2hvdWxkIHN0YXJ0IGZyb20gJHtsYXN0Qnl0ZSArIDF9LmBcbiAgICAgICk7XG4gICAgfVxuICAgIGxhc3RCeXRlID0gZW5kID8/IHN0YXJ0O1xuICAgIGxvZy5kZWJ1ZyhgUGFja2V0IGJsb2NrICR7c3RhcnR9IC0gJHtsYXN0Qnl0ZX0gd2l0aCBsYWJlbCAke2xhYmVsfWApO1xuICAgIHdoaWxlICh3b3JkLmxlbmd0aCA8PSBiaXRzUGVyUm93ICsgMSAmJiBkYi5nZXRQYWNrZXQoKS5sZW5ndGggPCBtYXhQYWNrZXRTaXplKSB7XG4gICAgICBjb25zdCBbYmxvY2ssIG5leHRCbG9ja10gPSBnZXROZXh0Rml0dGluZ0Jsb2NrKHsgc3RhcnQsIGVuZCwgbGFiZWwgfSwgcm93LCBiaXRzUGVyUm93KTtcbiAgICAgIHdvcmQucHVzaChibG9jayk7XG4gICAgICBpZiAoYmxvY2suZW5kICsgMSA9PT0gcm93ICogYml0c1BlclJvdykge1xuICAgICAgICBkYi5wdXNoV29yZCh3b3JkKTtcbiAgICAgICAgd29yZCA9IFtdO1xuICAgICAgICByb3crKztcbiAgICAgIH1cbiAgICAgIGlmICghbmV4dEJsb2NrKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgKHsgc3RhcnQsIGVuZCwgbGFiZWwgfSA9IG5leHRCbG9jayk7XG4gICAgfVxuICB9XG4gIGRiLnB1c2hXb3JkKHdvcmQpO1xufSwgXCJwb3B1bGF0ZVwiKTtcbnZhciBnZXROZXh0Rml0dGluZ0Jsb2NrID0gLyogQF9fUFVSRV9fICovIF9fbmFtZSgoYmxvY2ssIHJvdywgYml0c1BlclJvdykgPT4ge1xuICBpZiAoYmxvY2suZW5kID09PSB2b2lkIDApIHtcbiAgICBibG9jay5lbmQgPSBibG9jay5zdGFydDtcbiAgfVxuICBpZiAoYmxvY2suc3RhcnQgPiBibG9jay5lbmQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEJsb2NrIHN0YXJ0ICR7YmxvY2suc3RhcnR9IGlzIGdyZWF0ZXIgdGhhbiBibG9jayBlbmQgJHtibG9jay5lbmR9LmApO1xuICB9XG4gIGlmIChibG9jay5lbmQgKyAxIDw9IHJvdyAqIGJpdHNQZXJSb3cpIHtcbiAgICByZXR1cm4gW2Jsb2NrLCB2b2lkIDBdO1xuICB9XG4gIHJldHVybiBbXG4gICAge1xuICAgICAgc3RhcnQ6IGJsb2NrLnN0YXJ0LFxuICAgICAgZW5kOiByb3cgKiBiaXRzUGVyUm93IC0gMSxcbiAgICAgIGxhYmVsOiBibG9jay5sYWJlbFxuICAgIH0sXG4gICAge1xuICAgICAgc3RhcnQ6IHJvdyAqIGJpdHNQZXJSb3csXG4gICAgICBlbmQ6IGJsb2NrLmVuZCxcbiAgICAgIGxhYmVsOiBibG9jay5sYWJlbFxuICAgIH1cbiAgXTtcbn0sIFwiZ2V0TmV4dEZpdHRpbmdCbG9ja1wiKTtcbnZhciBwYXJzZXIgPSB7XG4gIHBhcnNlOiAvKiBAX19QVVJFX18gKi8gX19uYW1lKGFzeW5jIChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IGFzdCA9IGF3YWl0IHBhcnNlKFwicGFja2V0XCIsIGlucHV0KTtcbiAgICBsb2cuZGVidWcoYXN0KTtcbiAgICBwb3B1bGF0ZShhc3QpO1xuICB9LCBcInBhcnNlXCIpXG59O1xuXG4vLyBzcmMvZGlhZ3JhbXMvcGFja2V0L3JlbmRlcmVyLnRzXG52YXIgZHJhdyA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKF90ZXh0LCBpZCwgX3ZlcnNpb24sIGRpYWdyYW0yKSA9PiB7XG4gIGNvbnN0IGRiMiA9IGRpYWdyYW0yLmRiO1xuICBjb25zdCBjb25maWcgPSBkYjIuZ2V0Q29uZmlnKCk7XG4gIGNvbnN0IHsgcm93SGVpZ2h0LCBwYWRkaW5nWSwgYml0V2lkdGgsIGJpdHNQZXJSb3cgfSA9IGNvbmZpZztcbiAgY29uc3Qgd29yZHMgPSBkYjIuZ2V0UGFja2V0KCk7XG4gIGNvbnN0IHRpdGxlID0gZGIyLmdldERpYWdyYW1UaXRsZSgpO1xuICBjb25zdCB0b3RhbFJvd0hlaWdodCA9IHJvd0hlaWdodCArIHBhZGRpbmdZO1xuICBjb25zdCBzdmdIZWlnaHQgPSB0b3RhbFJvd0hlaWdodCAqICh3b3Jkcy5sZW5ndGggKyAxKSAtICh0aXRsZSA/IDAgOiByb3dIZWlnaHQpO1xuICBjb25zdCBzdmdXaWR0aCA9IGJpdFdpZHRoICogYml0c1BlclJvdyArIDI7XG4gIGNvbnN0IHN2ZyA9IHNlbGVjdFN2Z0VsZW1lbnQoaWQpO1xuICBzdmcuYXR0cihcInZpZXdib3hcIiwgYDAgMCAke3N2Z1dpZHRofSAke3N2Z0hlaWdodH1gKTtcbiAgY29uZmlndXJlU3ZnU2l6ZShzdmcsIHN2Z0hlaWdodCwgc3ZnV2lkdGgsIGNvbmZpZy51c2VNYXhXaWR0aCk7XG4gIGZvciAoY29uc3QgW3dvcmQsIHBhY2tldF0gb2Ygd29yZHMuZW50cmllcygpKSB7XG4gICAgZHJhd1dvcmQoc3ZnLCBwYWNrZXQsIHdvcmQsIGNvbmZpZyk7XG4gIH1cbiAgc3ZnLmFwcGVuZChcInRleHRcIikudGV4dCh0aXRsZSkuYXR0cihcInhcIiwgc3ZnV2lkdGggLyAyKS5hdHRyKFwieVwiLCBzdmdIZWlnaHQgLSB0b3RhbFJvd0hlaWdodCAvIDIpLmF0dHIoXCJkb21pbmFudC1iYXNlbGluZVwiLCBcIm1pZGRsZVwiKS5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIikuYXR0cihcImNsYXNzXCIsIFwicGFja2V0VGl0bGVcIik7XG59LCBcImRyYXdcIik7XG52YXIgZHJhd1dvcmQgPSAvKiBAX19QVVJFX18gKi8gX19uYW1lKChzdmcsIHdvcmQsIHJvd051bWJlciwgeyByb3dIZWlnaHQsIHBhZGRpbmdYLCBwYWRkaW5nWSwgYml0V2lkdGgsIGJpdHNQZXJSb3csIHNob3dCaXRzIH0pID0+IHtcbiAgY29uc3QgZ3JvdXAgPSBzdmcuYXBwZW5kKFwiZ1wiKTtcbiAgY29uc3Qgd29yZFkgPSByb3dOdW1iZXIgKiAocm93SGVpZ2h0ICsgcGFkZGluZ1kpICsgcGFkZGluZ1k7XG4gIGZvciAoY29uc3QgYmxvY2sgb2Ygd29yZCkge1xuICAgIGNvbnN0IGJsb2NrWCA9IGJsb2NrLnN0YXJ0ICUgYml0c1BlclJvdyAqIGJpdFdpZHRoICsgMTtcbiAgICBjb25zdCB3aWR0aCA9IChibG9jay5lbmQgLSBibG9jay5zdGFydCArIDEpICogYml0V2lkdGggLSBwYWRkaW5nWDtcbiAgICBncm91cC5hcHBlbmQoXCJyZWN0XCIpLmF0dHIoXCJ4XCIsIGJsb2NrWCkuYXR0cihcInlcIiwgd29yZFkpLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aCkuYXR0cihcImhlaWdodFwiLCByb3dIZWlnaHQpLmF0dHIoXCJjbGFzc1wiLCBcInBhY2tldEJsb2NrXCIpO1xuICAgIGdyb3VwLmFwcGVuZChcInRleHRcIikuYXR0cihcInhcIiwgYmxvY2tYICsgd2lkdGggLyAyKS5hdHRyKFwieVwiLCB3b3JkWSArIHJvd0hlaWdodCAvIDIpLmF0dHIoXCJjbGFzc1wiLCBcInBhY2tldExhYmVsXCIpLmF0dHIoXCJkb21pbmFudC1iYXNlbGluZVwiLCBcIm1pZGRsZVwiKS5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIikudGV4dChibG9jay5sYWJlbCk7XG4gICAgaWYgKCFzaG93Qml0cykge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGNvbnN0IGlzU2luZ2xlQmxvY2sgPSBibG9jay5lbmQgPT09IGJsb2NrLnN0YXJ0O1xuICAgIGNvbnN0IGJpdE51bWJlclkgPSB3b3JkWSAtIDI7XG4gICAgZ3JvdXAuYXBwZW5kKFwidGV4dFwiKS5hdHRyKFwieFwiLCBibG9ja1ggKyAoaXNTaW5nbGVCbG9jayA/IHdpZHRoIC8gMiA6IDApKS5hdHRyKFwieVwiLCBiaXROdW1iZXJZKS5hdHRyKFwiY2xhc3NcIiwgXCJwYWNrZXRCeXRlIHN0YXJ0XCIpLmF0dHIoXCJkb21pbmFudC1iYXNlbGluZVwiLCBcImF1dG9cIikuYXR0cihcInRleHQtYW5jaG9yXCIsIGlzU2luZ2xlQmxvY2sgPyBcIm1pZGRsZVwiIDogXCJzdGFydFwiKS50ZXh0KGJsb2NrLnN0YXJ0KTtcbiAgICBpZiAoIWlzU2luZ2xlQmxvY2spIHtcbiAgICAgIGdyb3VwLmFwcGVuZChcInRleHRcIikuYXR0cihcInhcIiwgYmxvY2tYICsgd2lkdGgpLmF0dHIoXCJ5XCIsIGJpdE51bWJlclkpLmF0dHIoXCJjbGFzc1wiLCBcInBhY2tldEJ5dGUgZW5kXCIpLmF0dHIoXCJkb21pbmFudC1iYXNlbGluZVwiLCBcImF1dG9cIikuYXR0cihcInRleHQtYW5jaG9yXCIsIFwiZW5kXCIpLnRleHQoYmxvY2suZW5kKTtcbiAgICB9XG4gIH1cbn0sIFwiZHJhd1dvcmRcIik7XG52YXIgcmVuZGVyZXIgPSB7IGRyYXcgfTtcblxuLy8gc3JjL2RpYWdyYW1zL3BhY2tldC9zdHlsZXMudHNcbnZhciBkZWZhdWx0UGFja2V0U3R5bGVPcHRpb25zID0ge1xuICBieXRlRm9udFNpemU6IFwiMTBweFwiLFxuICBzdGFydEJ5dGVDb2xvcjogXCJibGFja1wiLFxuICBlbmRCeXRlQ29sb3I6IFwiYmxhY2tcIixcbiAgbGFiZWxDb2xvcjogXCJibGFja1wiLFxuICBsYWJlbEZvbnRTaXplOiBcIjEycHhcIixcbiAgdGl0bGVDb2xvcjogXCJibGFja1wiLFxuICB0aXRsZUZvbnRTaXplOiBcIjE0cHhcIixcbiAgYmxvY2tTdHJva2VDb2xvcjogXCJibGFja1wiLFxuICBibG9ja1N0cm9rZVdpZHRoOiBcIjFcIixcbiAgYmxvY2tGaWxsQ29sb3I6IFwiI2VmZWZlZlwiXG59O1xudmFyIHN0eWxlcyA9IC8qIEBfX1BVUkVfXyAqLyBfX25hbWUoKHsgcGFja2V0IH0gPSB7fSkgPT4ge1xuICBjb25zdCBvcHRpb25zID0gY2xlYW5BbmRNZXJnZShkZWZhdWx0UGFja2V0U3R5bGVPcHRpb25zLCBwYWNrZXQpO1xuICByZXR1cm4gYFxuXHQucGFja2V0Qnl0ZSB7XG5cdFx0Zm9udC1zaXplOiAke29wdGlvbnMuYnl0ZUZvbnRTaXplfTtcblx0fVxuXHQucGFja2V0Qnl0ZS5zdGFydCB7XG5cdFx0ZmlsbDogJHtvcHRpb25zLnN0YXJ0Qnl0ZUNvbG9yfTtcblx0fVxuXHQucGFja2V0Qnl0ZS5lbmQge1xuXHRcdGZpbGw6ICR7b3B0aW9ucy5lbmRCeXRlQ29sb3J9O1xuXHR9XG5cdC5wYWNrZXRMYWJlbCB7XG5cdFx0ZmlsbDogJHtvcHRpb25zLmxhYmVsQ29sb3J9O1xuXHRcdGZvbnQtc2l6ZTogJHtvcHRpb25zLmxhYmVsRm9udFNpemV9O1xuXHR9XG5cdC5wYWNrZXRUaXRsZSB7XG5cdFx0ZmlsbDogJHtvcHRpb25zLnRpdGxlQ29sb3J9O1xuXHRcdGZvbnQtc2l6ZTogJHtvcHRpb25zLnRpdGxlRm9udFNpemV9O1xuXHR9XG5cdC5wYWNrZXRCbG9jayB7XG5cdFx0c3Ryb2tlOiAke29wdGlvbnMuYmxvY2tTdHJva2VDb2xvcn07XG5cdFx0c3Ryb2tlLXdpZHRoOiAke29wdGlvbnMuYmxvY2tTdHJva2VXaWR0aH07XG5cdFx0ZmlsbDogJHtvcHRpb25zLmJsb2NrRmlsbENvbG9yfTtcblx0fVxuXHRgO1xufSwgXCJzdHlsZXNcIik7XG5cbi8vIHNyYy9kaWFncmFtcy9wYWNrZXQvZGlhZ3JhbS50c1xudmFyIGRpYWdyYW0gPSB7XG4gIHBhcnNlcixcbiAgZGIsXG4gIHJlbmRlcmVyLFxuICBzdHlsZXNcbn07XG5leHBvcnQge1xuICBkaWFncmFtXG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9